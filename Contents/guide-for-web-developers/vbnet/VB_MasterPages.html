<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Using FusionCharts XT with ASP.NET (VB)- Master Page Sample </title>
<link rel="stylesheet" href="../../assets/ui/css/style.css" type="text/css" />
<script type="text/javascript" src="../../assets/prettify/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="../../assets/prettify/prettify.css" />
<script type="text/javascript" src="../../assets/ui/js/jquery.min.js" ></script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }

a.whtbtnhide, a.whtbtnshow, a.whtbtnhidenav , a.whtbtnshownav { border-bottom:none !important; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../../assets/ui/js/whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whtopic.js"></script>
<script type="text/javascript" src="../../assets/ui/js/lib.js"></script>
</head>

<body>
<!-- breadcrumb starts here -->
<div id="breadcrumb"></div>
<script type="text/javascript">
	document.write( addFCBreadcrumb( [ "Home|../../Introduction/Overview.html", "Guide for web developers", "Using FusionCharts XT with ASP.NET(VB)|VBNET_BasicExample.html", "Using with Master Pages" ] ) );
</script>
<!-- breadcrumb ends here -->

<table width="98%" border="0" cellspacing="0" cellpadding="3" align="center">
  <tr> 
    <td class="pageHeader">Master Page Sample </td>
  </tr>
  <tr> 
    <td valign="top" class="text"><p>FusionCharts XT can effectively be used with VB (ASP.NET) Master Pages to plot dynamic data-driven charts. In this example, we will show a  basic sample to help you get started.</p>
      <p>In this example we will do the following:</p>
      <ol>
        <li><a href="#master">Create a simple master page</a></li>
        <li><a href="#content">Define a content page for this master page</a></li>
        <li><a href="#chart">Place a chart in this  content page.</a></li>
      </ol>
      <p><strong>Before you go further with this page, we recommend you to please see the 
							previous section, <a href="VBNET_BasicExample.html">Basic Examples</a>, as we start off from concepts 
	  explained in that page. </strong></p>    </td>
  </tr>
 
  <tr>
    <td valign="top" class="highlightBlock">All code discussed here is present in <span class="codeInline">Download Package &gt; Code &gt; VB_NET </span> &gt; <span class="codeInline">MasterPage_Example</span> folder. </td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  
  <tr>
    <td valign="top" class="header"><a name="master" id="master"></a>Creating a Master Page <span class="codeInline"></span></td>
  </tr>
  
  <tr>
    <td valign="top" class="text"><p>We have created a simple master page with a header and a footer and a content place holder. The code of the master page (MasterPage.master) is as shown below:</p></td>
  </tr>
  <tr>
    <td valign="top"><pre class="prettyprint code_container">&lt;%@ Master Language=&quot;VB&quot; %&gt;
&lt;html&gt;
  &lt;head runat=&quot;server&quot;&gt;&lt;/head&gt;
  &lt;body&gt;
    &lt;center&gt;
      &lt;form id='form2' name='form1' method='post' runat=&quot;server&quot;&gt;
        &lt;h2&gt;FusionCharts XT Examples&lt;/h2&gt;
        &lt;h4&gt;Basic example - Using ASP.NET 2.0 Master Page&lt;/h4&gt;
<strong>  
         &lt;asp:ContentPlaceHolder ID=&quot;ContentPlaceHolder1&quot; runat=&quot;server&quot;&gt;&lt;/asp:ContentPlaceHolder&gt;</strong>
         &lt;h5&gt;
            This page is built using &lt;a href=&quot;http://www.fusioncharts.com&quot; target=&quot;_blank&quot;&gt;
            FusionCharts XT&lt;/a&gt; and ASP.NET 2.0 VB MasterPage
        &lt;/h5&gt;
      &lt;/form&gt;
    &lt;/center&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre></td>
  </tr>
  <tr>
    <td valign="top" class="text"><p>Here, we have:</p>
	<ul>
      <li>Added the header and footer text. </li>
      <li>Placed a content holder with id <span class="codeInline">ContentPlaceHolder1. </span>Inside this we will place our chart from the main aspx file.</li>
	  </ul>
        <p>The master page will look like the following in  Design view:</p>

   <p><img src="../Images/VB_MP1.JPG" width="678" height="343" class="imageBorder" /></p></td>
  </tr>
  
  <tr>
    <td valign="top" class="header"><a name="content" id="content"></a>Creating a content page </td>
  </tr>
  
  <tr>
    <td valign="top" class="text"><p>Now, lets create a content page to apply this master page and add a chart to it. Our content page ( <span class="codeInline">Default.aspx</span>) will be like this :</p></td>
  </tr>
  <tr>
    <td valign="top"><pre class="prettyprint code_container">&lt;%@ Page Language=&quot;VB&quot; <strong>MasterPageFile=&quot;MasterPage.master&quot; </strong>CodeFile=&quot;Default.aspx.vb&quot; Inherits=&quot;_Default&quot; Title=&quot;FusionCharts Example - Using ASP.NET 2.0 Master Page&quot; %&gt;
      &lt;asp:Content ID=&quot;Content1&quot; ContentPlaceHolderID=&quot;<strong>ContentPlaceHolder1</strong>&quot; Runat=&quot;Server&quot;&gt;
      
       &lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot; src=&quot;../FusionCharts/FusionCharts.js&quot;&gt;&lt;/script&gt;
 &lt;%
<span class="codeComment">
'Included FusionCharts.js to embed FusionCharts easily in web pages

'The following code will generate a chart from code behind file Default.aspx.cs
</span>
%&gt;
 &lt;%=GetMonthlySalesChartHtml() %&gt;

&lt;/asp:Content&gt;</pre></td>
  </tr>
  <tr>
    <td valign="top" class="text"><p>Here:</p>
	<ul>
      <li>We set <span class="codeInline">MasterPageFile</span> attribute to bind the master page we just created.</li>
      <li>Next, we add the  Content control and map it to <span class="codeInline">ContentPlaceHolder</span> control on the master page.</li>
      <li>We include <span class="codeInline">FusionCharts.js</span> to easily embed a chart inside the content. </li>
      <li>Finally, we call <span class="codeInline">GetMonthlySalesChartHtml()</span> from code behind file which renders the chart. </li>
    </ul>
	<p>Let's see how <span class="codeInline">GetMonthlySalesChartHtml() </span> works:</p> </td>
  </tr>
  
  <tr>
    <td valign="top" class="codeBlock"><pre class="prettyprint code_container">Imports InfoSoftGlobal
        
        Partial Class _Default
        
Inherits System.Web.UI.Page
      Public Function GetMonthlyalesChartHtml() As String
          
        <span class="codeComment"> 'Create the chart - Column 3D Chart with data from Data/Data.xml</span>
             
  Return FusionCharts.RenderChart(&quot;../FusionCharts/Column3D.swf&quot;, &quot;Data/Data.xml&quot;, &quot;&quot;, &quot;myFirst&quot;, &quot;600&quot;, &quot;300&quot;, False, True)
        End Function
    End Class</pre>    </td>
  </tr>
  <tr>
    <td valign="top" class="text"><p>We have just used the <span class="codeInline">RenderChart()</span> method from <span class="codeInline">InfoSoftGlobal.</span><span class="codeInline">FusionCharts</span> class to return the HTML code for the chart (using JavaScript embedding). For simplicity we have used a physical <span class="codeInline">Data.xml</span> file to provide chart data using the <span class="codeInline">Data URL</span> method.</p>      
	<p><span class="header"><a name="chart" id="chart"></a></span>The container page will show up the chart in browser like the screenshot below:</p> </td>
  </tr>
  <tr>
    <td valign="top" class="text"><img src="../Images/VB_MP2.jpg" width="610" height="426" class="imageBorder" /></td>
  </tr>
</table>
<!-- footer links starts-->
<div id="fcfooter"></div>
<script type="text/javascript">
	document.getElementById("fcfooter").innerHTML =  addFCFooter("Creating Drill down charts|VBNET_Drill.html","ASP.NET, JavaScript &amp; Data URL|VBNET_JS_URL.html");
</script>
<!-- footer links ends -->
<script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--

	highlightSearch();

//-->
//]]></script>
</body>
</html>
