<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>FusionCharts ASP Class API - Creating Combination Chart </title>
<link rel="stylesheet" href="../../assets/ui/css/style.css" type="text/css" />
<script type="text/javascript" src="../../assets/prettify/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="../../assets/prettify/prettify.css" />
<script type="text/javascript" src="../../assets/ui/js/jquery.min.js" ></script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }

a.whtbtnhide, a.whtbtnshow, a.whtbtnhidenav , a.whtbtnshownav { border-bottom:none !important; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../../assets/ui/js/whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whtopic.js"></script>
<script type="text/javascript" src="../../assets/ui/js/lib.js"></script>
</head>

<body>
<!-- breadcrumb starts here -->
<div id="breadcrumb"></div>
<script type="text/javascript">
	document.write( addFCBreadcrumb( [ "Home|../../Introduction/Overview.html", "Guide for web developers", "FusionCharts ASP Class|Overview.html", "Creating Combination chart" ] ) );
</script>
<!-- breadcrumb ends here -->


<table width="98%" border="0" cellspacing="0" cellpadding="3" align="center">
  <tr> 
    <td class="pageHeader">Creating Combination Chart </td>
  </tr>
  

  <tr>
    <td valign="top" class="text"><p>Combination chart has two y-axes. The y-axis on the left  hand side is called Primary y-axis and that on the right hand side is called  Secondary y-axis. Combination charts are used when we intend to compare two  different types of data on the same chart, for example, if we want to plot Weekly  Sales Revenue of two consecutive months and total units sold on the same chart,  we have to use a Combination Chart. See the image below and note that the two y-axes are representing different data units. </p>
      <img src="../Images/ClassImages/ClassCombination.jpg" class="imageBorder" />
    <p>Let's add some more data to the existing Table for Multi-series chart. We will add a column that tabulates Total Quantity Sales.</p> </td>
  </tr>
  <tr>
    <td valign="top" class="text">
      <table width="40%" cellspacing="0" cellpadding="5" class="table" >
        <tr >
          <td width="8%" class="header" align="right">Week</td>
          <td width="12%"  class="header" align="right">Current Month </td>
          <td width="12%" class="header" align="right">Previous Month</td>
          <td width="8%"  class="header" align="right">&nbsp;</td>
        </tr>
        <tr>
          <td class="borderBottom">&nbsp;</td>
          <td class="headerwhite">
            <div align="right">Sales </div>          </td>
          <td class="headerwhite">
            <div align="right">Sales </div>          </td>
          <td align="right" class="headerwhite">Total Quantity </td>
        </tr>
        <tr>
          <td class="borderBottom">Week 1 </td>
          <td class="borderBottom">
            <div align="right">$40800</div>          </td>
          <td class="borderBottom">
            <div align="right">$38300</div>          </td>
          <td align="right" class="borderBottom">64</td>
        </tr>
        <tr>
          <td class="borderBottom">Week 2 </td>
          <td class="borderBottom">
            <div align="right">$31400</div>          </td>
          <td class="borderBottom">
            <div align="right">$28400</div>          </td>
          <td align="right" class="borderBottom">70</td>
        </tr>
        <tr>
          <td class="borderBottom">Week 3 </td>
          <td class="borderBottom">
            <div align="right">$26700</div>          </td>
          <td class="borderBottom">
            <div align="right">$15700</div>          </td>
          <td align="right" class="borderBottom">52</td>
        </tr>
        <tr>
          <td>Week 4 </td>
          <td>
            <div align="right">$54400</div>          </td>
          <td>
            <div align="right">$48100</div>          </td>
          <td align="right">81</td>
        </tr>
      </table>    </td>
  </tr>
  <tr>
     <td valign="top"><p class="highlightBlock">Before you go further with this page, we recommend you to please see   the previous pages <a href="FirstChart.html">Creating First Chart</a> &amp; <a href="MultiSeriesChart.html">Creating Multi-series chart</a>  as we start off from concepts explained in   that page. </p>
     <p>Here is the code that builds up this Combination chart:</p></td>
  </tr>
  <tr>
    <td valign="top"><pre class="prettyprint code_container">&lt;%@LANGUAGE=&quot;VBSCRIPT&quot;%&gt;
  &lt;%
     <span class="codeComment">'Include FusionCharts ASP Class</span>
  %&gt; 
&lt;!--#include file=&quot;../Class/FusionCharts_Gen.asp&quot;--&gt;
&lt;%&nbsp;&nbsp;&nbsp;
dim FC
<span class="codeComment">&nbsp;&nbsp;&nbsp; 'Create FusionCharts ASP class object </span>&nbsp;&nbsp;&nbsp;
set FC = new FusionCharts
<span class="codeComment">&nbsp;&nbsp;&nbsp; 'Set chart type to Column 3D + Line Dual Y-Axis Combination Chart</span>&nbsp;&nbsp;&nbsp;
Call FC.setChartType(&quot;MSColumn3DLineDY&quot;)
<span class="codeComment">&nbsp;&nbsp;&nbsp; 'Set chart size</span>&nbsp;&nbsp;&nbsp;
Call FC.setSize(&quot;450&quot;,&quot;350&quot;)
<span class="codeComment">&nbsp;&nbsp;&nbsp; 'Set the relative path of the SWF file</span>&nbsp;&nbsp;&nbsp;
Call FC.setSWFPath(&quot;../FusionCharts/&quot;)
 &nbsp;&nbsp;&nbsp; dim strParam        
        <span class="codeComment">&nbsp;  'Define chart attributes</span>
       &nbsp;&nbsp;&nbsp; strParam=&quot;caption=Weekly Sales;subcaption=Comparison;xAxisName=Week;
           <strong>pYAxisName=Revenue;sYAxisName=Total Quantity</strong>;
           numberPrefix=$;<strong>sNumberSuffix= U</strong>&quot;
           <span class="codeComment">'Set chart attributes</span>
     &nbsp;&nbsp;&nbsp;   Call FC.setChartParams(strParam)
     <span class="codeComment">&nbsp;&nbsp;&nbsp;   'Add category names</span>
       &nbsp;&nbsp;&nbsp; Call FC.addCategory(&quot;Week 1&quot;, &quot;&quot;, &quot;&quot;)
       &nbsp;&nbsp;&nbsp; Call FC.addCategory(&quot;Week 2&quot;, &quot;&quot;, &quot;&quot;)
       &nbsp;&nbsp;&nbsp; Call FC.addCategory(&quot;Week 3&quot;, &quot;&quot;, &quot;&quot;)
     &nbsp;&nbsp;&nbsp;   Call FC.addCategory(&quot;Week 4&quot;, &quot;&quot;, &quot;&quot;)
      <span class="codeComment">&nbsp;&nbsp;&nbsp; 'Add a new dataset with dataset parameters </span>
       &nbsp;&nbsp;&nbsp; Call FC.addDataset(&quot;This Month&quot;,&quot;showValues=0&quot;)       
        <span class="codeComment">&nbsp; 'Add chart data for the above dataset</span>
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;40800&quot;, &quot;&quot;, &quot;&quot;)
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;31400&quot;, &quot;&quot;, &quot;&quot;)
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;26700&quot;, &quot;&quot;, &quot;&quot;)
     &nbsp;&nbsp;&nbsp;   Call FC.addChartData(&quot;54400&quot;, &quot;&quot;, &quot;&quot;)
       <span class="codeComment">&nbsp;&nbsp; 'Add another dataset with dataset parameters </span>
       &nbsp;&nbsp;&nbsp; Call FC.addDataset(&quot;Previous Month&quot;,&quot;showValues=0&quot;)
       <span class="codeComment">&nbsp;&nbsp; 'Add chart data for the second dataset</span>
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;38300&quot;, &quot;&quot;, &quot;&quot;)
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;28400&quot;, &quot;&quot;, &quot;&quot;)
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;15700&quot;, &quot;&quot;, &quot;&quot;)
     &nbsp;&nbsp;&nbsp;   Call FC.addChartData(&quot;48100&quot;, &quot;&quot;, &quot;&quot;)
     <span class="codeComment">&nbsp;&nbsp;&nbsp;  'Add third dataset for the secondary axis</span>
       &nbsp;&nbsp;&nbsp; Call FC.addDataset(&quot;Total Quantity&quot;,&quot;<strong>parentYAxis=S</strong>&quot;)
      <span class="codeComment">&nbsp;&nbsp;&nbsp; 'Add  data values</span> <span class="codeComment">for the secondary axis</span> 
        &nbsp;&nbsp; Call FC.addChartData(&quot;64&quot;, &quot;&quot;, &quot;&quot;)
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;70&quot;, &quot;&quot;, &quot;&quot;)
       &nbsp;&nbsp;&nbsp; Call FC.addChartData(&quot;52&quot;, &quot;&quot;, &quot;&quot;)
     &nbsp;&nbsp;&nbsp;   Call FC.addChartData(&quot;81&quot;, &quot;&quot;, &quot;&quot;)
      %&gt;
      &lt;html&gt;
  &nbsp;&nbsp;&nbsp;   &lt;head&gt;
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;title&gt;Column 3D + Line Dual Y-Axis Combination Chart Using FusionCharts ASP Class&lt;/title&gt;
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;script language='javascript' src='../FusionCharts/FusionCharts.js'&gt;&lt;/script&gt;
  &nbsp;&nbsp;&nbsp;   &lt;/head&gt;
  &nbsp;&nbsp;&nbsp;   &lt;body&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;%
        <span class="codeComment">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Render Chart with JS embedding Method</span>
       &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Call FC.renderChart(false)
       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %&gt;
      &nbsp;&nbsp;&lt;/body&gt;
      &lt;/html&gt;</pre>      </td>
  </tr>
  <tr>
    <td valign="top" class="text"><p>As you  can see in the above code, the process of creating Combination charts  Multi-Series charts is same. Here also we use multiple datasets. Some datasets are specified for primary Y-Axis and some for the secondary Y-Axis.&nbsp; We need to specify which dataset belongs to which Y-Axis. Let's see what we have done to render a combination chart. The steps are mentioned below.</p>
      <ul type="disc">
        <li>We include <span class="codeInline">FusionCharts_Gen.asp</span>.<br />
           <br />
        </li>
        <li>We create       Multiseries Column 3D - Line Combination chart object and set relative path to SWF file.<br />
              <br />
                 <pre class="prettyprint code_container">set FC = new FusionCharts
Call FC.setChartType(&quot;MSColumn3DLineDY&quot;)
Call FC.setChartSize(&quot;450&quot;,&quot;350&quot;) 
Call FC-&gt;setSWFPath(&quot;../FusionCharts/&quot;)              </pre><br />
        </li>
        <li>Next, we store       chart attributes in <span class="codeInline">strParam</span> variable :<br /> 
           <br />
         <pre class="prettyprint code_container">strParam=&quot;caption=Weekly Sales;subcaption=Comparison;xAxisName=Week;<strong>pYAxisName=Revenue</strong>;<strong>sYAxisName=Total Quantity</strong>;numberPrefix=$;<strong>sNumberSuffix= U</strong>&quot;;</pre>
          <br />
          Combination charts have 2 Y-axis -Parent (p) and Secondary (s). So we have specified names for both of them. Moreover, using <span class="codeInline">sNumberSuffix</span>, we set the number suffix for secondary Y Axis. <br />
          <br />
        </li>
        <li>We set these chart attributes calling <span class="codeInline">setChartParams()</span><br />
           <br /> 
           <pre class="prettyprint code_container">Call FC.setChartParams(strParam)</pre>
           <br />
        </li>
        <li>Next, like in Multi-series charts, we add categories :<br />
           <br />
            <pre class="prettyprint code_container">Call FC.addCategory(&quot;Week 1&quot;,&quot;&quot;,&quot;&quot;)
Call FC.addCategory(&quot;Week 2&quot;,&quot;&quot;,&quot;&quot;)
Call FC.addCategory(&quot;Week 3&quot;,&quot;&quot;,&quot;&quot;)
Call FC.addCategory(&quot;Week 4&quot;,&quot;&quot;,&quot;&quot;)</pre>
            <br />
        </li>
        <li>We add       the first dataset 'This Month' for primary Y-Axis. If we do not specify the Y-Axis the dataset adheres to, the chart automatically sets it to primary Y-Axis. <br />
           <br />
            <pre class="prettyprint code_container">Call FC.addDataset(&quot;This Month&quot;,&quot;<strong>showValues=0</strong>&quot;);
Call FC.addChartData(&quot;40800&quot;,&quot;&quot;,&quot;&quot;)
Call FC.addChartData(&quot;31400&quot;,&quot;&quot;,&quot;&quot;)
Call FC.addChartData(&quot;26700&quot;,&quot;&quot;,&quot;&quot;)
Call FC.addChartData(&quot;54400&quot;,&quot;&quot;,&quot;&quot;)</pre>
          <br />
        </li>
        <li>Again, we add another dataset 'Previous Month' for primary Y-Axis and set its attributes and  data values.<br /> 
           <br />
            <pre class="prettyprint code_container">Call FC.addDataset(&quot;Previous Month&quot;,&quot;showValues=0&quot;)
Call FC.addChartData(&quot;38300&quot;,&quot;&quot;,&quot;&quot;)
Call FC.addChartData(&quot;28400&quot;,&quot;&quot;,&quot;&quot;)
Call FC.addChartData(&quot;15700&quot;,&quot;&quot;,&quot;&quot;)
Call FC.addChartData(&quot;48100&quot;,&quot;&quot;,&quot;&quot;)</pre>
            <br />
        </li>
        <li>Now, we add the third dataset, this one for Secondary Y-axis and its data values. Here, we specify the Y-Axis by passing the dataset attribute <span class="codeInline">parentYAxis=S</span>. <br />
           <br />
          <pre class="prettyprint code_container">Call FC.addDataset(&quot;Total Quantity&quot;,&quot;<strong>parentYaxis=S</strong>&quot;) 
Call FC.addChartData(&quot;64&quot;,&quot;&quot;,&quot;&quot;)
Call FC.addChartData(&quot;70&quot;,&quot;&quot;,&quot;&quot;)
Call FC.addChartData(&quot;52&quot;,&quot;&quot;,&quot;&quot;)
Call FC.addChartData(&quot;81&quot;,&quot;&quot;,&quot;&quot;)</pre>
        <br />
        </li>
        <li>Finally, we add <span class="codeInline">FusionCharts.js</span> and <br />
           <br />
        </li>
        <li> Render the chart : <br />
           <br />
         <pre class="prettyprint code_container">Call FC.renderChart(false)</pre></li>
    </ul></td>
  </tr>
  <tr>
    <td valign="top"><p class="highlightBlock">Please go through <a href="Functions.html">FusionCharts ASP Class API Reference</a> section to know more about the functions used in the above code.</p> 
    <p class="text">This code renders the Combination Chart that we needed. </p>
    <img src="../Images/ClassImages/ClassCombination.jpg" class="imageBorder" /></td>
  </tr>
</table>
<!-- footer links starts-->
<div id="fcfooter"></div>
<script type="text/javascript">
	document.getElementById("fcfooter").innerHTML =  addFCFooter("Creating Stacked chart|StackedChart.html","Creating Scatter-Bubble chart|ScatterBubble.html");
</script>
<!-- footer links ends -->
<script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--

	highlightSearch();

//-->
//]]></script>

</body>
</html>
