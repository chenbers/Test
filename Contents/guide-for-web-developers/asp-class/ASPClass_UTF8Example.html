<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Using FusionCharts with ASP Class - Using Multilingual Text</title>
<link rel="stylesheet" href="../../assets/ui/css/style.css" type="text/css" />
<script type="text/javascript" src="../../assets/prettify/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="../../assets/prettify/prettify.css" />
<script type="text/javascript" src="../../assets/ui/js/jquery.min.js" ></script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }

a.whtbtnhide, a.whtbtnshow, a.whtbtnhidenav , a.whtbtnshownav { border-bottom:none !important; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../../assets/ui/js/whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whtopic.js"></script>
<script type="text/javascript" src="../../assets/ui/js/lib.js"></script>
</head>

<body>
<!-- breadcrumb starts here -->
<div id="breadcrumb"></div>
<script type="text/javascript">
	document.write( addFCBreadcrumb( [ "Home|../../Introduction/Overview.html", "Guide for web developers", "Using with ASP Class|ASPClass_BasicExamples.html", "Using multi-lingual text" ] ) );
</script>
<!-- breadcrumb ends here -->

<table width="98%" border="0" cellspacing="0" cellpadding="3" align="center">
  <tr>
    <td class="pageHeader">Using Multilingual Text</td>
  </tr>
  <tr>
    <td valign="top" class="text">
      <p>Let us now see how we can show multilingual text in FusionCharts XT using ASP. FusionCharts XT supports  UTF-8 (Unicode Transformation Format-8) encoded multilingual character set. </p>
      <p>In this section we will be discussing three different methods to add multilingual text in FusionCharts XT. These are :</p>
      <ol>
        <li><a href="#data_string">Using simple Data String method</a></li>
        <li><a href="#data_url">Using simple Data URL method</a></li>
        <li><a href="#db">Using data from database (using the Data URL method)</a></li>
      </ol>
      <p><strong>Before you proceed with the contents in this page, we recommend you to go through the  <a href="ASPClass_BasicExamples.html">Basic Examples</a> and 
        <a href="../asp/ASP_DB.html">Plotting from Database Example</a> sections as we will directly use a lot of concepts defined in those sections.</strong></p>
      <p class="highlightBlock">The code examples contained in this page are present 
        in <span class="codeInline">Download Package &gt; Code &gt; ASPClass &gt; UTF8Examples </span> folder. <br />
        The  Access database used in this example is  present in <span class="codeInline">Download 
        Package &gt; Code &gt; ASPClass &gt;</span> <span class="codeInline">DB</span>. <br />
        The data-sources referred by the examples are present 
        in the <span class="codeInline">Download Package &gt; Code &gt; ASPClass &gt; UTF8Examples &gt; Data</span> folder.</p>
      </td></tr>
	  <tr>
      <td class="header">Things to remember before we start</td></tr>
	  <tr>
	  <td valign="top" class="text">
      <p>FusionCharts XT requires UTF-8 encoded XML to have byte-order mark at the header of the XML file. So, to display UTF-8  characters in your charts, you need to stamp the UTF-8  encoded XML file with a byte-order mark.      </p>
      <p><strong>WARNING</strong></p>
        <p>Do not rely on specifying the encoding for your XML file  in the XML header region.</p>
      <pre class="prettyprint code_container">&lt;?xml version=&quot;1.0&quot; <del>encoding=&quot;UTF-8&quot;</del>?&gt;</pre>
      <p>The thumb rule - UTF-8 BOM stamp in the header is a must. </p>
      
      <p class="highlightBlock"> FusionCharts XT supports only left-to-right languages as of now. It does not have native support for right-to-left languages like Hebrew. So, if you want to use Hebrew with FusionCharts XT, you will have to programmatically change the text sequence and then provide the data to FusionCharts XT.</p>
	  </td></tr>
<tr>
<td class="header"><a name="data_string" id="data_string"></a>Using Data String method</td>
</tr>
	  <tr>
	  <td valign="top" class="text">
      <p>We will be modifying our previous example file <span class="codeInline">FirstChart.asp</span> present in the <span class="codeInline">BasicExample</span> folder. The two files are almost equivalent except for the fact that our file will be marked with a byte order mark and will have UTF-8 characters.</p>
<pre class="prettyprint code_container">&lt;%@ Language=VBScript %&gt;
&lt;%
	Response.ContentType = &quot;text/html&quot;

	<span class="codeComment">' Write BOM</span>
	Response.CodePage = 65001
	Response.BinaryWrite(chrb(239))
	Response.BinaryWrite(chrb(187))
	Response.BinaryWrite(chrb(191))
%&gt;</pre>
      
      <p>In the above code, we set the content type, and then write the BOM mark. This needs to be done at the very beginning of the document before outputting any data.</p>
      <p>The way the chart data is rendered and created is equivalent to base example. The only difference is that this data contains multi-lingual UTF-8 characters.</p>
<pre class="prettyprint code_container">&lt;%
	<span class="codeComment">' This page demonstrates the ease of generating charts containing UTF-8 encoded
	' multilingual text using FusionCharts ASP Class.
	' For this chart, we have created a chart  object used FusionCharts ASP Class
	' supply chart data and configurations to it and render chart using the instance

	' Here, we have kept this example very simple.</span>

	dim FC

	<span class="codeComment">' Create FusionCharts ASP class object</span>
	set FC = new FusionCharts

	<span class="codeComment">' Set chart type to Column 2D</span>
	call FC.setChartType(&quot;Column2D&quot;)

	<span class="codeComment">' Set chart size </span>
	call FC.setSize(&quot;500&quot;,&quot;400&quot;)

	<span class="codeComment">' Set Relative Path of SWF file.</span>
	Call FC.setSWFPath(&quot;../../FusionCharts/&quot;)

	<span class="codeComment">' Set Chart attributes</span>
	Call FC.setChartParams(&quot;caption=Monthly Sales Summary;subcaption=For the year 2008;&quot;)
	Call FC.setChartParams(&quot;xAxisName=Month;yAxisName=Sales;numberPrefix=$;showLabels=1;&quot;)
	Call FC.setChartParams(&quot;showValues=0;animation=1;&quot;)
	Call FC.setChartParams(&quot;baseFontColor=666666;lineColor=FF5904;lineAlpha=85;&quot;)
	Call FC.setChartParams(&quot;valuePadding=10;labelDisplay=rotate;useRoundEdges=1&quot;)

	<span class="codeComment">' add chart data values and category names</span>
	Call FC.addChartData(&quot;17400&quot;,&quot;Label=janu&aacute;ri&quot;, &quot;&quot; )
	Call FC.addChartData(&quot;19800&quot;,&quot;Label=Fevru&aacute;rios&quot;, &quot;&quot; )
	Call FC.addChartData(&quot;21800&quot;,&quot;Label=&#1605;&#1575;&#1585;&#1587;&quot;, &quot;&quot; )
	Call FC.addChartData(&quot;23800&quot;,&quot;Label=&#1571;&#1576;&#1585;&#1610;&#1604;&quot;, &quot;&quot; )
	Call FC.addChartData(&quot;29600&quot;,&quot;Label=&#20116;&#26376;&quot;, &quot;&quot; )
	Call FC.addChartData(&quot;27600&quot;,&quot;Label=&#20845;&#26376;&quot;, &quot;&quot; )
	Call FC.addChartData(&quot;31800&quot;,&quot;Label=&#1514;&#1460;&#1468;&#1513;&#1473;&#1512;&#1460;&#1497;&quot;, &quot;&quot; )
	Call FC.addChartData(&quot;39700&quot;,&quot;Label=Mare&scaron;w&#257;n&quot;, &quot;&quot; )
	Call FC.addChartData(&quot;37800&quot;,&quot;Label=sett&egrave;mbre&quot;, &quot;&quot; )
	Call FC.addChartData(&quot;21900&quot;,&quot;Label=ott&agrave;gono&quot;, &quot;&quot; )
	Call FC.addChartData(&quot;32900&quot;,&quot;Label=nov&egrave;mbre&quot;, &quot;&quot; )
	Call FC.addChartData(&quot;39800&quot;,&quot;Label=d&eacute;cembre&quot;, &quot;&quot; )

	<span class="codeComment">' apply style</span>
	Call FC.defineStyle(&quot;myCaptionFont&quot;,&quot;Font&quot;,&quot;size=12&quot;)
	Call FC.applyStyle(&quot;DATALABELS&quot;,&quot;myCaptionFont&quot;)

	<span class="codeComment">' Render  Chart </span>
	Call FC.renderChart(false)

%&gt;</pre>
      <p>The modified file is <span class="codeInline">dataXML.asp</span> file present at the <span class="codeInline">UTF8Examples</span> folder.</p>
 </td></tr>
  <tr>
  <td class="header"><a name="data_url" id="data_url"></a>Using the Data URL method</td>
  </tr>
	  <tr>
	  <td valign="top" class="text">
      <p>We will be modifying our previous example file <span class="codeInline">SimpleChart.asp</span> present in the BasicExample folder. In fact, no modifications will be made to this file but rather to the <span class="codeInline">Data.asp</span> file present in the Data folder. For the <span class="codeInline">Data URL</span> method of providing chart data, the URL data source must begin with the BOM stamp.</p>
      <p>In this example, we will use the same method of creating data as in our <span class="codeInline">Data String </span> method.</p>
      <pre class="prettyprint code_container">&lt;%
	...
 
	<span class="codeComment">'set content type as XML</span>
	Response.ContentType =&quot;text/xml&quot;

	<span class="codeComment">'Write BOM </span>
	Response.CodePage = 65001
	Response.BinaryWrite(chrb(239))
	Response.BinaryWrite(chrb(187))
	Response.BinaryWrite(chrb(191))
	<span class="codeComment">'Return the chart XML for Column 3D Chart </span>
	Response.Write(FC.getXML())

%&gt;</pre>     
      <p class="text">In the above code, we have set the content type and then write the byte order mark. We then retrieve the string for FusionCharts XT using the <span class="codeInline">getXML</span> call and write it using response writer. You can get the modified file in the <span class="codeInline">UTF8Examples/Data</span> folder as <span class="codeInline">Data.asp</span>.</p>
	  </td></tr>
      
      <tr><td class="header"><a name="db" id="db"></a>Database as data-source</td></tr>
	  <tr>
	  <td valign="top" class="text">
      <p>For this example we have added the 'monthly_utf8' table to our <span class="codeInline">FactoryDB</span> schema. The table holds the attribute fields 'month_name' and 'amount', of which 'month_name' contains UTF-8 characters.The data retrieval and encoding process is the same as our previous example <span class="codeInline"> BasicDBExample.asp</span> in the <span class="codeInline">DBExample</span> folder. We just need to add a BOM mark before outputting any data.</p>
      <pre class="prettyprint code_container">&lt;%
	...
        
	Response.ContentType = &quot;text/xml&quot;

	<span class="codeComment">' Write BOM</span>
	Response.CodePage = 65001
	Response.BinaryWrite(chrb(239))
	Response.BinaryWrite(chrb(187))
	Response.BinaryWrite(chrb(191))

	...
%&gt;</pre>
      <p>The above code sets the content type and writes the byte order mark. The modified file is in the <span class="codeInline">UTF8Examples/Data</span> folder as <span class="codeInline">getXMLFromDatabase.asp</span>.</p>
	  </td></tr>
      <tr>
	  <td class="header">The chart with UTF-8 characters</td>
	  </tr>
	  <tr>
	  <td valign="top" class="text">
      <p>The image below shows our sample chart rendered with UTF-8 characters.</p>
      <p><img src="../Images/utf8_chart.jpg" alt="Chart with UTF-8 characters" width="502" height="402" /></p>    
    </td>
  </tr>
  
</table>
<!-- footer links starts-->
<div id="fcfooter"></div>
<script type="text/javascript">
	document.getElementById("fcfooter").innerHTML =  addFCFooter("Creating Drill down charts|ASPCLass_Drill.html","Using with PHP|../php/PHP_BasicExample.html");
</script>
<!-- footer links ends -->
<script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--

	highlightSearch();

//-->
//]]></script>
</body>
</html>
