<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Using FusionCharts ASP Class - Charting Data from Array </title>
<link rel="stylesheet" href="../../assets/ui/css/style.css" type="text/css" />
<script type="text/javascript" src="../../assets/prettify/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="../../assets/prettify/prettify.css" />
<script type="text/javascript" src="../../assets/ui/js/jquery.min.js" ></script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }

a.whtbtnhide, a.whtbtnshow, a.whtbtnhidenav , a.whtbtnshownav { border-bottom:none !important; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../../assets/ui/js/whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../assets/ui/js/whtopic.js"></script>
<script type="text/javascript" src="../../assets/ui/js/lib.js"></script>
</head>

<body>
<!-- breadcrumb starts here -->
<div id="breadcrumb"></div>
<script type="text/javascript">
	document.write( addFCBreadcrumb( [ "Home|../../Introduction/Overview.html", "Guide for web developers", "Using with ASP Class|ASPClass_BasicExamples.html",  "Charting data from Array" ] ) );
</script>
<!-- breadcrumb ends here -->


<table width="98%" border="0" cellspacing="0" cellpadding="3" align="center">
  <tr> 
    <td class="pageHeader">Charting Data from Array </td>
  </tr>
  <tr> 
    <td valign="top" class="text"><p>In this section, we will show you how to use FusionCharts  ASP class functions to plot charts from data contained in ASP arrays. We will cover the following examples here:</p>
      <ul>
        <li><a href="#single">Creating a single series chart from data contained in an array</a></li>
        <li><a href="#multi">Creating a multi-series chart from data contained in arrays </a></li>
      </ul>
      <p><strong>Before you go further with this page, we recommend you to please see the previous section, <a href="ASPClass_BasicExamples.html">Basic Examples</a>, as we start off from concepts explained in that page. </strong></p>
      <p class="highlightBlock">The code examples contained in this page are present in <span class="codeInline">Download Package &gt; Code &gt; ASPClass &gt; ArrayExample</span> folder. </p></td>
  </tr>
  <tr>
    <td valign="top" class="header"><a name="single" id="single"></a>Creating a single series chart from data contained in arrays</td>
  </tr>
  <tr>
    <td valign="top" class="text"><p>The code to create a single series chart is contained in <span class="codeInline">SingleSeries.asp</span> and can be listed as under:</p> </td>
  </tr>
  <tr>
    <td valign="top" class="text">
      <pre class="prettyprint code_container">&lt;%@LANGUAGE=&quot;VBSCRIPT&quot;%&gt;
   &lt;% option explicit %&gt;
   &lt;%
       <span class="codeComment">' We have included ../Includes/FusionCharts_Gen.asp, which contains FusionCharts ASP Class
     &nbsp; ' to help us easily embed the charts.
   </span>%&gt;
&lt;!--#include file=&quot;../Includes/FusionCharts_Gen.asp&quot;--&gt;
&lt;HTML&gt;
&nbsp;&nbsp;&nbsp; &lt;HEAD&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TITLE&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FusionCharts XT - Array Example using Single Series Column 3D Chart
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/TITLE&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;%
        <span class="codeComment">&nbsp; 'You need to include the following JS file, if you intend to embed the chart using JavaScript.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Embedding using JavaScripts avoids the &quot;Click to Activate...&quot; issue in Internet Explorer
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'When you make your own charts, make sure that the path to this JS file is correct. Else, you will get JavaScript errors.</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;SCRIPT LANGUAGE=&quot;Javascript&quot; SRC=&quot;../../FusionCharts/FusionCharts.js&quot;&gt;&lt;/SCRIPT&gt;
&nbsp;&nbsp;&nbsp; &lt;/HEAD&gt;
&nbsp;&nbsp;&nbsp; &lt;BODY&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;h4&gt;Plotting single series chart from data contained in Array.&lt;/h4&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;%
        <span class="codeComment"> 'In this example, using the FusionCharts ASP Class, we plot a single series chart 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 'from data contained in an array. 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 'The array needs to have two columns - first one for data labels/names
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 'and the next one for data values.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 'Let's store the sales data for 6 products in our array). We also store
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 'the name of products. 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 'Store Name of Products</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>dim arrData(6,2)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>arrData(0, 0) = &quot;Product A&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>arrData(1, 0) = &quot;Product B&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>arrData(2, 0) = &quot;Product C&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>arrData(3, 0) = &quot;Product D&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>arrData(4, 0) = &quot;Product E&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>arrData(5, 0) = &quot;Product F&quot;
        <span class="codeComment"> 'Store sales data</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>arrData(0, 1) = 567500
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>arrData(1, 1) = 815300
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>arrData(2, 1) = 556800
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>arrData(3, 1) = 734500
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>arrData(4, 1) = 676800
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>arrData(5, 1) = 648500
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="codeComment">&nbsp; </span>dim FC
        <span class="codeComment">&nbsp;' Create First FusionCharts ASP class object</span>
       &nbsp;&nbsp;<span class="codeComment"></span>set FC = new FusionCharts
        <span class="codeComment"> ' Set chart type to Column 3D</span>
       &nbsp;&nbsp;<span class="codeComment"></span>call FC.setChartType(&quot;Column3D&quot;)
        <span class="codeComment"> ' Set chart size</span>
        <span class="codeComment"> </span>call FC.setSize(&quot;600&quot;,&quot;300&quot;)
     <span class="codeComment">&nbsp;&nbsp;  ' Set Relative Path of SWF file.</span>
     &nbsp;&nbsp;&nbsp;<span class="codeComment"> </span>call FC.setSWFPath(&quot;../../FusionCharts/&quot;)
       &nbsp;&nbsp;<span class="codeComment"></span>dim strParam
        <span class="codeComment"> ' Define chart attributes</span>
       &nbsp;<span class="codeComment"> </span>strParam=&quot;caption=Sales by Product;numberPrefix=$&quot;
       <span class="codeComment">&nbsp; '  Set chart attributes</span>
       &nbsp;<span class="codeComment"> </span>call FC.setChartParams(strParam)
        <span class="codeComment"> ' call FusionCharts ASP Class Function to add data from the array </span>
       &nbsp;<span class="codeComment"></span> call FC.addChartDataFromArray(arrData , &quot;&quot;)
       <span class="codeComment">&nbsp; ' Render the chart</span>
       &nbsp;<span class="codeComment"></span> call FC.renderChart(false)
       &nbsp; %&gt;
  &nbsp;&nbsp;&nbsp; &lt;/BODY&gt;
&lt;/HTML&gt;</pre>    </td>
  </tr>
  
  <tr>
    <td valign="top" class="text" style="line-height:20px;"><p>In the above example:</p>
	<ul>
	<li>We have included <span class="codeInline">FusionCharts_Gen.asp</span> and <span class="codeInline">FusionCharts.js</span>.</li>
      <li>Stored the category names or labels in the first column of the two dimensional array <span class="codeInline">arrData.</span> </li>
      <li>Then we  stored respective data values in the second column of the two dimensional array <span class="codeInline">arrData.</span> </li>
      <li>Created an instance of the FusionCharts ASP class for Column 3D chart with 600 pixels width, 300 pixels height.</li>
      <li>Set the relative path of  chart SWF file.</li>
      <li>Rendered chart using the <span class="codeInline">renderChart()</span> function.</li>
	</ul>      </td>
  </tr>
  <tr>
    <td valign="top" ><p class="highlightBlock">Please go through <a href="../fusioncharts-asp-class/Functions.html">FusionCharts ASP Class API Reference</a> section to know more about the functions used in the above code.</p> 
  
<p>  When you view the chart, you will see a chart as shown below: </p>
  <img src="../Images/Code_ArraySS.jpg" width="584" height="287" class="imageBorder"  /></td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="header"><a name="multi" id="multi"></a>Creating a multi-series chart from data contained in arrays </td>
  </tr>
  <tr>
    <td valign="top" class="text"><p>Let us now create a multi-series chart from data contained in arrays. We create a file <span class="codeInline">MultiSeries.asp</span> with the following code:</p> </td>
  </tr>
 
  <tr>
    <td valign="top" class="text">
      <pre class="prettyprint code_container">&lt;%@LANGUAGE=&quot;VBSCRIPT&quot;%&gt;
   &lt;% option explicit %&gt;
   &lt;%
    <span class="codeComment"> ' We have included ../Includes/FusionCharts_Gen.asp, which contains FusionCharts ASP Class
     ' to help us easily embed the charts.</span>
  %&gt;
&lt;!--#include file=&quot;../Includes/FusionCharts_Gen.asp&quot;--&gt;
&lt;HTML&gt;
 &lt;HEAD&gt;
 &lt;TITLE&gt;FusionCharts XT - Array Example using Multi Series Column 3D Chart&lt;/TITLE&gt;
 &lt;%
<span class="codeComment"> 'You need to include the following JS file, if you intend to embed the chart using JavaScript.
 'Embedding using JavaScripts avoids the &quot;Click to Activate...&quot; issue in Internet Explorer
 'When you make your own charts, make sure that the path to this JS file is correct. Else, you will get JavaScript errors.</span>
%&gt; 
 &lt;SCRIPT LANGUAGE=&quot;Javascript&quot; SRC=&quot;../../FusionCharts/FusionCharts.js&quot;&gt;&lt;/SCRIPT&gt;
 &lt;/HEAD&gt;
 &lt;BODY&gt;
       &lt;h4&gt;Plotting multi-series chart from data contained in Array.&lt;/h4&gt;
       &lt;%
      <span class="codeComment"> ' In this example, using FusionCharts ASP Class we plot 
       ' we plot a multi-series chart from data contained in arrays
       ' The arrays need to be of the following  structure :
       ' 1. Array to store Category Names :
       ' A single dimensional array storing the category names
       ' 2. A 2 Dimensional Array to store data values </span>
     <span class="codeComment">  ' ** Each row will store data for 1 dataset
       ' Column 1 will store : Dataset Series Name.
       ' Column 2 will store : Dataset attributes 
       ' (as list separated by delimiter.)
       ' Column 3 and rest will store : values of the dataset
       ' Let's store the sales data for 6 products in our array. We also store the name of products. 
         
        'Store Name of Products as category labels</span> 
       <span class="codeComment"> </span> dim arrCatNames(6)
       <span class="codeComment"> </span> arrCatNames(0) = &quot;Product A&quot;
       <span class="codeComment"> </span> arrCatNames(1) = &quot;Product B&quot;
       <span class="codeComment"> </span> arrCatNames(2) = &quot;Product C&quot;
       <span class="codeComment"> </span> arrCatNames(3) = &quot;Product D&quot;
       <span class="codeComment"> </span> arrCatNames(4) = &quot;Product E&quot;
       <span class="codeComment"> </span> arrCatNames(5) = &quot;Product F&quot;
       <span class="codeComment"></span>
        <span class="codeComment"> 'Store sales data for current year</span>
       <span class="codeComment"> </span> dim arrData(2,8)
       <span class="codeComment"> </span> arrData(0,0) = &quot;Current Year&quot; ' <span class="codeComment">Dataset Series Name </span>
       <span class="codeComment"> </span> arrData(0,1) = &quot;&quot; <span class="codeComment">' Dataset Parameters</span>
       <span class="codeComment"> </span> arrData(0,2) = 567500
       <span class="codeComment"> </span> arrData(0,3) = 815300
       <span class="codeComment"> </span> arrData(0,4) = 556800
       <span class="codeComment"> </span> arrData(0,5) = 734500
       <span class="codeComment"> </span> arrData(0,6) = 676800
       <span class="codeComment"> </span> arrData(0,7) = 648500
       <span class="codeComment"> </span>
        <span class="codeComment"> 'Store sales data for previous year</span>
       <span class="codeComment"> </span> arrData(1,0) = &quot;Previous Year&quot;
       <span class="codeComment"> </span> arrData(1,1) = &quot;&quot;
       <span class="codeComment"> </span> arrData(1,2) = 547300
       <span class="codeComment"> </span> arrData(1,3) = 584500
       <span class="codeComment"> </span> arrData(1,4) = 754000
       <span class="codeComment"> </span> arrData(1,5) = 456300
       <span class="codeComment"> </span> arrData(1,6) = 754500
       <span class="codeComment"> </span> arrData(1,7) = 437600
       <span class="codeComment">  ' Create FusionCharts ASP Class object for mulitseries column3d chart</span>
       <span class="codeComment"> </span> dim FC
       <span class="codeComment"> </span>
        <span class="codeComment"> ' Create First FusionCharts ASP class object</span>
       <span class="codeComment"> </span> set FC = new FusionCharts
       <span class="codeComment"> </span>
        <span class="codeComment">  ' Set chart type to Multi Series Column 3D</span>
       <span class="codeComment"> </span> call FC.setChartType(&quot;MSColumn3D&quot;)
       
        <span class="codeComment">  ' Set chart size</span>
       <span class="codeComment"> </span> call FC.setSize(&quot;600&quot;,&quot;300&quot;)
       
        <span class="codeComment">  ' Set chart ID</span>
       <span class="codeComment"> </span> call FC.setID(&quot;FC1&quot;)
  
        <span class="codeComment">  ' Set Relative Path of SWF file. </span>
       <span class="codeComment"> </span> call FC.setSWFPath(&quot;../../FusionCharts/&quot;)
  
       <span class="codeComment"> </span> dim strParam
       
        <span class="codeComment">  ' Define chart attributes</span>
       <span class="codeComment"> </span> strParam=&quot;caption=Sales by Product;numberPrefix=$;rotateValues=1&quot;
       <span class="codeComment">  ' Set chart attributes</span>
       <span class="codeComment"> </span> call FC.setChartParams(strParam)
  
        <span class="codeComment">  ' Pass the 2 arrays storing data and category names to 
         ' FusionCharts ASP Class function addChartDataFromArray</span>
       <span class="codeComment"> </span> call FC.addChartDataFromArray(arrData, arrCatNames)
  
        <span class="codeComment">  '  Render Second Chart with JS Embedded Method</span>
       <span class="codeComment"> </span> call FC.renderChart(false)
       %&gt;
   &lt;/BODY&gt;
&lt;/HTML&gt;</pre>    </td>
  </tr>
  
  <tr>
    <td valign="top" class="text" style="line-height:20px;"><p>Let's analyze what we have done in the code above:</p> 
	    <ul>
	<li>We included <span class="codeInline">FusionCharts_Gen.asp</span> class and <span class="codeInline">FusionCharts.js</span> class.</li>
	<li>We created two arrays - one single dimensional array and one two dimensional array. The single dimensional array, <span class="codeInline"> arrCatNames,</span> stores category names. The two dimensional array, <span class="codeInline"> arrData</span>, stores dataset name, dataset parameters and values in its each row.<br />
	    <br />
	    <strong>Note:</strong> The dataset parameters separated by delimiters should be stored as string. It is optional for multi-series charts, but compulsory for combination charts. </li><br />

	<li>We created the FusionCharts ASP class object for Multi-series Column 3D chart with 600 pixels width and 300 pixels height. </li>
	<li>We set the relative path of  chart SWF file using the <span class="codeInline">setSwfPath()</span> function.</li>
	<li>We stored delimiter separated chart attributes in <span class="codeInline"> strParam</span> variable and passed this variable through the <span class="codeInline">	  setChartParams()</span> function to set chart attributes. </li>
	<li>Next, we called the <span class="codeInline">addChartDataFromArray()</span> function and passed <span class="codeInline"> arrData</span> and <span class="codeInline"> arrCatNames</span>  arrays through it. The arrays should be passed in this order only, that is., <span class="codeInline">$arrData</span> is to be the first parameter and <span class="codeInline"> arrCatNames</span> the second.</li>
	<li>Finally we rendered the chart using the <span class="codeInline">renderChart()</span> function.</li>
	</ul>
    </td>
  </tr>
  <tr>
    <td valign="top"><p class="highlightBlock">Please go through the <a href="../fusioncharts-asp-class/Functions.html">FusionCharts ASP Class API Reference</a> section to know more about the functions used in the above code. </p>
  
  <p>When you view the chart, you will see a chart as shown below:</p> 
  <img src="../Images/Code_ArrayMS.jpg" alt="" width="619" height="296"  class="imageBorder" /></td>
  </tr>
  <tr>
    <td valign="top" ><p class="highlightBlock">In <span class="codeInline">Download Package &gt; Code &gt; ASPClass &gt; ArrayExample</span>, we have more example codes to create Stacked and Combination Charts too, which have not been explained here, as they are similar in concept. You can directly see the code if you want to.</p> </td>
  </tr>
</table>
<!-- footer links starts-->
<div id="fcfooter"></div>
<script type="text/javascript">
	document.getElementById("fcfooter").innerHTML =  addFCFooter("Using with ASP Class|ASPCLass_BasicExamples.html","Using with data in forms|ASPCLass_Forms.html");
</script>
<!-- footer links ends -->
<script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--

	highlightSearch();

//-->
//]]></script>
</body>
</html>
