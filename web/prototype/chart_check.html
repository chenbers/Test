<HTML>
<HEAD>
	<TITLE>FusionCharts - Client Side Chart Plotting</TITLE>	
	<style type="text/css">
	<!--
	body {
		font-family: Arial, Helvetica, sans-serif;
		font-size: 12px;
	}
	-->
	</style>
	<SCRIPT LANGUAGE="Javascript" SRC="js/fusioncharts.js"></SCRIPT>
	<SCRIPT LANGUAGE="JavaScript">
		var data = new Array();
		data[0] = new Array("West Coast",4.8,3.2,4.6,4.0,5.0,4.8,4.2,4.1,4.8,4.0,3.9,4.0);
		data[1] = new Array("Midwest",3.2,3.0,3.6,4.1,3.2,4.6,4.0,5.0,4.8,4.2,4.1,4.8);
		data[2] = new Array("Lakes",4.1,3.5,2.1,3.4,4.8,3.2,4.6,4.0,5.0,4.8,4.2,4.1);
		data[3] = new Array("South",2.2,2.8,3.1,3.0,2.2,2.8,3.1,3.0,2.2,2.8,3.1,3.0);
		data[4] = new Array("New England",2.8,2.4,2.0,3.4,2.8,2.4,2.0,3.4,2.8,2.4,2.0,3.4);
		
		//Flag indicating whether our chart has loaded
		var chartLoaded = false;
		
		/**
		 * FC_Rendered method is invoked when the chart has completed rendering for the first time.
		 * It's a pre-defined method name. 
		 *	@param	domId	Dom ID of the chart object
		*/
		function FC_Rendered(domId){			
			//It is in this method that you can update chart's data using JS methods.
			//Check if this is the chart that we want to update
			if (domId=="chart1Id"){			
				//Yes - it is.
				
				//Enable the form now, as the chart has loaded
				this.document.productSelector.disabled = false;
				
				//Set chartLoaded flag to true
				chartLoaded = true;
				
				//Get reference to chart object using Dom ID
				var chartObj = getChartFromId(domId);
				//Update it's XML - set animate Flag to true
				chartObj.setDataXML(generateXML(true));
			}			
			return true;			
		}
		
		/**
		 * updateChart method is called, when user changes any of the checkboxes.
		 * Here, we generate the XML data again and build the chart.		  
		 *	@param	domId	domId of the Chart
		*/
		function updateChart(domId){			
			//Update only if chart has loaded
			if (chartLoaded){
				//Get reference to chart object using Dom ID
				var chartObj = getChartFromId(domId);
				//Update it's XML - set animate Flag from AnimateChart checkbox in form
				chartObj.setDataXML(generateXML(this.document.productSelector.AnimateChart.checked));
			}
		}
		/**
		 * generateXML method returns the XML data for the chart based on the
		 * checkboxes which the user has checked.
		 *	@param	animate		Boolean value indicating to  animate the chart.
		 *	@return				XML Data for the entire chart.
		*/		
		function generateXML(animate){			
			//Variable to store XML
			var strXML;
			//<chart> element
			//Added animation parameter based on animate parameter			
			//Added value related attributes if show value is selected by the user
			strXML = "<chart caption='' subCaption='' lineThickness='4' showValues='0' showBorder='0' drawAnchors='0' borderColor='#cfcfcf' vDivLineColor='#cfcfcf' vDivLineThickness='1' showAlternateHGridColor='1' alternateHGridColor='#f0f0f0' alternateHGridAlpha='100' divLineColor='cfcfcf' divLineIsDashed='1' bgColor='#ffffff' borderThickness='1' showToolTips='1' showLegend='0' forceDecimals='1' yAxisMaxValue='5' chartLeftMargin='10' chartRightMargin='10' chartTopMargin='10' chartBottomMargin='10' canvasPadding='0' setAdaptiveYMin='0' numDivLines='9' adjustDiv='0' animation='" + ((animate==true)?"1":"0") + "' " + ((this.document.productSelector.ShowValues.checked==true)?(" showValues='0' rotateValues='1' placeValuesInside='0' "):(" showValues='0' ")) + ">";
						
			//Store <categories> and child <category> elements
			strXML = strXML + "<categories><category name='JAN' /><category name='FEB' /><category name='MAR' /><category name='APR' /><category name='MAY' /><category name='JUN' /><category name='JUL' /><category name='AUG' /><category name='SEP' /><category name='OCT' /><category name='NOV' /><category name='DEC' /></categories>";
			
			//Based on the products for which we've to generate data, generate XML			
			strXML = (this.document.productSelector.ProductA.checked==true)?(strXML + getProductXML(0)):(strXML);
			strXML = (this.document.productSelector.ProductB.checked==true)?(strXML + getProductXML(1)):(strXML);
			strXML = (this.document.productSelector.ProductC.checked==true)?(strXML + getProductXML(2)):(strXML);
			strXML = (this.document.productSelector.ProductD.checked==true)?(strXML + getProductXML(3)):(strXML);
			strXML = (this.document.productSelector.ProductE.checked==true)?(strXML + getProductXML(4)):(strXML);			
			
			//Close <chart> element;
			strXML = strXML + "</chart>";
			
			//Return data
			return strXML;			
		}
		
		/**
		 * getProductXML method returns the <dataset> and <set> elements XML for
		 * a particular product index (in data array). 
		 *	@param	productIndex	Product index (in data array)
		 *	@return					XML Data for the product.
		*/
		function getProductXML(productIndex){		
			var productXML;
			//Create <dataset> element			
			productXML = "<dataset seriesName='" + data[productIndex][0] + "' >";			
			//Create set elements
			for (var i=1; i<=12; i++){
				productXML = productXML + "<set value='" + data[productIndex][i] + "' />";
			}
			//Close <dataset> element
			productXML = productXML + "</dataset>";
			//Return			
			return productXML;			
		}
		
		
	</SCRIPT>
</HEAD>
<BODY>
	<CENTER>
		<h2>FusionCharts Client Side JavaScript Charting</h2>
		
		<!-- In this example, we'll initially plot the chart with no data. -->
		<!-- Embed a chart -->
		
		<!-- Create the form for selecting products. We disable the form till the chart is loaded and initialized. -->
		<FORM NAME='productSelector' Id='productSelector' action='Chart.html' method='POST' disabled>
			<h4>Please select the products for which you want to plot the chart:</h4>
			<INPUT TYPE='Checkbox' name='ProductA' onClick="JavaScript:updateChart('chart1Id');" checked>&nbsp;West Coast&nbsp;&nbsp;
			<INPUT TYPE='Checkbox' name='ProductB' onClick="JavaScript:updateChart('chart1Id');" checked>&nbsp;Midwest&nbsp;&nbsp;
			<INPUT TYPE='Checkbox' name='ProductC' onClick="JavaScript:updateChart('chart1Id');" checked>&nbsp;Lakes&nbsp;&nbsp;
			<INPUT TYPE='Checkbox' name='ProductD' onClick="JavaScript:updateChart('chart1Id');" checked>&nbsp;South&nbsp;&nbsp;
            <INPUT TYPE='Checkbox' name='ProductE' onClick="JavaScript:updateChart('chart1Id');" checked>&nbsp;New England&nbsp;&nbsp;
			
			<INPUT TYPE='hidden' name='AnimateChart'>
			<INPUT TYPE='hidden' name='ShowValues' onClick="JavaScript:updateChart('chart1Id');" checked>			
			
		</FORM>
		
		<div id="chart1div">
			FusionCharts
		</div>
		<script language="JavaScript">					
			var chart1 = new FusionCharts("swf/MSLine.swf", "chart1Id", "445", "300", "0", "1");		   
			//Initialize chart with empty data. We'll feed it data on the chart's FC_Rendered event.
			chart1.setDataXML("<chart></chart>");
			chart1.render("chart1div");
		</script>
		<BR>
		
	</CENTER>
</BODY>
</HTML>
