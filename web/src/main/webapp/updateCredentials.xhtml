<ui:composition template="/layout/layout.xhtml" 
			xmlns="http://www.w3.org/1999/xhtml" 
			xmlns:ui="http://java.sun.com/jsf/facelets"
  			xmlns:h="http://java.sun.com/jsf/html" 
  			xmlns:f="http://java.sun.com/jsf/core"
			xmlns:rich="http://richfaces.org/rich"
		    xmlns:a4j="http://richfaces.org/a4j"
  			xmlns:security="http://www.springframework.org/security/tags">



  <ui:define name="scripts">
  </ui:define>
  <ui:define name="header">
      <ui:include src="/includes/loginHeader.xhtml"/>
  </ui:define>
  <ui:define name="navigation">
      <ui:include src="/includes/loginNavigation.xhtml"/>
  </ui:define>
  <ui:define name="content">

    <div id="wrapper">
      <ul id="grid_nav">
        <li class="l grid_icon">
          <img src="images/ico_admin.png"/>
        </li>
        <li class="l grid_title">#{messages.updatecred_header}</li>
      </ul>
    </div>
    
    <table id="fd-table-1" class="dash_table" cellspacing="0" cellpadding="0" border="0" align="center" width="940">
      <tbody>
        <tr>
          <td>
            <div>
            
              <h2>
                <h:outputFormat value="#{messages.updatecred_username}">
                  <f:param value="#{updateCredentialsBean.username}"/>
                </h:outputFormat>
              </h2>
              
              <a4j:form>
                
                <rich:panel style="margin:10px;">
                  
                  <div class="update-credentials-panel">
                    <h:outputText value="#{messages.updatecred_newPassword}:" /><br/>
                    <rich:message for="newPassword" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                    <h:inputSecret id="newPassword" label="#{messages.updatecred_newPassword}"
                      binding="#{updateCredentialsBean.newPasswordInput}" value="#{updateCredentialsBean.newPassword}"
                      required="true">
                      <f:validateLength minimum="6" maximum="12" />
                    </h:inputSecret>
                    
                    <br/><br/>
                    
                    <h:outputText value="#{messages.updatecred_confirmPassword}:" /><br/>
                    <rich:message for="confirmPassword" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                    <h:inputSecret id="confirmPassword" label="#{messages.updatecred_confirmPassword}"
                      binding="#{updateCredentialsBean.confirmPasswordInput}" value="#{updateCredentialsBean.confirmPassword}"
                      required="true" validator="#{updateCredentialsBean.validateNewPassword}">
                      <f:validateLength minimum="6" maximum="12" />
                    </h:inputSecret>
                  </div>
                    
                </rich:panel>
                
                <div>
                  <a4j:commandButton value="" action="#{updateCredentialsBean.changePasswordAction}"
                    oncomplete="javascript:if(#{empty facesContext.maximumSeverity}){Richfaces.showModalPanel('successPanel')}" styleClass="left"><span class="save"><h:outputText value="#{messages.updatecred_changePasswordBtn}" /></span></a4j:commandButton>
                  <a4j:commandButton value="" action="go_home" immediate="true" styleClass="left"><span class="cancel"><h:outputText value="#{messages.button_cancel}" /></span></a4j:commandButton>
                </div>
                
              </a4j:form>
      
              
            </div>
          </td>
        </tr>
      </tbody>
    </table>


    <rich:modalPanel id="successPanel" autosized="true" zindex="2000">
      <f:facet name="header">
        <h:outputText value="#{messages.updatecred_successHeader}" />
      </f:facet>
      <p><h:outputText value="#{messages.updatecred_successComment}" /></p>
      <a4j:form>
        <a4j:commandButton onclick="Richfaces.hideModalPanel('successPanel')" action="go_home"
          value="#{messages.button_ok}"></a4j:commandButton>
      </a4j:form>
    </rich:modalPanel>
    
    <div style="margin-bottom:300px"></div>

  </ui:define>
    

</ui:composition>