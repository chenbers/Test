<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:v="urn:schemas-microsoft-com:vml"
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core" 
    xmlns:c="http://java.sun.com/jstl/core"
	xmlns:a4j="http://richfaces.org/a4j" 
	xmlns:rich="http://richfaces.org/rich"
	xmlns:tiwi="http://pro.tiwi.com/jsf">

<f:view contentType="text/html" locale="#{localeBean.locale}"> 
<f:loadBundle basename="com.inthinc.pro.resources.Messages" var="messages" />

<head>
<script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>

<c:set var="titleText" value="#{messages.title} - #{title}"/>
<title>#{title ne null ? titleText : messages.title}</title>
<link media="screen" type="text/css" href="#{request.contextPath}/css/richfaces.css" rel="stylesheet" />
<link media="screen" type="text/css" href="#{request.contextPath}/css/main.css" rel="stylesheet" />

<tiwi:conditionalCSS browserVersion="IE 6">
<link rel="stylesheet" type="text/css" href="#{request.contextPath}/css/ie6.css" />
<style type="text/css">
.tree_back, .recent_back {
	width: auto;
}
</style>
</tiwi:conditionalCSS>

<tiwi:conditionalCSS browserVersion="IE 7">
<link rel="stylesheet" type="text/css" href="#{request.contextPath}/css/ie7.css" />
<style type="text/css">
.tree_back, .recent_back {
	width: auto;
}
</style>
</tiwi:conditionalCSS>

<link rel="icon" href="#{request.contextPath}/favicon.ico" type="image/x-icon"/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />


<a4j:loadScript src="/js/jquery-1.4.2.min.js"/>
<!--<a4j:loadScript src="/js/jquery-1.3.2.js"/>-->
<a4j:loadScript src="/js/ui.core.js"/>
<a4j:loadScript src="/js/ui.datepicker.js"/>
<a4j:loadScript src="/js/RoboHelp_CSH.js"/>
<script type="text/javascript"> 
	jQuery.noConflict(); 
	// Avoid `console` errors in browsers that lack a console.
	(function() {
	    var method;
	    var noop = function () {};
	    var methods = [
	        'assert', 'clear', 'count', 'debug', 'dir', 'dirxml', 'error',
	        'exception', 'group', 'groupCollapsed', 'groupEnd', 'info', 'log',
	        'markTimeline', 'profile', 'profileEnd', 'table', 'time', 'timeEnd',
	        'timeStamp', 'trace', 'warn'
	    ];
	    var length = methods.length;
	    var console = (window.console = window.console || {});

	    while (length--) {
	        method = methods[length];

	        // Only stub undefined methods.
	        if (!console[method]) {
	            console[method] = noop;
	        }
	    }
	}());
    document.onmousedown = resetTimerWarning;
    var timerIdWarning;
    var timerIdLogout;

    timerIdWarning = window.setTimeout("timeOutWarning()", 10000);
    timerIdLogout = window.setTimeout("timeOutLogout()", 15000);


    function resetTimerWarning() {
        window.clearTimeout(timerIdWarning);
        window.clearTimeout(timerIdLogout);

        timerIdWarning = window.setTimeout("timeOutWarning()", 10000);
        timerIdLogout = window.setTimeout("timeOutLogout()", 15000);
    }

    function timeOutWarning() {
        Richfaces.showModalPanel('sessionTimeoutWarning');
    }
    function timeOutLogout(){
//                    var xmlhttp;
//            if (window.XMLHttpRequest)
//            {// code for IE7+, Firefox, Chrome, Opera, Safari
//                xmlhttp=new XMLHttpRequest();
//            }
//            else
//            {// code for IE6, IE5
//                xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
//            }
//
//            xmlhttp.open("POST","/app/session_kill",true);
//            xmlhttp.send();
        window.location.href = ('#{facesContext.externalContext.requestContextPath}/logout');

    }

</script>
<!-- Override "scripts" to include any javascript needed for individual pages -->

 <ui:insert name="scripts" />
 
 
	<f:verbatim rendered="#{googleAnalyticsBean.track}">
		<script type="text/javascript">
	
		 var _gaq = _gaq || [];
		 _gaq.push(['_setAccount', '#{googleAnalyticsBean.account}']);
		 _gaq.push(['_trackPageview']);
		
		 (function() {
		   var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		   ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		   var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		 })();
		
		</script>
	</f:verbatim>
	<link rel="stylesheet" href="#{request.contextPath}/css/fleet-min.css" />
</head>
    <body onload="if (typeof bodyLoad != 'undefined') bodyLoad()" onunload="if (typeof bodyUnload != 'undefined') bodyUnload()">
    <ui:insert name="timeoutWarning">
    <ui:include src="/includes/sessionTimeoutWarning.xhtml">
    </ui:include>
    </ui:insert>
    <script type="text/javascript"></script>
    <ui:insert name="header">
        <ui:include src="/includes/header.xhtml">
        </ui:include>
    </ui:insert>
    <ui:insert name="navigation">
        <ui:include src="/includes/navigation.xhtml" >
        <ui:param name="context" value="layout"/>
        </ui:include>
    </ui:insert>
    <ui:insert name="subnavigation">
        <!--  <ui:include src="/includes/driverSubNavigation.xhtml"/>   -->
    </ui:insert>


    <div id="wrapper">
    <div class="wrapper_top"></div>
    <ui:insert name="content">
    </ui:insert>
    <div class="wrapper_bottom"></div>
    </div>

    <ui:insert name="footer">
        <ui:include src="/includes/footer.xhtml" />

        <f:verbatim rendered="#{chartBeatBean.track}">
        <script type="text/javascript">
			var _sf_async_config={uid:#{chartBeatBean.uid},domain:"#{chartBeatBean.domain}"};
			(function(){
			  function loadChartbeat() {
			    window._sf_endpt=(new Date()).getTime();
			    var e = document.createElement('script');
			    e.setAttribute('language', 'javascript');
			    e.setAttribute('type', 'text/javascript');
			    e.setAttribute('src',
			       (("https:" == document.location.protocol) ? "https://s3.amazonaws.com/" : "http://") +
			       "static.chartbeat.com/js/chartbeat.js");
			    document.body.appendChild(e);
			  }
			  var oldonload = window.onload;
			  window.onload = (typeof window.onload != 'function') ?
			     loadChartbeat : function() { oldonload(); loadChartbeat(); };
			})();		
		</script>
		</f:verbatim>
    </ui:insert>
    <ui:insert name="errorPopup">
        <ui:include src="/includes/errorPopup.xhtml" />
    </ui:insert>

    <a4j:form>
        <a4j:jsFunction limitToList="true" name="reloadAjaxPanels" reRender="#{ajaxPanels}" />
    </a4j:form>
    </body>
</f:view>
</html>
