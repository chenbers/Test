<ui:composition
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:security="http://pro.tiwi.com/jsf/security">
	
	<h:panelGroup id="groupPanel">
		<h:panelGroup rendered="#{organizationBean.selectedGroupNode ne null}">

			<h:outputText rendered="#{organizationBean.groupState eq 'VIEW'}">
				<ui:include src="/includes/admin/groupView.xhtml">
					<ui:param name="groupTreeNode"
						value="#{organizationBean.selectedGroupNode}" />
				</ui:include>
			</h:outputText>



			<h:outputText rendered="#{organizationBean.groupState ne 'VIEW'}">
				<ui:include src="/includes/admin/groupEdit.xhtml">
					<ui:param name="groupTreeNode"
						value="#{organizationBean.inProgressGroupNode}" />
				</ui:include>

			</h:outputText>


		</h:panelGroup>
	</h:panelGroup>
	<div class="add_section_title">#{messages.group_default_view}</div>
	<div style="width: 100%; height: 510px">
	<table style="width: 100%" cellpadding="4" border="0" align="center">
		<tbody>
			<tr>
				<td style="font-weight: bold" width="100"></td>
			</tr>
			<tr>
				<td><h:panelGroup styleClass="map-border" layout="block">
					<div id="map-canvas" style="width: 500px; height: 500px; border: 0"></div>
				</h:panelGroup> 
				<script type="text/javascript">	
					
											    
   					if (GBrowserIsCompatible()) {
   					
   							GUnload();
   					
   	   					
   						map = new GMap2(document.getElementById("map-canvas"));
   						
   						map.addControl(new GMapTypeControl());
						map.setMapType(G_NORMAL_MAP);
						map.setCenter(new GLatLng(#{organizationBean.selectedGroupNode.group.mapCenter.lat},#{organizationBean.selectedGroupNode.group.mapCenter.lng}),#{organizationBean.selectedGroupNode.group.mapZoom});
						<h:outputText rendered="#{organizationBean.groupState eq 'VIEW'}">
							map.disableDragging();
							map.disableScrollWheelZoom();
							map.disableDoubleClickZoom();
						</h:outputText>
						<h:outputText rendered="#{organizationBean.groupState ne 'VIEW'}">
							map.enableGoogleBar();
							map.addControl(new GLargeMapControl());
						</h:outputText>
    				}
	    		</script> 
	    		</td>
			</tr>
			<tr>
				<td></td>
			</tr>
		</tbody>

	</table>
	</div>
	<h:outputText rendered="#{organizationBean.groupState eq 'EDIT'}">
	<div style="padding-top:25px">
	<ul id="grid_nav_dark">
		<li class="r"><h:panelGroup id="buttonPanelFooter">
			<a4j:commandLink rendered="#{organizationBean.groupState eq 'ADD'}"
				onclick="saveGroupNode()">
				<button value="submit" class="left"><span class="add"><h:outputText
					value="#{messages.button_create_unit}" /></span></button>
			</a4j:commandLink>
			<h:commandLink rendered="#{organizationBean.groupState eq 'EDIT'}"
				onclick="updateGroupNode()">
				<button value="submit" class="left"><span class="add"><h:outputText
					value="#{messages.button_save}" /></span></button>
			</h:commandLink>
			<a4j:commandLink rendered="#{organizationBean.groupState ne 'VIEW'}"
				action="#{organizationBean.changeState}"
				reRender="groupPanel,organizationTreePanel,buttonPanelFooter">
				<f:param name="state" value="VIEW" />
				<button value="submit" class="left"><span class="cancel"><h:outputText
					value="#{messages.button_cancel}" /></span></button>
			</a4j:commandLink>
		</h:panelGroup></li>
	</ul>
	</div>
	</h:outputText>

</ui:composition>