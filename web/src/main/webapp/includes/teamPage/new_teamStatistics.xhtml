<ui:composition 
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:iwi="http://pro.tiwi.com/jsf"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:t="http://myfaces.apache.org/tomahawk">

	<rich:tab label="Driver Statistics">
	
	<!-- Driver Statistics Table -->
	<a4j:outputPanel id="teamStatisticsOutputPanel">	
	
	<div class="section">

	    <div class="panel_w">
	       <div class="panel_content">
	       <rich:dataTable	value="#{teamBean.driverStatistics}" 
	       		id="drivers" 
	       		var="item"
				styleClass="datagrid" 
				rowClasses="tableOdd,tableEven"
				rows="10">				

				<rich:column>
					<f:facet name="header">
						Driver
					</f:facet>
					#{item.driver.person.fullName}
				</rich:column>
				<rich:column>
					<f:facet name="header">
						Score
					</f:facet>     
                    <ui:include src="/includes/scoreBox.xhtml">
	                    <ui:param name="score" value="#{item.score.overall}" />
	                    <ui:param name="scoreStyle" value="score_sm_1" /> 
	                    <ui:param name="item" value="#{item.driver.driverID}" /> 
	                    <ui:param name="scoreMappingId" value="driverPerformance"/>
						<ui:param name="context" value="driversOverall" />
                    </ui:include> 
				</rich:column>
				<rich:column>
					<f:facet name="header">
						Vehicle
					</f:facet>
					#{item.vehicle.name}
				</rich:column>
				<rich:column>
					<f:facet name="header">
						Trips
					</f:facet>
					#{item.score.trips}
				</rich:column>
				<rich:column>
					<f:facet name="header">
						Stops
					</f:facet>
					#{item.score.idleHiEvents + item.score.idleLoEvents + item.score.trips}
				</rich:column>
				<rich:column>
					<f:facet name="header">
						Miles Driven
					</f:facet>
                    <h:outputFormat value="#{messages.reports_distanceDrivenInUnits}" >
                    	<a4j:actionparam value="#{(item.score.endingOdometer - item.score.startingOdometer)/100}" converter="MilesToKilometersConverter"/>
                    	<a4j:actionparam value="mi" converter="MeasurementTextConverter"/>
                    </h:outputFormat>										
				</rich:column>
				<rich:column>
					<f:facet name="header">
						Drive Time
					</f:facet>
                    <h:outputFormat value="#{messages.reports_time}" >
                    	<a4j:actionparam value="#{item.score.driveTime/100}" converter="TimeToStringConverter"/>                    
                    </h:outputFormat>										
				</rich:column>
				<rich:column>
					<f:facet name="header">
						Idle Time
					</f:facet>
                    <h:outputFormat value="#{messages.reports_time}" >
                    	<a4j:actionparam value="#{(item.score.idleLo + item.score.idleHi)/100}" converter="TimeToStringConverter"/>                    
                    </h:outputFormat>										
				</rich:column>
				<rich:column>
					<f:facet name="header">
						Low Idle
					</f:facet>
                    <h:outputFormat value="#{messages.reports_time}" >
                    	<a4j:actionparam value="#{item.score.idleLo/100}" converter="TimeToStringConverter"/>                    
                    </h:outputFormat>					
				</rich:column>
				<rich:column>
					<f:facet name="header">
						High Idle
					</f:facet>
                    <h:outputFormat value="#{messages.reports_time}" >
                    	<a4j:actionparam value="#{item.score.idleHi/100}" converter="TimeToStringConverter"/>                    
                    </h:outputFormat>										
				</rich:column>
				<rich:column>
					<f:facet name="header">
						Idle %
					</f:facet>
					<h:outputText id="idlePercentageNonZero" rendered="#{item.score.driveTime != 0 and item.score.driveTime != null}" value="#{(item.score.idleHi+item.score.idleLo)*100/item.score.driveTime}" converter="DoubleConverter"/>
					<h:outputText id="idlePercentageZero" rendered="#{item.score.driveTime == 0 or item.score.driveTime == null}" value="0.00"/>																				
				</rich:column>
				<rich:column>
					<f:facet name="header">
						MPG
					</f:facet>
					#{item.score.mpgLight + item.score.mpgMedium + item.score.mpgHeavy}
				</rich:column>
				<rich:column>
					<f:facet name="header">
						Crashes
					</f:facet>
					#{item.score.crashTotal}
				</rich:column>
				<rich:column>
					<f:facet name="header">
						Flags
					</f:facet>
					#{item.score.seatbeltEvents + item.score.speedEvents + item.score.aggressiveAccelEvents + item.score.aggressiveBrakeEvents + item.score.aggressiveBumpEvents + item.score.aggressiveLeftEvents + item.score.aggressiveRightEvents}
				</rich:column>

			</rich:dataTable>
			</div>
	    </div>
	    
	    <div class="panel_sw">
	       <div class="panel_statusbar"/>
	   	</div>
   	</div>
   	</a4j:outputPanel>
   	
    <!-- End Driver Statistics Table -->
    </rich:tab>

</ui:composition>