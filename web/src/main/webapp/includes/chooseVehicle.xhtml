<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://java.sun.com/jstl/core"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich">

<!--
  A pop-up modal form that allows choosing a vehicle.

  Required Parameters:
  ==============
           reRender:  Id['s] (in format of call UIComponent.findComponent()) of components, rendered in case
                      of AjaxRequest caused by this component. Can be single id, comma-separated list of Id's,
                      or EL Expression with array or Collection.
         editorBean:  A bean that has a method named chooseVehicle(), called when the "choose" link is clicked
                      for a vehicle (the vehicleID will be passed as a request parameter).
           chosenID:  ID of the currently-chosen vehicle.

  To use:
  ==============
      <ui:include src="/includes/chooseVehicle.xhtml">
        <ui:param name="reRender" value="myStuff" />
        <ui:param name="editorBean" value="#{myBean}" />
      </ui:include>
-->

  <ui:composition>

    <rich:modalPanel id="chooseVehicle" headerClass="popupHeader" controlsClass="popupControls" width="500" height="380" zindex="2001">
      <f:facet name="header">
        <h:outputText value="#{messages.chooseVehicle_title}" />
      </f:facet>
      <f:facet name="controls">
        <h:graphicImage value="/images/modal_close.png" style="cursor:pointer" onclick="Richfaces.hideModalPanel('chooseVehicle')" />
      </f:facet>

      <a4j:form id="chooseVehicleForm">

        <rich:datascroller id="topChooseVehicleScroller" for="chooseVehicleTable" reRender="chooseVehicleTable,bottomChooseVehicleScroller" />

        <rich:dataTable id="chooseVehicleTable" value="#{vehiclesBean.items}" var="item" rowKeyVar="index" styleClass="datagrid"
          rows="10" rowClasses="tableOdd,tableEven" width="100%">
          <rich:column sortBy="#{item.name}" sortOrder="ASCENDING">
            <f:facet name="header"><h:outputText value="#{messages.vehiclesHeader_name}" /></f:facet>
            <h:outputText value="#{item.name}" />
          </rich:column>
          <rich:column sortBy="#{item.driver}">
            <f:facet name="header"><h:outputText value="#{messages.vehiclesHeader_driver}" /></f:facet>
            <h:outputText value="#{item.driver.person.first}" /><h:outputText value=" " /><h:outputText value="#{item.driver.person.last}" />
          </rich:column>
          <rich:column sortBy="#{item.group.name}">
            <f:facet name="header"><h:outputText value="#{messages.vehiclesHeader_group}" /></f:facet>
            <h:outputText value="#{item.group.name}" />
          </rich:column>
          <rich:column sortBy="#{item.active}">
            <f:facet name="header"><h:outputText value="#{messages.vehiclesHeader_active}" /></f:facet>
            <h:outputText value="#{item.active ? messages.active : messages.inactive}" />
          </rich:column>
          <rich:column>
            <f:facet name="header">
              <h:outputText value=" " />
            </f:facet>
            <a4j:commandLink rendered="#{item.vehicleID != chosenID}" action="#{editorBean.chooseVehicle}" onclick="Richfaces.hideModalPanel('chooseVehicle')" reRender="#{reRender}" value="#{messages.chooseVehicle_choose}">
              <f:param name="vehicleID" value="#{item.vehicleID}" />
            </a4j:commandLink>
            <h:outputText rendered="#{item.vehicleID == chosenID}" value="#{messages.chooseVehicle_chosen}" />
          </rich:column>
        </rich:dataTable>

        <rich:datascroller id="bottomChooseVehicleScroller" for="chooseVehicleTable" reRender="chooseVehicleTable,topChooseVehicleScroller" />

      </a4j:form>

    </rich:modalPanel>

  </ui:composition>

</html>