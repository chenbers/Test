<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:a4j="http://richfaces.org/a4j" xmlns:rich="http://richfaces.org/rich" xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://java.sun.com/jstl/core" xmlns:iwi="http://pro.tiwi.com/jsf" xmlns:h="http://java.sun.com/jsf/html" xmlns:t="http://myfaces.apache.org/tomahawk">


    <c:if test="#{empty inFlyOut}">
        <c:set var="inFlyOut" value="false" />
    </c:if>
    <c:choose>
        <c:when test="#{inFlyOut == 'true'}">
            <c:set var="displayTable" value="true" />
            <c:set var="flyOutImage" value="ico_minimize.png" />
        </c:when>
        <c:otherwise>
            <c:set var="displayTable" value="false" />
            <c:set var="flyOutImage" value="ico_expand.png" />
        </c:otherwise>
    </c:choose>

    <div class="panel_nw">

    <div class="panel_title" style="z-index: #{zorder}"><span class="gas">#{title}</span> <c:choose>
        <c:when test="#{empty flyNavRule}">
            <ui:include src="/includes/dateLinks.xhtml">
                <ui:param name="ajaxForm" value="#{ajaxForm}" />
                <ui:param name="ajaxStatusID" value="#{ajaxStatusID}" />
                <ui:param name="reRenderList" value="#{reRenderList}" />
                <ui:param name="thirtyDaysOn" value="#{thirtyDaysOn}" />
                <ui:param name="threeMonthsOn" value="#{threeMonthsOn}" />
                <ui:param name="sixMonthsOn" value="#{sixMonthsOn}" />
                <ui:param name="twelveMonthsOn" value="#{twelveMonthsOn}" />
                <ui:param name="duration" value="#{duration}" />
            </ui:include>
        </c:when>
        <c:otherwise>
            <ui:include src="/includes/dateLinksWithFlyOut.xhtml">
                <ui:param name="ajaxForm" value="#{ajaxForm}" />
                <ui:param name="ajaxStatusID" value="#{ajaxStatusID}" />
                <ui:param name="reRenderList" value="#{reRenderList}" />
                <ui:param name="thirtyDaysOn" value="#{thirtyDaysOn}" />
                <ui:param name="threeMonthsOn" value="#{threeMonthsOn}" />
                <ui:param name="sixMonthsOn" value="#{sixMonthsOn}" />
                <ui:param name="twelveMonthsOn" value="#{twelveMonthsOn}" />
                <ui:param name="duration" value="#{duration}" />
                <ui:param name="flyNavRule" value="#{flyNavRule}" />
                <ui:param name="flyOutImage" value="#{flyOutImage}" />
                <ui:param name="flySelectedTab" value="mpg_full_screen" />
                <ui:param name="groupID" value="#{mpgBean.groupID}" />
                <ui:param name="report" value="MPG_GROUP" />
            </ui:include>
        </c:otherwise>
    </c:choose></div>
    </div>
    <div class="panel_w">
    <div class="panel_content"><!-- Start xy graph --> <rich:panel id="mpgPanel" style="height:#{xyheight};width:#{xywidth}">
        <div id="mpgChartDiv" align="center"></div>
        <h:inputHidden value="#{barDef}" id="mpgDataElement" />
        <script type="text/javascript">
            var targetElement = document.getElementById("mpgDataElement");
              
            var chart = new FusionCharts("#{facesContext.externalContext.request.contextPath}/fusioncharts/ScrollColumn2D.swf", "ChartId", "#{xywidth}", "#{xyheight}", "0", "0");                                
            chart.setDataXML(targetElement.value);
            chart.setTransparent(true);          
            chart.render("mpgChartDiv");
          </script>
    </rich:panel> <!-- End xy graph --> <rich:panel>
        <div align="center"><h:graphicImage url="/images/legend_mpg.png" width="332" height="44" /></div>
    </rich:panel> <rich:panel rendered="#{displayTable}">
        <div class="spacer"></div>

        <div class="datagrid">
        
        <a4j:form id="mpgTableForm" ajaxSubmit="true" reRender="mpgTable, mpgTableTopScroller">
            <t:dataTable value="#{mpgBean.mpgEntities}" id="mpgTable" var="item" styleClass="datagrid" sortAscending="#{mpgBean.ascending}" sortColumn="#{mpgBean.sortColumn}"
                preserveSort="true" rowClasses="trendTableOdd,trendTableEven" cellspacing="1" width="100%">

                <t:column defaultSorted="true" sortable="true">
                    <f:facet name="header">
                        <t:commandSortHeader columnName="entity.entityName" propertyName="entity.entityName" arrow="true">
                            <h:outputText value="Name" />
                        </t:commandSortHeader>
                    </f:facet>
                    <h:commandLink action="#{mpgBean.navigateAction}" value="#{item.entity.entityName}">
                        <f:param value="#{item.entity.groupID}" />
                    </h:commandLink>
                </t:column>
                <t:column sortable="true">
                    <f:facet name="header">
                        <t:commandSortHeader columnName="entity.lightValue" arrow="true">
                            <h:outputText value="Light" />
                        </t:commandSortHeader>
                    </f:facet>
                    <h:outputText value="#{item.entity.lightValue}" />
                </t:column>
                <t:column sortable="true">
                    <f:facet name="header">
                        <t:commandSortHeader columnName="entity.mediumValue" arrow="true">
                            <h:outputText value="Medium" />
                        </t:commandSortHeader>
                    </f:facet>
                    <h:outputText value="#{item.entity.mediumValue}" />
                </t:column>
                <t:column sortable="true">
                    <f:facet name="header">
                        <t:commandSortHeader columnName="entity.heavyValue" arrow="true">
                            <h:outputText value="Heavy" />
                        </t:commandSortHeader>
                    </f:facet>
                    <h:outputText value="#{item.entity.heavyValue}" />
                </t:column>
            </t:dataTable>
        </a4j:form>
        
        </div>

    </rich:panel></div>
    </div>

    <div class="panel_sw">
    <div class="panel_statusbar"></div>
    </div>
</ui:composition>