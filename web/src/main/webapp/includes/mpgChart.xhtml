<ui:composition 
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://java.sun.com/jstl/core"
  	xmlns:iwi="http://pro.tiwi.com/jsf"
	xmlns:h="http://java.sun.com/jsf/html">


  <c:if test="#{empty inFlyOut}">
    <c:set var="inFlyOut" value="false" />
  </c:if>
  <c:choose>
    <c:when test="#{inFlyOut == 'true'}">
      <c:set var="displayLegend" value="false" />
      <c:set var="displayTable" value="true" />
      <c:set var="flyOutImage" value="ico_minimize.png" />
    </c:when>
    <c:otherwise>
      <c:set var="displayLegend" value="true" />
      <c:set var="displayTable" value="false" />
      <c:set var="flyOutImage" value="ico_expand.png" />
    </c:otherwise>
  </c:choose>
  
  <div>
    <div class="panel_nw">

      <div class="panel_title">
        <span class="gas">#{title}</span>
        <c:choose>
          <c:when test="#{empty flyNavRule}">
            <ui:include src="/includes/dateLinks.xhtml">
              <ui:param name="ajaxForm" value="#{ajaxForm}"/>
              <ui:param name="ajaxStatusID" value="#{ajaxStatusID}"/>
              <ui:param name="reRenderList" value="#{reRenderList}"/>     
              <ui:param name="thirtyDaysOn" value="#{thirtyDaysOn}"/>
              <ui:param name="threeMonthsOn" value="#{threeMonthsOn}"/>
              <ui:param name="sixMonthsOn" value="#{sixMonthsOn}"/>
              <ui:param name="twelveMonthsOn" value="#{twelveMonthsOn}"/>
              <ui:param name="duration" value="#{duration}" />
            </ui:include>
          </c:when>
          <c:otherwise>
    	    <ui:include src="/includes/dateLinksWithFlyOut.xhtml">
    	      <ui:param name="ajaxForm" value="#{ajaxForm}"/>
    	      <ui:param name="ajaxStatusID" value="#{ajaxStatusID}"/>
    	      <ui:param name="reRenderList" value="#{reRenderList}"/>			
    	      <ui:param name="thirtyDaysOn" value="#{thirtyDaysOn}"/>
    	      <ui:param name="threeMonthsOn" value="#{threeMonthsOn}"/>
    	      <ui:param name="sixMonthsOn" value="#{sixMonthsOn}"/>
    	      <ui:param name="twelveMonthsOn" value="#{twelveMonthsOn}"/>
        	  <ui:param name="duration" value="#{duration}" />
              <ui:param name="flyNavRule" value="#{flyNavRule}" />  
              <ui:param name="flyOutImage" value="#{flyOutImage}" />
              <ui:param name="flySelectedTab" value="mpg_full_screen" />
			</ui:include>
          </c:otherwise>
        </c:choose>
      </div>
    </div>
    <div class="panel_w">
      <div class="panel_content">
        
        <!-- Start xy graph --> 
        <rich:panel id="mpgPanel" style="height:#{xyheight};width:#{xywidth}">
          <h:inputHidden value="#{barDef}" id="mpgDataElement" />

          <div id="mpgChartDiv" align="center"></div>
          <script type="text/javascript">
            var targetElement = document.getElementById("mpgDataElement");
              
            var chart = new FusionCharts("../fusioncharts/ScrollColumn2D.swf", "ChartId", "#{xywidth}", "#{xyheight}", "0", "0");                                
            chart.setDataXML(targetElement.value);
                     
            chart.render("mpgChartDiv");
          </script>
        </rich:panel> 
        <!-- End xy graph -->
      
        <rich:panel rendered="#{displayLegend}">
          <div align="center"><img src="../images/legend_mpg.png" width="332" height="44"/></div>
        </rich:panel>
        
        <rich:panel rendered="#{displayTable}">
          <div class="spacer"></div>
          
          <div class="datagrid">
            <h:form id="mpgTable">  

              <rich:dataTable value="#{mpgBean.mpgEntities}" id="items"
                var="item" styleClass="datagrid"
                cellspacing="1" width="100%">

                <rich:column sortBy="#{item.entity.entityName}" styleClass="alt">
                  <f:facet name="header">
                    <h:outputText value="Fleet" />
                  </f:facet>
                  <h:outputLink value="#{item.goTo}">
                    <h:outputText value="#{item.entity.entityName}" />
                  </h:outputLink>
                </rich:column>
          
                <rich:column width="73" sortBy="#{item.entity.lightValue}">
                  <f:facet name="header">
                    <h:outputText value="Light" />
                  </f:facet>
                  <h:outputText value="#{item.entity.lightValue}" />
                </rich:column>
          
                <rich:column width="73" sortBy="#{item.entity.mediumValue}">
                  <f:facet name="header">
                    <h:outputText value="Medium" />
                  </f:facet>
                  <h:outputText value="#{item.entity.mediumValue}" />
                </rich:column>
          
                <rich:column width="73" sortBy="#{item.entity.heavyValue}">
                  <f:facet name="header">
                    <h:outputText value="Heavy" />
                  </f:facet>
                  <h:outputText value="#{item.entity.heavyValue}" />
                </rich:column>

              </rich:dataTable>
            </h:form>
            
          </div>
          
        </rich:panel>
                
      </div>
    </div>

    <div class="panel_sw">
      <div class="panel_statusbar"></div>
    </div>

  </div>
</ui:composition>