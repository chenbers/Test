<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html" 
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:c="http://java.sun.com/jstl/core"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:t="http://myfaces.apache.org/tomahawk"
    xmlns:pretty="http://ocpsoft.com/prettyfaces">



    <ui:param name="includeDetailsLink" value="#{not empty includeDetailsLink ? includeDetailsLink : true}"/>
    <ui:param name="includeExportLink" value="#{not empty includeExportLink ? includeExportLink : true}"/>
    <ui:param name="detailImage" value="#{maximized ? '/images/ico_minimize.png': '/images/ico_expand.png'}"/>
    <ui:param name="detailTitle" value="#{maximized ? messages.restore : messages.maximize}"/>
                <table class="panel_links" cellpadding="0" cellspacing="0"> 
                    <tr>
                        <td>
                            <h:form id="${id}_form" style="display: inline;">
                                <a4j:region>
                                    <a4j:status>
                                        <f:facet name="start">                    
                                            <h:graphicImage styleClass="ajax_status" value="/images/progress2.gif"/>
                                        </f:facet>
                                    </a4j:status> 
                                    <a4j:commandLink id="#{context}-durationPanelHeaderDays" 
                                        title="#{messages.duration_days}" 
                                        immediate="true" 
                                        styleClass="#{duration eq 'DAYS' ? 'selected_duration' : ''}" 
                                        reRender="#{reRenderList}" 
                                        value="#{messages.duration_days}">
                                        <a4j:actionparam name="duration" assignTo="#{duration}" value="DAYS" />
                                    </a4j:commandLink>
                                    <rich:spacer width="5"/>
                                    <a4j:commandLink id="#{context}-durationPanelHeaderThreeMonths" 
                                        title="#{messages.duration_three}" 
                                        immediate="true" 
                                        styleClass="#{duration eq 'THREE' ? 'selected_duration' : ''}" 
                                        reRender="#{reRenderList}" 
                                        value="#{messages.duration_three}">
                                        <a4j:actionparam name="duration" assignTo="#{duration}" value="THREE" />
                                    </a4j:commandLink> 
                                    <rich:spacer width="5"/>
                                    <a4j:commandLink id="#{context}-durationPanelHeaderSixMonths" 
                                        title="#{messages.duration_six}" 
                                        immediate="true" 
                                        styleClass="#{duration eq 'SIX' ? 'selected_duration' : ''}" 
                                        reRender="#{reRenderList}" 
                                        value="#{messages.duration_six}">
                                        <a4j:actionparam name="duration" assignTo="#{duration}" value="SIX" />
                                    </a4j:commandLink> 
                                    <rich:spacer width="5"/>
                                    <a4j:commandLink id="#{context}-durationPanelHeaderTwelveMonths"  
                                        title="#{messages.duration_twelve}" 
                                        immediate="true" 
                                        styleClass="#{duration eq 'TWELVE' ? 'selected_duration' : ''}" 
                                        reRender="#{reRenderList}" 
                                        value="#{messages.duration_twelve}">
                                        <a4j:actionparam name="duration" assignTo="#{duration}" value="TWELVE" />
                                    </a4j:commandLink> 
                                </a4j:region>
                            </h:form>
                        </td>
                
                        <td>
                    		<c:if test="#{includeExportLink}">
                            	<span id="#{id}_toolImage"><h:graphicImage value="/images/ico_tools.png" style="cursor: pointer;" title="#{messages.tool_menu}" /></span>
                    		</c:if>
                    		<c:if test="#{includeDetailsLink}">
                            	<a href="#{detailLink}" title="#{detailTitle}"><h:graphicImage value="#{detailImage}" /></a>
                    		</c:if>
            
                            <!--
                                IMPORTANT!!!!!!! Regardless of what the z-index is set to on this context menu, the parent div has a relative position. So if you're having trouble getting the
                                contextMenu to come to the front in IE6, then you will have to set the z-index on the parent div with the relative position. (This will be the div with
                                style="position:relative")
                            -->
                            <h:form id="${id}_detail_form" style="display: inline;">
                                <a4j:region>
                                    <rich:contextMenu event="onclick" attatched="true" disableDefaultMenu="false" submitMode="server" attachTo="#{id}_toolImage">
                                        <rich:menuItem ajaxSingle="true" rendered="true" iconDisabled="/images/ico_email.gif" icon="/images/ico_email.gif"
                                            onclick="Richfaces.showModalPanel('#{id}_singleEmail');return false;" value="#{messages.contextMenu_email_this_report}" id="#{context}-#{id}_email" submitMode="none">
                                        </rich:menuItem>
                        
                                        <rich:menuItem iconDisabled="/images/ico_pdf.gif" disabled="#{report eq null?'true':'false'}" icon="/images/ico_pdf.gif"
                                            value="#{messages.contextMenu_export_to_pdf}" action="#{dashBoardReportBean.exportReportToPDF}" id="#{context}-export">
                                            <a4j:actionparam assignTo="#{dashBoardReportBean.report}" value="#{report}" />
                                            <a4j:actionparam assignTo="#{dashBoardReportBean.duration}" converter="SimpleBeanConverter" value="#{duration}" />
                                        </rich:menuItem>
                                    </rich:contextMenu>
                                </a4j:region>
                            </h:form>
                        
                            <h:outputText id="#{id}_modalPanel">
                                <ui:include src="/includes/emailReportPopup.xhtml">
                                    <ui:param name="report" value="#{report}" />
                                    <ui:param name="duration" value="#{duration}" />
                                    <ui:param name="id" value="#{id}_singleEmail" />
                                    <ui:param name="reportBean" value="#{dashBoardReportBean}" />
                                    <ui:param name="context" value="#{context}-durationPanelHeader"/>
                                </ui:include>
                            </h:outputText>
                        </td>
                
                    </tr>
                </table>

</ui:composition>
