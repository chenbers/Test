<ui:composition template="/layout/layout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:security="http://pro.tiwi.com/jsf/security"
    xmlns:tiwiprofn="http://pro.tiwi.com/jsffunctions">
 
  <ui:param name="helpMapIDOverride" value="#{(personBean.add) ? '6' :''}"/>
  <ui:param name="adminSelected" value="current" />
  <ui:param name="title" value="#{personBean.add ? messages.adminHeader_addPerson : (personBean.batchEdit ? messages.adminHeader_editPeople : messages.adminHeader_editPerson)}"/>
  <ui:define name="scripts">
      <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/adminEdit.js"></script>
	  <style type="text/css">
		.role-panel {margin: auto;}
		.role-panel td {vertical-align: top;}
		.dnd-panel {width:100px;border:1px solid gray;padding:2px;display: block;}
	  </style>
  </ui:define>
  
  <ui:define name="content">
    <table width="920" border="0" cellspacing="0" cellpadding="0" align="center" style="margin: 0 auto 0 auto;">
      <tr>
      <td valign="top" width="130">
        <ui:include src="/includes/navigation/adminSideNav.xhtml">
          <ui:param name="selectedAction" value="#{(personBean.add) ? 'go_adminAddPerson' : 'go_adminPeople'}" />
          <ui:param name="parentAction" value="go_adminPeople" />
          <ui:param name="context" value="editPerson"/>
        </ui:include>
      </td>
      <td valign="top">
          <!-- START PANEL -->
   		<rich:dragIndicator id="indicator" />

        <a4j:form id="edit-form" >
		
          <div class="">
            <div class="panel_nw">
              <div class="panel_title">
                <span class="admin"><h:outputText value="#{personBean.add ? messages.adminHeader_addPerson : (personBean.batchEdit ? messages.adminHeader_editPeople : messages.adminHeader_editPerson)}" /></span>
                <span class="panel_links"></span>
              </div>
            </div>
            <div class="panel_w">
              <div class="panel_content">

                <ul id="grid_nav" style="margin: 0;">
                  <li class="r">
                    <h:commandButton id="editPersonSave1" action="#{personBean.save}" styleClass="left"><span class="save"><h:outputText value="#{messages.button_save}" /></span></h:commandButton>
                    <h:outputText value=" " /><h:commandButton id="editPersonCancel1" action="#{personBean.cancelEdit}" immediate="true" styleClass="left"><span class="cancel"><h:outputText value="#{messages.button_cancel}" /></span></h:commandButton>
                  </li>
                </ul>
                
                <ui:fragment rendered="${tiwiprofn:messagesAvailable()}">
                  <dl id="display-form:j_id122" class="rich-messages msg" style="">
                     <dt class="error">
                        <h:outputFormat value="#{messages.error_validationMsg}">
                           <f:param value="${tiwiprofn:getMessageCount()}"/>
                        </h:outputFormat>
                     </dt>
                  </dl>
                </ui:fragment>
                
                <rich:messages globalOnly="true" errorClass="error" fatalClass="error" warnClass="warning" infoClass="info" styleClass="msg"/>

                <div class="spacer"></div>

                <table width="790" border="0" cellspacing="0" cellpadding="0">
                  <tr>
                    <td width="390" valign="top">				  
                      <div class="add_section_title"><h:outputText value="#{messages.editPerson_personalInformation}" /></div>
                      <table width="380" border="0" cellspacing="2" cellpadding="4" align="center">
                        <ui:fragment rendered="#{not personBean.batchEdit}">
                        <tr>
                          <td width="100" valign="top">
                            <h:outputText value="#{messages.editPerson_first}" />
                            <span class="required">*</span>
                          </td>
                          <td>
                            <rich:message for="editPerson-first" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputText value="#{personBean.item.first}" id="editPerson-first" disabled="#{!personBean.item.userEditable or personBean.userInfoDisabled  }" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="20" required="#{(not personBean.batchEdit) or personBean.updateField['first']}" requiredMessage="#{messages.required}" />
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top"><h:outputText value="#{messages.editPerson_middle}" /></td>
                          <td>
                            <h:inputText value="#{personBean.item.middle}" id="editPerson-middle" disabled="#{!personBean.item.userEditable  or personBean.userInfoDisabled }" onchange="checkMultiple(this)" styleClass="text" size="30" maxlength="20" />
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <h:outputText value="#{messages.editPerson_last}" />
                            <span class="required">*</span>
                          </td>
                          <td>
                            <rich:message for="editPerson-last" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputText value="#{personBean.item.last}" id="editPerson-last" disabled="#{!personBean.item.userEditable  or personBean.userInfoDisabled }" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="20" required="#{(not personBean.batchEdit) or personBean.updateField['last']}" requiredMessage="#{messages.required}" />
                          </td>
                        </tr>
                        <tr>
                        <td width="100" valign="top"><h:outputText value="#{messages.editPerson_suffix}" /></td>
                          <td>
                            <h:selectOneMenu value="#{personBean.item.suffix}" id="editPerson-suffix" disabled="#{!personBean.item.userEditable  or personBean.userInfoDisabled }" onchange="checkMultiple(this)">
                              <f:selectItem itemLabel="" />
                              <f:selectItem itemValue="#{messages.editPerson_suffixJr}" />
                              <f:selectItem itemValue="#{messages.editPerson_suffixSr}" />
                              <f:selectItem itemValue="#{messages.editPerson_suffixIII}" />
                            </h:selectOneMenu>
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top"><h:outputText value="#{messages.editPerson_dob}" /></td>
                          <td>
                            <rich:message for="editPerson-dob" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <rich:calendar value="#{personBean.item.dob}" id="editPerson-dob" disabled="#{!personBean.item.userEditable  or personBean.userInfoDisabled }" todayControlMode="hidden" enableManualInput="true" converterMessage="#{messages.editPerson_dateFormat}" timeZone="#{personBean.utcTimeZone}" />
                          </td>
                        </tr>
                        </ui:fragment>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{personBean.batchEdit}" id="update_editPerson-gender" disabled="#{!personBean.item.userEditable  or personBean.userInfoDisabled }" value="#{personBean.updateField['gender']}" />
                            <h:outputText value="#{messages.editPerson_gender}" />
                          </td>
                          <td>
                            <h:selectOneMenu value="#{personBean.item.gender}" id="editPerson-gender" disabled="#{!personBean.item.userEditable  or personBean.userInfoDisabled }" onchange="checkMultiple(this)" converter="SimpleBeanConverter">
<!--                               <f:selectItem itemLabel="" />  -->
                              <f:selectItems value="#{personBean.genders}" />
                            </h:selectOneMenu>
                          </td>
                        </tr>
                      </table>
                        
                      <div class="spacer"></div>

					  <h:panelGroup id="driverInfoPanel" >
                      <div class="add_section_title">
                        <h:selectBooleanCheckbox rendered="#{not personBean.batchEdit}" id="editPerson-isDriver" value="#{personBean.item.driverSelected }" disabled="#{personBean.driverInfoDisabled}" >
                  			<a4j:support event="onclick" ajaxSingle="true" reRender="editPerson-isDriver,driverInfoPanel" limitToList="true" />
                       	</h:selectBooleanCheckbox>
                        <h:outputText value="#{messages.editPerson_driverInformation}" />
                      </div>
					  <rich:panel id="driverInfo" rendered="#{personBean.item.driverSelected}">
                      <table id="driverTable" width="380" border="0" cellspacing="2" cellpadding="4" align="center">
                        <ui:fragment rendered="#{not personBean.batchEdit}">
                        <tr>
                          <td width="100" valign="top"><h:outputText value="#{messages.editPerson_driver_license}" /></td>
                          <td>
                            <rich:message for="editPerson-driver_license" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputText value="#{personBean.item.driver.license}" id="editPerson-driver_license" onchange="checkMultiple(this)" styleClass="text" size="30" maxlength="20" disabled="#{personBean.driverInfoDisabled}"/>
                          </td>
                        </tr>
                        </ui:fragment>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{personBean.batchEdit}" id="update_editPerson-driver_licenseClass" value="#{personBean.updateField['driver.licenseClass']}" disabled="#{personBean.driverInfoDisabled}" />
                            <h:outputText value="#{messages.editPerson_driver_licenseClass}" />
                          </td>
                          <td>
                           <h:inputText value="#{personBean.item.driver.licenseClass}" id="editPerson-driver_licenseClass" onchange="checkMultiple(this)" styleClass="text" size="10" maxlength="4" disabled="#{personBean.driverInfoDisabled}" />
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{personBean.batchEdit}" id="update_editPerson-driver_state" value="#{personBean.updateField['driver.state']}" disabled="#{personBean.driverInfoDisabled}" />
                            <h:outputText value="#{messages.editPerson_driver_state}" />
                          </td>
                          <td>
                            <rich:message for="editPerson-driver_state" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:selectOneMenu value="#{personBean.item.driver.state}" id="editPerson-driver_state" onchange="checkMultiple(this)" disabled="#{personBean.driverInfoDisabled}">
                         <f:selectItem itemLabel="" />
                         <f:converter  converterId="StateConverter"/>
                              <f:selectItems value="#{personBean.states}" />
                            </h:selectOneMenu>
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{personBean.batchEdit}" id="update_editPerson-driver_expiration" 
                            value="#{personBean.updateField['driver.expiration']}" disabled="#{personBean.driverInfoDisabled}" />
                            <h:outputText value="#{messages.editPerson_driver_expiration}" />
                          </td>
                          <td>
                            <rich:message for="editPerson-driver_expiration" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <rich:calendar value="#{personBean.item.driverExp}" id="editPerson-driver_expiration" 
                              onchange="checkMultiple('edit-form:editPerson-driver_expiration')" 
                              oninputchange="checkMultiple('edit-form:editPerson-driver_expiration')" ondateselect="checkMultiple('edit-form:editPerson-driver_expiration')" 
                              enableManualInput="true" 
                              converterMessage="#{messages.editPerson_dateFormat}" 
                              timeZone="#{personBean.utcTimeZone}" disabled="#{personBean.driverInfoDisabled}" /> 
                                
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{personBean.batchEdit}" id="update_editPerson-driver_certifications" value="#{personBean.updateField['driver.certifications']}" disabled="#{personBean.driverInfoDisabled}" />
                            <h:outputText value="#{messages.editPerson_driver_certifications}" />
                          </td>
                          <td>
                            <h:inputText value="#{personBean.item.driver.certifications}" id="editPerson-driver_certifications" onchange="checkMultiple(this)" styleClass="text" size="30" maxlength="160" disabled="#{personBean.driverInfoDisabled}" />
                          </td>
                        </tr>
                        <ui:fragment rendered="#{personBean.accountIsHOS}">
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{personBean.batchEdit}" id="update_editPerson-driver_dot" value="#{personBean.updateField['driver.dot']}"  disabled="#{personBean.driverInfoDisabled}" />
                            <h:outputText value="#{messages.editPerson_driver_dot}" />
                          </td>
                          <td>
                            <h:selectOneMenu value="#{personBean.item.driver.dot}" 
                              id="editPerson-driver_dot" 
                                onchange="checkMultiple(this)"
                                converter="SimpleBeanConverter" disabled="#{personBean.driverInfoDisabled}">
                              <f:selectItems value="#{personBean.dotTypes}"/>
                            </h:selectOneMenu>
                          </td>
                        </tr>
                        </ui:fragment>
                        <tr>
                          <td width="100" valign="top">
                             <ui:include src="../../includes/admin/inputLabel.xhtml">
                           <ui:param name="required" value="TRUE"/>
                           <ui:param name="for" value="editPerson-driver_groupID"/>
                           <ui:param name="fieldName" value="driver.groupID"/>
                           <ui:param name="editBean" value="#{personBean}"/>
                           <ui:param name="label" value="#{messages.editPerson_driver_team}"/>
                       </ui:include>
                          </td>
                          <td>
     	                       <rich:message for="editPerson-driver_groupID" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
		  	 					<h:selectOneMenu value="#{personBean.item.driver.groupID}" id="editPerson-driver_groupID" style="width:200px;float:none;"
    	                          		required="#{personBean.item.driverSelected and (not personBean.batchEdit)}" 
        	                      		requiredMessage="#{messages.required}"
        	                      		onchange="checkMultiple('edit-form:editPerson-driver_groupID')" disabled="#{personBean.driverInfoDisabled}">
 		        	    			<f:selectItem itemLabel="" />
     		        	    		<f:selectItems value="#{personBean.teams}" />
								</h:selectOneMenu>
					  	 	
								<ui:include src="/includes/dhtmlSelectBox.xhtml">	
     			 					<ui:param name="selectBoxID" value="edit-form:editPerson-driver_groupID" />
     			 					<ui:param name="disabled" value="#{personBean.driverInfoDisabled}" />
								</ui:include>
                            
                            
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <ui:include src="../../includes/admin/inputLabel.xhtml">
                           <ui:param name="required" value="TRUE"/>
                           <ui:param name="fieldName" value="driver.status"/>
                           <ui:param name="for" value="editPerson-driver_status"/>
                           <ui:param name="editBean" value="#{personBean}"/>
                           <ui:param name="label" value="#{messages.editPerson_driver_status}"/>
                      		</ui:include>
                          </td>
                          <td>
                            <rich:message for="editPerson-driver_status" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:selectOneMenu value="#{personBean.item.driver.status}" 
                              id="editPerson-driver_status" 
                                required="#{personBean.item.driverSelected and (not personBean.batchEdit)}" 
                                requiredMessage="#{messages.required}"
                                onchange="checkMultiple(this)"
                                converter="SimpleBeanConverter" disabled="#{personBean.driverInfoDisabled}">
                              <f:selectItems value="#{personBean.statuses}"/>
                            </h:selectOneMenu>
                          </td>
                        </tr>
                        </table>
                        </rich:panel>

					    
                         <div class="spacer"></div>
                          <ui:fragment rendered="#{not personBean.batchEdit and personBean.item.driverSelected}">
                         <div id="rfidSection">
                   		 <div class="add_section_title"><h:outputText value="#{messages.editPerson_rfidInformation}" /></div>
                         <table id="rfidTable" width="380" border="0" cellspacing="2" cellpadding="4" align="center">
                         <tr>
                          <td width="100" valign="top">
                           <ui:include src="../../includes/admin/inputLabel.xhtml">
                           		<ui:param name="required" value="FALSE"/>
                           		<ui:param name="fieldName" value="driver.barcode"/>
                          		<ui:param name="for" value="editPerson-driver_barcode"/>
                           		<ui:param name="editBean" value="#{personBean}"/>
                           		<ui:param name="label" value="#{messages.editPerson_driver_rfid_barcode}"/>
         					</ui:include>
						  </td>
                          <td>
                           <rich:message for="editPerson-driver_barcode" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />	
                            <h:inputText value="#{personBean.item.driver.barcode}" id="editPerson-driver_barcode" onchange="checkMultiple(this)" styleClass="text" size="30" maxlength="10" disabled="#{personBean.rfidInfoDisabled}" />
                          </td>
                        </tr>
                         <tr>
                            <td width="100"><h:outputText value="#{messages.editPerson_driver_rfid1}:" /></td>
                            <td>
                              <h:outputText value="#{personBean.item.driver.rfid1}">
                                <f:converter converterId="HexConverter" />
                              </h:outputText>
                            </td>
                          </tr>
                          <tr>
                            <td width="100"><h:outputText value="#{messages.editPerson_driver_rfid2}:" /></td>
                            <td>
                              <h:outputText value="#{personBean.item.driver.rfid2}">
                                <f:converter converterId="HexConverter" />
                              </h:outputText>
                            </td>
                          </tr>
                          <tr>
                            <td width="100"><h:outputText value="#{messages.editPerson_driver_fobID}:" /></td>
                            <td>
                              <a4j:outputPanel id="fobIDValues">
                              <h:outputText  rendered="#{(not empty personBean.item.driver.fobID)}" value="#{personBean.item.driver.fobID}"/>
                              <h:commandLink rendered="#{(not empty personBean.item.driver.fobID)}"
                                onclick="Richfaces.showModalPanel('clearFobID'); return false;" style="vertical-align: middle;"><img src="/tiwipro/images/ico_addAnother_remove.png" alt="#{messages.editPerson_clearFobPairing}" /></h:commandLink>
                              
                                </a4j:outputPanel>
                            </td>
                          </tr>
                       </table>
                       </div>
                       </ui:fragment>
                       <rich:panel id="cellProviderSection" rendered="#{personBean.item.driverSelected and personBean.accountPhoneControlEnabled}">
                       <div class="add_section_title">
                           <h:selectBooleanCheckbox rendered="#{not personBean.batchEdit}" id="editPerson-isProviderSelected" value="#{personBean.item.providerInfoSelected}" disabled="#{personBean.rfidInfoDisabled}">
                         	<a4j:support event="onclick" ajaxSingle="true" reRender="editPerson-isProviderSelected,editPerson-cellProviderData" limitToList="true" />
                           </h:selectBooleanCheckbox>
                           <h:outputText value="#{messages.editPerson_cellProviderSection}" />
                       </div>
                       <rich:panel id="editPerson-cellProviderData">
                       <rich:panel id="cellInfo" rendered="#{personBean.item.providerInfoSelected}">
                       <table id="cellProviderTable" width="380" border="0" cellspacing="2" cellpadding="4" align="center">
	                       <tr>
	                         <td width="110" valign="top">
	                           <ui:include src="../../includes/admin/inputLabel.xhtml">
		                           <ui:param name="required" value="TRUE"/>
		                           <ui:param name="for" value="editPerson_driver_provider"/>
		                           <ui:param name="fieldName" value="cellblock.provider"/>
		                           <ui:param name="editBean" value="#{personBean}"/>
		                           <ui:param name="label" value="#{messages.editPerson_driver_providerType}:"/>
		                           <ui:param name="context" value="editPersonDriverPhoneProviderGroup" />
                               </ui:include>
	                         </td>
	                         <td>
	                           <h:selectOneMenu value="#{personBean.item.cellblock.provider}" id="editPerson_driver_provider" required="#{not personBean.batchEdit}" 
                                        requiredMessage="#{messages.required}" onchange="checkMultiple(this)" disabled="#{personBean.rfidInfoDisabled}">
	                             <f:selectItems value="#{personBean.providerTypes}" />
	                           </h:selectOneMenu>
	                         </td>
	                       </tr>
                           <tr>
                               <td width="110" valign="top">
                                   
                                   <ui:include src="../../includes/admin/inputLabel.xhtml">
	                                   <ui:param name="required" value="TRUE"/>
	                                   <ui:param name="for" value="editPerson_driver_providerUsername"/>
	                                   <ui:param name="fieldName" value="cellblock.providerUser"/>
	                                   <ui:param name="editBean" value="#{personBean}"/>
	                                   <ui:param name="label" value="#{messages.editPerson_driver_providerUsername}:"/>
	                                   <ui:param name="context" value="editPersonDriverPhoneProviderGroup" />
                                   </ui:include>   
                               </td> 
                               <td><rich:message for="editPerson_driver_providerUsername" errorClass="field-error"
                                   fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" /> <h:inputText
                                   value="#{personBean.item.cellblock.providerUser}" id="editPerson_driver_providerUsername"
                                   onchange="checkMultiple(this)" styleClass="text" size="30" maxlength="50" required="#{not personBean.batchEdit}" requiredMessage="#{messages.required}" disabled="#{personBean.rfidInfoDisabled}"/></td>
                           </tr>
                                                   <tr>
                          <td width="100" valign="top">
                            <h:outputText value="#{messages.editPerson_driver_providerPassword}:" />
                            <h:outputText rendered="#{not personBean.batchEdit and not personBean.item.providerInfoExists}" styleClass="required" value=" *" />
                          </td>
                          <td>
                            <rich:message for="editPerson_driver_providerPassword" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputSecret value="#{personBean.item.cellblock.providerPassword}" id="editPerson_driver_providerPassword" redisplay="true" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="50" required="#{not personBean.batchEdit and not personBean.item.providerInfoExists}" requiredMessage="#{messages.required}" disabled="#{personBean.rfidInfoDisabled}">
                            </h:inputSecret>
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <h:outputText value="#{messages.editPerson_confirmPassword}" />
                            <h:outputText rendered="#{not personBean.batchEdit and not personBean.item.providerInfoExists}" styleClass="required" value="*" />
                          </td>
                          <td>
                            <rich:message for="editPerson_driver_confirmProviderPassword" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputSecret value="#{personBean.item.confirmProviderPassword}" id="editPerson_driver_confirmProviderPassword" redisplay="true" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="50" required="#{not personBean.batchEdit and not personBean.item.providerInfoExists}" requiredMessage="#{messages.required}" disabled="#{personBean.rfidInfoDisabled}" />
                          </td>
                        </tr>
                           <tr>
                            <td width="100"><h:outputText value="#{messages.editPerson_driver_providerCellStatus}:" /></td>
                            <td><h:outputText value="#{messages[personBean.item.cellblock.cellStatus]}" /></td>
                          </tr>
						   <ui:fragment rendered="#{not personBean.batchEdit}">
                           <tr>
                               <td>
                                    <ui:include src="../../includes/admin/inputLabel.xhtml">
                                       <ui:param name="required" value="TRUE"/>
                                       <ui:param name="for" value="editPerson_driver_providerCellPhone"/>
                                       <ui:param name="fieldName" value="cellblock.cellPhone"/>
                                       <ui:param name="editBean" value="#{personBean}"/>
                                       <ui:param name="label" value="#{messages.editPerson_driver_providerCellPhone}:"/>
                                       <ui:param name="context" value="editPersonDriverPhoneProviderGroup" />
                                   </ui:include> 
                               </td>
                               <td><rich:message for="editPerson_driver_providerCellPhone" errorClass="field-error"
                                   fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" /> <h:inputText
                                   value="#{personBean.item.cellblock.cellPhone}" id="editPerson_driver_providerCellPhone"
                                   onchange="checkMultiple(this)" styleClass="text" size="30" maxlength="10" required="#{not personBean.batchEdit}" requiredMessage="#{messages.required}" disabled="#{personBean.rfidInfoDisabled}"/></td>
                           </tr>
                           </ui:fragment>
                       </table>
                       </rich:panel><!--  close cellInfo -->
                       <rich:panel id="cellStatusDisabled" rendered="#{personBean.item.providerInfoSelected and personBean.item.cellblock.cellStatus eq 'DISABLED'}">
                       	<table width="370" border="0" cellspacing="2" cellpadding="4" align="center">
                           <tr>
                            <td width="100"><h:outputText value="#{messages.editPerson_driver_providerType}:" /></td>
                            <td><h:outputText value="#{personBean.item.cellblock.provider.name}" /></td>
                          </tr>
                          <tr>
                            <td width="100"><h:outputText value="#{messages.editPerson_driver_providerUsername}:" /></td>
                            <td>
                              <h:outputText value="#{personBean.item.cellblock.providerUser}">
                              </h:outputText>
                            </td>
                          </tr>                          
                          <tr>
                            <td width="100"><h:outputText value="#{messages.editPerson_driver_providerCellPhone}:" /></td>
                            <td>
                              <h:outputText value="#{personBean.item.cellblock.cellPhone}">
                              </h:outputText>
                            </td>
                          </tr>
                           <tr>
                            <td width="100"><h:outputText value="#{messages.editPerson_driver_providerCellStatus}:" /></td>
                            <td><h:outputText value="#{messages[personBean.item.cellblock.cellStatus]}" /></td>
                          </tr>
                        </table>
                       </rich:panel><!--  close cellStatusDisabled -->
                       </rich:panel><!--  close editPerson-cellProviderData -->
                       </rich:panel><!--  close cellProviderSection -->
                       </h:panelGroup>
					</td>
                    <td width="10"><h:graphicImage value="/images/x.gif" width="10" /></td>
                    <td width="390" valign="top">
                      <div class="add_section_title"><h:outputText value="#{messages.editPerson_employeeInformation}" /></div>

                      <table width="380" border="0" cellspacing="2" cellpadding="4" align="center">     
                      <ui:fragment rendered="#{not personBean.batchEdit}">  
                        <tr>
                          <td width="160" valign="top">
                            <h:outputText value="#{messages.editPerson_empid}" />
                          </td>
                          <td>
                            <rich:message for="editPerson-empId" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputText value="#{personBean.item.empid}" id="editPerson-empId" disabled="#{!personBean.item.userEditable or personBean.employeeInfoDisabled}" onchange="checkMultiple(this)" styleClass="text" size="30"
                              style="text-transform: uppercase;" maxlength="20" converter="ForceUpperCaseConverter"/>
                          </td>
                        </tr>   
                        </ui:fragment>
                        <tr>
                          <td width="160" valign="top">
                            <h:selectBooleanCheckbox rendered="#{personBean.batchEdit}" id="update_editPerson-reportsTo" disabled="#{!personBean.item.userEditable}" value="#{personBean.updateField['reportsTo']}" />
                            <h:outputText value="#{messages.editPerson_reportsTo}" />
                          </td>
                          <td>
                            <h:inputText value="#{personBean.item.reportsTo}" id="editPerson-reportsTo" disabled="#{!personBean.item.userEditable or personBean.employeeInfoDisabled}" onchange="checkMultiple(this)" styleClass="text" size="30" maxlength="60" />
                            <rich:suggestionbox for="editPerson-reportsTo" suggestionAction="#{personBean.findPeople}" eventsQueue="reportsToQueue" var="personName">
                              <h:column><h:outputText value="#{personName}"/></h:column>
                            </rich:suggestionbox>
                          </td>
                        </tr>
                        <tr>
                          <td width="160" valign="top">
                            <h:selectBooleanCheckbox rendered="#{personBean.batchEdit}" id="update_editPerson-title" disabled="#{!personBean.item.userEditable}" value="#{personBean.updateField['title']}" />
                            <h:outputText value="#{messages.editPerson_title}" />
                          </td>
                          <td>
                            <h:inputText value="#{personBean.item.title}" id="editPerson-title" disabled="#{!personBean.item.userEditable or personBean.employeeInfoDisabled}" onchange="checkMultiple(this)" styleClass="text" size="30" maxlength="30" />
                          </td>
                        </tr>
                         <tr>
                             <td width="160">
                                 <ui:include src="../../includes/admin/inputLabel.xhtml">
                                    <ui:param name="required" value="TRUE"/>
                                    <ui:param name="fieldName" value="locale"/>
                                    <ui:param name="for" value="editPerson-user_locale"/>
                                    <ui:param name="editBean" value="#{personBean}"/>
                                    <ui:param name="label" value="#{messages.editPerson_user_locale}"/>
                                 </ui:include>
                             </td>
                             <td>
                                 <rich:message for="editPerson-user_locale" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                                 <h:selectOneMenu id="editPerson-user_locale" value="#{personBean.item.locale}" converter="SimpleBeanConverter" onchange="checkMultiple(this)"  disabled="#{personBean.employeeInfoDisabled}">
                                      <f:selectItems value="#{localeBean.supportedLocalesItems}"/>
                                 </h:selectOneMenu>
                             </td>
                        </tr>
                        <tr>
                          <td width="160" valign="top">
                          	<ui:include src="../../includes/admin/inputLabel.xhtml">
								<ui:param name="required" value="TRUE"/>
								<ui:param name="for" value="editPerson-timeZone"/>
								<ui:param name="fieldName" value="timeZone"/>
								<ui:param name="editBean" value="#{personBean}"/>
								<ui:param name="label" value="#{messages.editPerson_timeZone}"/>
        					<ui:param name="context" value="editPersonTimeZone" />
							</ui:include>
                          </td>
                          <td>
                            <rich:message for="editPerson-timeZone" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:selectOneMenu value="#{personBean.item.timeZone}" 
                                    id="editPerson-timeZone" disabled="#{!personBean.item.userEditable or personBean.employeeInfoDisabled}" 
                                    onchange="checkMultiple(this)"
                                    required="#{not personBean.batchEdit}" 
                                    requiredMessage="#{messages.required}" 
                                    style="width:200px">
                              <f:selectItem itemLabel="" />
                              <f:converter  converterId="TimeZoneConverter" />
                              <f:selectItems value="#{personBean.timeZones}" />
                            </h:selectOneMenu>
                          </td>
                          
                        </tr>
                        <tr>
                             <td width="160">
                                 <ui:include src="../../includes/admin/inputLabel.xhtml">
                                    <ui:param name="required" value="TRUE"/>
                                    <ui:param name="fieldName" value="measurementType"/>
                                    <ui:param name="for" value="editPerson-user_person_measurementType"/>
                                    <ui:param name="editBean" value="#{personBean}"/>
                                    <ui:param name="label" value="#{messages.editPerson_user_measurementType}"/>
                                 </ui:include>
                             </td>
                             <td>
                                 <rich:message for="editPerson-user_person_measurementType" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                                 <h:selectOneMenu id="editPerson-user_person_measurementType" value="#{personBean.item.measurementType}" converter="SimpleBeanConverter" disabled="#{personBean.employeeInfoDisabled}">
                                     	<a4j:support ajaxSingle="true" event="onchange" oncomplete="checkMultiple(this);checkMultiple('user_person_fuelEfficiencyType')"  action="#{personBean.measurementTypeChosenAction}" reRender="editPerson-user_person_fuelEfficiencyType"/>
                                        <f:selectItems value="#{measurementBean.measurementTypeItems}"/>
                                 </h:selectOneMenu>
                             </td>
                        </tr>
                        <tr>
                             <td width="160">
                                 <ui:include src="../../includes/admin/inputLabel.xhtml">
                                    <ui:param name="required" value="TRUE"/>
                                    <ui:param name="fieldName" value="fuelEfficiencyType"/>
                                    <ui:param name="for" value="editPerson-user_person_fuelEfficiencyType"/>
                                    <ui:param name="editBean" value="#{personBean}"/>
                                    <ui:param name="label" value="#{messages.editPerson_user_fuelEfficiencyType}"/>
                                 </ui:include>
                             </td>
                             <td>
                                 <rich:message for="editPerson-user_person_fuelEfficiencyType" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                                 <h:selectOneMenu id="editPerson-user_person_fuelEfficiencyType" value="#{personBean.item.fuelEfficiencyType}" converter="SimpleBeanConverter" onchange="checkMultiple(this)" disabled="#{personBean.employeeInfoDisabled}">
                                        <f:selectItems value="#{personBean.fuelEfficiencyBean.fuelEfficiencyTypeItems}"/>
                                 </h:selectOneMenu>
                             </td>
                        </tr>
                      </table>
                      <rich:message for="editPerson-isUser" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                      <div class="add_section_title">
                        <h:selectBooleanCheckbox rendered="#{not personBean.batchEdit}" id="editPerson-isUser" disabled="#{!personBean.item.userEditable or personBean.loginInfoDisabled}" value="#{personBean.item.userSelected}">
                          <a4j:support event="onclick" ajaxSingle="true" reRender="editPerson-isUser,userInfoPanel, emailRequired" limitToList="true" />
                        </h:selectBooleanCheckbox>
                        <h:outputText value="#{messages.editPerson_userInformation}" />
                      </div>
   
                      <h:panelGroup id="userInfoPanel">
                      <h:outputText rendered="#{personBean.item.userSelected}">
                      <table id="userTable" width="380" border="0" cellspacing="2" cellpadding="4" align="center">
                        <ui:fragment rendered="#{not personBean.batchEdit}">
                        <tr>
                          <td width="100" valign="top">
                            <h:outputText value="#{messages.editPerson_user_username}" />
                            <span class="required">*</span>
                          </td>
                          <td>
                            <rich:message for="editPerson-user_username" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputText value="#{personBean.item.user.username}" id="editPerson-user_username" disabled="#{!personBean.item.userEditable or personBean.loginInfoDisabled}" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="30" required="#{personBean.item.userSelected and ((not personBean.batchEdit) or personBean.updateField['user.username'])}" requiredMessage="#{messages.required}" />
                          </td>
                        </tr>
                        <tr>
                        	<td width="100" valign="top">
	                        	<rich:spacer />
                        	</td>
                        	<td>
                        		<ui:include src="/includes/passwordStrength.xhtml" >
	                        		<ui:param name="formName" value="edit-form" />
                        		</ui:include>
                        	</td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <h:outputText value="#{messages.editPerson_user_password}" />
                            <h:outputText rendered="#{empty personBean.item.user.password}" styleClass="required" value=" *" />
                          </td>
                          <td>
                            <rich:message for="editPerson-user_password" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputSecret value="#{personBean.item.password}" id="editPerson-user_password" disabled="#{!personBean.item.userEditable or personBean.loginInfoDisabled}" redisplay="true" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="12" required="#{personBean.item.userSelected and empty personBean.item.user.password}" requiredMessage="#{messages.required}" validatorMessage="#{messages.editPerson_passwordFormat}"
                              onkeyup="testPasswordStrength(this.value, 'edit-form')">
                              <f:validator validatorId="com.inthinc.pro.validators.RegexValidator" />
                              <f:attribute name="regex" value="\S{6,12}" />
                            </h:inputSecret>
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <h:outputText value="#{messages.editPerson_confirmPassword}" />
                            <h:outputText rendered="#{empty personBean.item.user.password}" styleClass="required" value="*" />
                          </td>
                          <td>
                            <rich:message for="editPerson-confirmPassword" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputSecret value="#{personBean.item.confirmPassword}" id="editPerson-confirmPassword" disabled="#{!personBean.item.userEditable or personBean.loginInfoDisabled}" redisplay="true" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="12" required="#{personBean.item.userSelected and empty personBean.item.user.password}" requiredMessage="#{messages.required}" />
                          </td>
                        </tr>
                        
                        </ui:fragment>
                        <tr>
                          <td width="100" valign="top">
                          	<ui:include src="../../includes/admin/inputLabel.xhtml">
								<ui:param name="required" value="TRUE"/>
								<ui:param name="fieldName" value="user.groupID"/>
                                <ui:param name="for" value="editPerson-user_groupID"/>
								<ui:param name="editBean" value="#{personBean}"/>
								<ui:param name="label" value="#{messages.editPerson_user_group}"/>
							</ui:include>
                          </td>
                          <td>
                            <rich:message for="editPerson-user_groupID" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
	  	 					<h:selectOneMenu value="#{personBean.item.user.groupID}" id="editPerson-user_groupID" style="width:200px;"
  	                            	required="#{not personBean.batchEdit}" 
 	                                requiredMessage="#{messages.required}"
                              		onchange="checkMultiple('edit-form:editPerson-user_groupID')" disabled="#{personBean.loginInfoDisabled}">
 		            			<f:selectItem itemLabel="" />
     		            		<f:selectItems value="#{personBean.groups}" />
							</h:selectOneMenu>
							<ui:include src="/includes/dhtmlSelectBox.xhtml">	
    			 					<ui:param name="selectBoxID" value="edit-form:editPerson-user_groupID" />
    			 					<ui:param name="disabled" value="#{personBean.loginInfoDisabled}" />
							</ui:include>
                          </td>
                        </tr>
 	<security:authorize ifAnyGranted="ROLE_ADMIN">
                        <tr>
                          <td width="100" valign="top">
                          	<ui:include src="../../includes/admin/inputLabel.xhtml">
								<ui:param name="required" value="TRUE"/>
								<ui:param name="for" value="editPerson-user_role"/>
								<ui:param name="fieldName" value="user.roles"/>
								<ui:param name="editBean" value="#{personBean}"/>
								<ui:param name="label" value="#{messages.editPerson_user_role}"/>
							</ui:include>
                          </td>
                          <td>
                            <rich:message for="editPerson-user_role" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
						    <ui:include src="../../includes/admin/listPicker.xhtml">
						      <ui:param name="bean" value="#{personBean.rolePicker}" />
						      <ui:param name="id" value="editPerson-user_role" />
						      <ui:param name="formName" value="edit-form" />
						      <ui:param name="context" value="editPerson" />
						    </ui:include>
						</td>
						</tr>
						</security:authorize>
	
                        <tr>
                          <td width="100" valign="top">
                          	<ui:include src="../../includes/admin/inputLabel.xhtml">
								<ui:param name="required" value="TRUE"/>
								<ui:param name="for" value="editPerson-user_status"/>
								<ui:param name="fieldName" value="user.status"/>
								<ui:param name="editBean" value="#{personBean}"/>
								<ui:param name="label" value="#{messages.editPerson_user_status}"/>
							</ui:include>
                          </td>
                          <td>
                            <rich:message for="editPerson-user_status" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:selectOneMenu value="#{personBean.item.user.status}" 
                                 id="editPerson-user_status" disabled="#{!personBean.item.userEditable or personBean.loginInfoDisabled}" 
                                 required="#{not personBean.batchEdit}" 
                                 requiredMessage="#{messages.required}"
                                 onchange="checkMultiple(this)"
                                 converter="SimpleBeanConverter">
                             <f:selectItems value="#{personBean.statuses}"/>
                            </h:selectOneMenu>
                          </td>
                        </tr>
                        
                      </table>
                      </h:outputText>
                      </h:panelGroup>
                      <div class="spacer"></div>
                      <div class="add_section_title"><h:outputText value="#{messages.editPerson_notifications}" /></div>

                      <table width="380" border="0" cellspacing="2" cellpadding="4" align="center">
                        <ui:fragment rendered="#{not personBean.batchEdit}">
                        <tr>
                          <td width="120" valign="top">
                            <h:outputText value="#{messages.editPerson_priEmail}" />
                            <a4j:outputPanel id="emailRequired">
                             
                              <h:outputText value=" *" rendered="#{personBean.item.userSelected}" styleClass="required"/>
                            </a4j:outputPanel>
                          </td>
                          <td>
                            <rich:message for="editPerson-priEmail" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputText value="#{personBean.item.priEmail}" id="editPerson-priEmail" disabled="#{!personBean.item.userEditable or personBean.notificationsInfoDisabled}" onblur="populateAlertText()" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="62" validatorMessage="#{messages.editPerson_emailFormat}">
                              <f:validator validatorId="com.inthinc.pro.validators.EmailValidator" />
                            </h:inputText>
                          </td>
                        </tr>
                        <tr>
                          <td width="120" valign="top"><h:outputText value="#{messages.editPerson_secEmail}" /></td>
                          <td>
                            <rich:message for="editPerson-secEmail" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputText value="#{personBean.item.secEmail}" id="editPerson-secEmail" disabled="#{!personBean.item.userEditable or personBean.notificationsInfoDisabled}" onblur="populateAlertText()" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="62" validatorMessage="#{messages.editPerson_emailFormat}">
                              <f:validator validatorId="com.inthinc.pro.validators.EmailValidator" />
                            </h:inputText>
                          </td>
                        </tr>
                        <tr>
                          <td width="120" valign="top"><h:outputText value="#{messages.editPerson_priText}" /></td>
                          <td>
                            <rich:message for="editPerson-priText" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputText value="#{personBean.item.priText}" id="editPerson-priText" disabled="#{!personBean.item.userEditable or personBean.notificationsInfoDisabled}" onblur="populateAlertText()" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="62" validatorMessage="#{messages.editPerson_textMessageFormat}">
                                  <f:validator validatorId="com.inthinc.pro.validators.RegexValidator" />
	                              <f:attribute name="regex" value="#{messages.smsTextRegex}" />
                              	  <f:attribute name="regexErrorMessage" value="#{messages.editPerson_textMessageFormat}" />
                              
                            </h:inputText>
                          </td>
                        </tr>
                        <tr>
                          <td width="120" valign="top"><h:outputText value="#{messages.editPerson_secText}" /></td>
                          <td>
                            <rich:message for="editPerson-secText" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputText value="#{personBean.item.secText}" id="editPerson-secText" disabled="#{!personBean.item.userEditable or personBean.notificationsInfoDisabled}" onblur="populateAlertText()" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="62">
                                  <f:validator validatorId="com.inthinc.pro.validators.RegexValidator" />
	                              <f:attribute name="regex" value="#{messages.smsTextRegex}" />
                              	  <f:attribute name="regexErrorMessage" value="#{messages.editPerson_textMessageFormat}" />
                            </h:inputText>
                          </td>
                        </tr>
                        <tr>
                          <td width="120" valign="top"><h:outputText value="#{messages.editPerson_priPhone}" /></td>
                          <td>
                            <rich:message for="editPerson-priPhone" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputText value="#{personBean.item.priPhone}" id="editPerson-priPhone" disabled="#{!personBean.item.userEditable or personBean.notificationsInfoDisabled}" onblur="populateAlertText()" onchange="checkMultiple(this)" styleClass="text" size="30" maxlength="22" validatorMessage="#{messages.editPerson_phoneFormat}" converter="PhoneNumberConverter">
                                  <f:validateLength  maximum="22" />
                             	  <f:validator validatorId="com.inthinc.pro.validators.PhoneValidator" />
<!--                              <f:validator validatorId="com.inthinc.pro.validators.RegexValidator" />-->
<!--                              <f:attribute name="regex" value="\D?\d{3}\D*\d{3}\D?\d{4}" />-->
                            </h:inputText>
                          </td>
                        </tr>
                        <tr>
                          <td width="120" valign="top"><h:outputText value="#{messages.editPerson_secPhone}" /></td>
                          <td>
                            <rich:message for="editPerson-secPhone" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                            <h:inputText value="#{personBean.item.secPhone}" id="editPerson-secPhone" disabled="#{!personBean.item.userEditable or personBean.notificationsInfoDisabled}" onblur="populateAlertText()" onchange="checkMultiple(this)" styleClass="text" size="30" maxlength="22" validatorMessage="#{messages.editPerson_phoneFormat}" converter="PhoneNumberConverter">
                                  <f:validateLength  maximum="22" />
                                  <f:validator validatorId="com.inthinc.pro.validators.PhoneValidator" />
<!--                              <f:validator validatorId="com.inthinc.pro.validators.RegexValidator" />-->
<!--                              <f:attribute name="regex" value="\D?\d{3}\D*\d{3}\D?\d{4}" />-->
                            </h:inputText>
                          </td>
                        </tr>
                        </ui:fragment>
                        <tr>
                        	<td colspan="2"><rich:message for="editPerson-info" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" /></td>
                        </tr>
                        <tr>
                          <td width="120">
                            <ui:include src="../../includes/admin/inputLabel.xhtml">
                                 <ui:param name="required" value="FALSE"/>
                                 <ui:param name="fieldName" value="info"/>
                                 <ui:param name="for" value="editPerson-info"/>
                                 <ui:param name="iconSrc" value="/images/ico_info.png"/>
                                 <ui:param name="editBean" value="#{personBean}"/>
                                 <ui:param name="label" value="#{messages.myAccount_information}"/>
                            </ui:include>
                          </td>
                          <td>
                            <h:selectOneMenu value="#{personBean.item.info}" id="editPerson-info" disabled="#{!personBean.item.userEditable or personBean.notificationsInfoDisabled}" onchange="checkMultiple(this)" style="width:200px">
                              <f:selectItems value="#{personBean.alertOptions}" />
                            </h:selectOneMenu>
                          </td>
                        </tr>
                        <tr>
                          <td width="120">
                            <ui:include src="../../includes/admin/inputLabel.xhtml">
                                 <ui:param name="required" value="FALSE"/>
                                 <ui:param name="fieldName" value="warn"/>
                                 <ui:param name="for" value="editPerson-warn"/>
                                 <ui:param name="iconSrc" value="/images/ico_warning.png"/>
                                 <ui:param name="editBean" value="#{personBean}"/>
                                 <ui:param name="label" value="#{messages.myAccount_warning}"/>
         					<ui:param name="context" value="editPersonWarn" />
                            </ui:include>
                          </td>
                          <td>
                            <h:selectOneMenu value="#{personBean.item.warn}" id="editPerson-warn" disabled="#{!personBean.item.userEditable or personBean.notificationsInfoDisabled}" onchange="checkMultiple(this)" style="width:200px">
                              <f:selectItems value="#{personBean.alertOptions}" />
                            </h:selectOneMenu>
                          </td>
                        </tr>
                        <tr>
                          <td width="120">
                            <ui:include src="../../includes/admin/inputLabel.xhtml">
                                 <ui:param name="required" value="FALSE"/>
                                 <ui:param name="fieldName" value="crit"/>
                                 <ui:param name="for" value="editPerson-crit"/>
                                 <ui:param name="iconSrc" value="/images/ico_critical.png"/>
                                 <ui:param name="editBean" value="#{personBean}"/>
                                 <ui:param name="label" value="#{messages.myAccount_critical}"/>
                            </ui:include>
                          </td>
                          <td>
                            <h:selectOneMenu value="#{personBean.item.crit}" id="editPerson-crit" disabled="#{!personBean.item.userEditable or personBean.notificationsInfoDisabled}" onchange="checkMultiple(this)" style="width:200px">
                              <f:selectItems value="#{personBean.alertOptions}" />
                            </h:selectOneMenu>
                          </td>
                        </tr>
                      </table>
                    </td>
                  </tr>
                </table>

                <div class="required-key"><h:outputText value="#{messages.requiredKey}" /></div>

                <div class="spacer"></div>

                <ul id="grid_nav" style="margin: 0;">
                  <li class="r">
                    <h:commandButton id="editPersonSave2" action="#{personBean.save}" styleClass="left"><span class="save"><h:outputText value="#{messages.button_save}" /></span></h:commandButton>
                    <h:outputText value=" " /><h:commandButton id="editPersonCancel2"  action="#{personBean.cancelEdit}" immediate="true" styleClass="left"><span class="cancel"><h:outputText value="#{messages.button_cancel}" /></span></h:commandButton>
                  </li>
                </ul>

              </div>
            </div>
            <div class="panel_sw">
              <div class="panel_statusbar"></div>
            </div>
          </div>

          </a4j:form>
            <rich:modalPanel id="clearFobID" headerClass="popupHeader"
                controlsClass="popupControls" width="500" height="140"
                autosized="true" resizeable="false" zindex="2001" domElementAttachment="form">
                <a4j:support event="onhide" reRender="fobIDValues" />
                <f:facet name="header" >
                    <h:outputText value="#{messages.editPerson_clearFobPairing}" />
                </f:facet>
                <f:facet name="controls">
                    <h:graphicImage value="/images/modal_close.png"
                        style="cursor:pointer"
                        onclick="Richfaces.hideModalPanel('clearFobID')" />
                </f:facet>
    
                <div class="popupsubtitle"><h:outputText
                    value="#{messages.editPerson_clearFobPairing}" /></div>
                    
                <h:form id="confirmCloseSummary">
    
                    <a4j:region id="clearFobRegion">
                    <div id="clearFobMessage" style="margin: 15px;"><h:outputText value="#{messages.editPerson_confirmClearFob}" /></div>
                    <div class="popupactions">
                    <button id="confirmClearCancel" type="reset"
                        class="left" onclick="Richfaces.hideModalPanel('clearFobID'); return false;">
                        <span class="cancel"> 
                            <h:outputText value="#{messages.button_cancel}" />
                        </span>
                    </button>
                    <a4j:commandButton action="#{personBean.clearFob}" id="confirmClearOK" 
                        styleClass="left" oncomplete="Richfaces.hideModalPanel('clearFobID');">
                        <span class="ok">
                            <h:outputText value="#{messages.button_ok}" /> 
                        </span>
                    </a4j:commandButton>
                    
                    </div>
                    </a4j:region>
                </h:form>
            </rich:modalPanel>
          <!-- END PANEL -->
        </td>

      </tr>
    </table>
    
    <script type="text/javascript">
  var formElements = ["text", "checkbox", "radio", "select-one", "select-multiple", "textarea"];

  function bodyLoad()
  {
    populateAlertText();

    var elements = document.getElementById("edit-form").elements;
    for (var i = 0; i &lt; elements.length; i++)
      for (var j = 0; j &lt; formElements.length; j++)
        if (elements[i].getAttribute("type") == formElements[j])
        {
          elements[i].focus();
          return;
        }
  }

  function populateAlertText(id)
  {
    if (#{personBean.batchEdit})
      return;

    if (id == null)
    {
      populateAlertText("edit-form:editPerson-info");
      populateAlertText("edit-form:editPerson-warn");
      populateAlertText("edit-form:editPerson-crit");
    }
    else
    {
      var select = document.getElementById(id);
      populateAlertOption(select.options[1], "edit-form:editPerson-priEmail");
      populateAlertOption(select.options[2], "edit-form:editPerson-secEmail");
      populateAlertOption(select.options[3], "edit-form:editPerson-priPhone");
      populateAlertOption(select.options[4], "edit-form:editPerson-secPhone");
      populateAlertOption(select.options[5], "edit-form:editPerson-priText");
      populateAlertOption(select.options[6], "edit-form:editPerson-secText");
    }
  }

  function populateAlertOption(option, inputId)
  {//alert("populateAlertOption("+option+", "+inputId+")");
    var value = document.getElementById(inputId).value;
    if ((value != null) &amp;&amp; (value != ""))
      value = "#{messages.myAccount_alertTextSeparator}" + value;
    var index = option.text.indexOf("#{messages.myAccount_alertTextSeparator}");
    if (index != -1)
      option.text = option.text.substring(0, index) + value;
    else
      option.text = option.text + value;
  }
  
  function showSection(id, show)
  {
    document.getElementById(id).style.display = show ? "" : "none";
  }


    if(document.getElementById("edit-form:editPerson-isUser"))
    	showSection("userInfoPanel", document.getElementById("edit-form:editPerson-isUser").checked);
	
/*
    if(document.getElementById("edit-form:editPerson-isDriver")){
        showSection("driverTable", document.getElementById("edit-form:editPerson-isDriver").checked);
    	showSection("rfidSection", document.getElementById("edit-form:editPerson-isDriver").checked);
    	showSection("cellProviderSection", document.getElementById("edit-form:editPerson-isDriver").checked);
    	showSection('edit-form:editPerson-cellProviderData', document.getElementById('edit-form:editPerson-isProviderSelected').checked);    }
  
 */
     </script>


  </ui:define>

</ui:composition>
