<ui:composition template="/layout/layout.xhtml" 
              xmlns="http://www.w3.org/1999/xhtml" 
              xmlns:ui="http://java.sun.com/jsf/facelets"
              xmlns:h="http://java.sun.com/jsf/html"
              xmlns:rich="http://richfaces.org/rich"
              xmlns:a4j="http://richfaces.org/a4j"
              xmlns:f="http://java.sun.com/jsf/core"
              xmlns:c="http://java.sun.com/jstl/core"
              xmlns:security="http://pro.tiwi.com/jsf/security"
              xmlns:tiwiprofn="http://pro.tiwi.com/jsffunctions">

  <ui:param name="adminSelected" value="current" />
  <ui:param name="helpFile" value="Admin_Add_Profile.htm" />
  <ui:param name="title" value="#{redFlagAlertsBean.add ? messages.adminHeader_addRedFlag : (redFlagAlertsBean.batchEdit ? messages.adminHeader_editRedFlags : messages.adminHeader_editRedFlag)}"/>
  
  <ui:define name="scripts">
      <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/adminEdit.js"></script>
  </ui:define>
  
  <ui:define name="content">

    <table width="920" border="0" cellspacing="0" cellpadding="0" align="center" style="margin: 0 auto 0 auto;">
      <tr>
        <td valign="top" width="130">
          <ui:include src="/includes/navigation/adminSideNav.xhtml">
            <ui:param name="selectedAction" value="#{(redFlagAlertsBean.add) ? 'go_adminAddRedFlag' : 'go_adminRedFlags'}" />
            <ui:param name="parentAction" value="go_adminRedFlags" />
            <ui:param name="context" value="editRedFlag"/>
          </ui:include>
        </td>
        <td valign="top">
          <!-- START PANEL -->

          <a4j:form id="edit-form">

            <div class="">
              <div class="panel_nw">
                <div class="panel_title">
                  <span class="admin"><h:outputText value="#{redFlagAlertsBean.add ? messages.adminHeader_addRedFlag : (redFlagAlertsBean.batchEdit ? messages.adminHeader_editRedFlags : messages.adminHeader_editRedFlag)}" /></span>
                  <span class="panel_links"></span>
                </div>
              </div>

              <div class="panel_w">

                <div class="panel_content">

                  <ul id="grid_nav" style="margin: 0;">
                    <li class="r">
                      <h:commandButton id="editRedFlagSave1" action="#{redFlagAlertsBean.save}" styleClass="left"><span class="save"><h:outputText value="#{messages.button_save}" /></span></h:commandButton>
                      <h:outputText value=" " /><h:commandButton id="editRedFlagCancel1" action="#{redFlagAlertsBean.cancelEdit}" immediate="true" styleClass="left"><span class="cancel"><h:outputText value="#{messages.button_cancel}" /></span></h:commandButton>
                    </li>
                  </ul>
                   <div class="msg">
                  <p id="info">
                     <h:outputText  id="editMessage1" value="#{messages.editRedFlag_message}"/>
                  </p>
               </div>
                   <ui:fragment rendered="${tiwiprofn:messagesAvailable()}">
                     <dl id="display-form:j_id122" class="rich-messages msg" style="">
                        <dt class="error">
                           <h:outputFormat value="#{messages.error_validationMsg}">
                              <f:param value="${tiwiprofn:getMessageCount()}"/>
                           </h:outputFormat>
                        </dt>
                     </dl>
                   </ui:fragment>
                  <rich:messages globalOnly="true" errorClass="error" fatalClass="error" warnClass="warning" infoClass="info" styleClass="msg" />

                  <table width="790" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td width="390" valign="top">
                
                        <div class="add_section_title"><h:outputText value="#{messages.editRedFlag_nameDescriptionType}" /></div>

                        <table width="370" border="0" cellspacing="2" cellpadding="4" align="center">
                          <tr>
                            <td width="105" valign="top">
                              <ui:include src="../../includes/admin/inputLabel.xhtml">
                                 <ui:param name="required" value="TRUE"/>
                                 <ui:param name="for" value="name"/>
                                 <ui:param name="fieldName" value="name"/>
                                 <ui:param name="editBean" value="#{redFlagAlertsBean}"/>
                                 <ui:param name="label" value="#{messages.editAlerts_name}"/>
        					<ui:param name="context" value="editRedFlagName" />
                              </ui:include>
                            </td>
                            <td>
                              <rich:message for="editRedFlag-name" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                              <h:inputText value="#{redFlagAlertsBean.item.name}" id="editRedFlag-name" onchange="checkMultiple(this)" styleClass="text" size="30"
                                maxlength="30" />
                            </td>
                          </tr>
                          <tr>
                            <td width="105" valign="top">
                              <h:selectBooleanCheckbox rendered="#{redFlagAlertsBean.batchEdit}" id="update_editRedFlag-description" value="#{redFlagAlertsBean.updateField['description']}" />
                              <h:outputText value="#{messages.editAlerts_description}" />
                            </td>
                            <td>
                              <h:inputText value="#{redFlagAlertsBean.item.description}" id="description" onchange="checkMultiple(this)" styleClass="text" size="30"
                                maxlength="64" />
                            </td>
                          </tr>
                          <tr>
                            <td width="105" valign="top">
                              <ui:include src="../../includes/admin/inputLabel.xhtml">
                                 <ui:param name="required" value="TRUE"/>
                                 <ui:param name="for" value="dayOfWeek"/>
                                 <ui:param name="fieldName" value="dayOfWeek"/>
                                 <ui:param name="editBean" value="#{redFlagAlertsBean}"/>
                                 <ui:param name="label" value="#{messages.editAlerts_dayOfWeek}"/>
        						<ui:param name="context" value="editRedFlagDayOfWeek" />
                              </ui:include>
                            </td>
                            <td>
                              <rich:message for="editRedFlag-day0" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                              <ui:include src="../../includes/dayPicker.xhtml">
                                <ui:param name="days" value="#{redFlagAlertsBean.item.dayOfWeek}" />
                                <ui:param name="onchange" value="checkMultiple('dayOfWeek')" />
        						<ui:param name="context" value="editRedFlag" />
        						<ui:param name="formName" value="edit-form"/>
                              </ui:include>
                            </td>
                          </tr>
                          <tr>
                            <td width="105" valign="top">
                               <ui:include src="../../includes/admin/inputLabel.xhtml">
                                 <ui:param name="required" value="TRUE"/>
                                 <ui:param name="for" value="timeframe"/>
                                 <ui:param name="fieldName" value="anytime"/>
                                 <ui:param name="editBean" value="#{redFlagAlertsBean}"/>
                                 <ui:param name="label" value="#{messages.editAlerts_timeframe}"/>
        							<ui:param name="context" value="editRedFlagAnyTime" />
 	                             </ui:include>
                            </td>
                            <td>
                              <rich:message for="editRedFlag-stopTOD" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                              <h:selectOneRadio id="editRedFlag-timeframe" onchange="checkMultiple('timeframe')" value="#{redFlagAlertsBean.item.anytime}" onclick="document.getElementById('editRedFlag-timeframePickers').style.display = (this.value == 'true' ? 'none' : '')" enabledClass="radioitem">
                                <f:selectItem itemValue="true" itemLabel="#{messages.editAlerts_timeframeAnytime}" />
                                <f:selectItem itemValue="false" itemLabel="#{messages.editAlerts_timeframeBetween}" />
                              </h:selectOneRadio>
                              <table id="editRedFlag-timeframePickers" border="0" style="#{redFlagAlertsBean.item.anytime ? 'display:none' : ''}">
                                <tr>
                                  <td>
                                    <ui:include src="../../includes/timePicker.xhtml">
                                      <ui:param name="id" value="startTOD" />
                                      <ui:param name="value" value="#{redFlagAlertsBean.item.startTOD}" />
                                      <ui:param name="onchange" value="checkMultiple('timeframe')" />
        							<ui:param name="context" value="editRedFlag" />
         								<ui:param name="formName" value="edit-form"/>
                                    </ui:include>
                                  </td>
                                  <td><h:outputText value="#{messages.editAlerts_betweenAnd}" /></td>
                                  <td>
                                    <ui:include src="../../includes/timePicker.xhtml">
                                      <ui:param name="id" value="stopTOD" />
                                      <ui:param name="value" value="#{redFlagAlertsBean.item.stopTOD}" />
                                      <ui:param name="onchange" value="checkMultiple('timeframe')" />
       								  <ui:param name="context" value="editRedFlag" />
        								<ui:param name="formName" value="edit-form"/>
                                     </ui:include>
                                  </td>
                                </tr>
                              </table>
                            </td>
                          </tr>
                        </table>

                      </td>
                      <td width="10"><h:graphicImage value="/images/x.gif" width="10" /></td>
                      <td width="390" valign="top">

                        <div class="add_section_title">
                          <ui:include src="../../includes/admin/inputLabel.xhtml">
                              <ui:param name="required" value="TRUE"/>
                              <ui:param name="for" value="assignTo"/>
                              <ui:param name="fieldName" value="assignTo"/>
                              <ui:param name="editBean" value="#{redFlagAlertsBean}"/>
                              <ui:param name="label" value="#{messages.editAlerts_assignTo}"/>
         					<ui:param name="context" value="editRedFlagAssignTo" />
                          </ui:include>
                        </div>

                        <rich:message for="editRedFlag-from" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />

                        <ui:include src="../../includes/admin/alertAssign.xhtml">
                         	<ui:param name="alertsBean" value="#{redFlagAlertsBean}" />
                          	<ui:param name="onchange" value="checkMultiple('assignTo')" />
          					<ui:param name="context" value="editRedFlag" />
         				  	<ui:param name="formName" value="edit-form"/>
                        </ui:include>

                      </td>
                    </tr>
                  </table>

                  <div class="spacer"></div>

                  <div class="add_section_title">
                  <ui:include src="../../includes/admin/inputLabel.xhtml">
                     <ui:param name="required" value="false"/>
                     <ui:param name="for" value="type"/>
                     <ui:param name="fieldName" value="type"/>
                     <ui:param name="editBean" value="#{redFlagAlertsBean}"/>
                     <ui:param name="label" value="#{messages.editRedFlag_redFlagType}"/>
        			<ui:param name="context" value="editRedFlagType" />
                  </ui:include>
                  </div>

                  <div class="spacer"></div>

                  <table width="790" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td width="130" valign="top">
                        <h:selectOneRadio id="type" value="#{redFlagAlertsBean.item.type}" layout="pageDirection" style="width:100%" styleClass="left_tab_table" enabledClass="radioitem"
                           onchange="checkMultiple('type')">
                          <a4j:support event="onclick" reRender="editRedFlagType" limitToList="true" />
                          <f:selectItem itemValue="speed" itemLabel="#{messages.redFlag_speed}" />
                          <f:selectItem itemValue="drivingStyle" itemLabel="#{messages.redFlag_drivingStyle}" />
                          <f:selectItem itemValue="seatBelt" itemLabel="#{messages.redFlag_seatBelt}" />
                          <f:selectItem itemValue="crash" itemLabel="#{messages.redFlag_crash}" />
                          <f:selectItem itemValue="tampering" itemLabel="#{messages.redFlag_tampering}" />
                          <f:selectItem itemValue="lowBattery" itemLabel="#{messages.redFlag_lowBattery}" />
                        </h:selectOneRadio>
                      </td>
                      <td width="10"><h:graphicImage value="/images/x.gif" width="10" /></td>
                      <td width="650" valign="top">
                        <rich:message id="message" for="editRedFlagType" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
						<a4j:outputPanel id="editRedFlagType">
                        <a4j:outputPanel id="editRedFlag-speed">
                          <h:panelGroup rendered="#{redFlagAlertsBean.item.type == 'speed'}" id="speedPanel">

                            <table width="100%" border="0" cellpadding="2" cellspacing="0">
                              <tr class="datagrid">
                                <th><h:outputText value="#{messages.editRedFlag_speedHeader}" /></th>
                                <th width="300" colspan="2"><h:outputText value="#{messages.editRedFlag_speedSettingHeader}" /></th>
                                <th width="100"><h:outputText value="#{messages.editRedFlag_notification}" /></th>
                              </tr>
                              <c:forEach begin="0" var="index" end="14">
                                <c:set var="id" value="speed#{index}" />
                                <c:set var="minimum" value="#{(index lt 4) ? ((-index * 5) - 5) : -25}" />
                                <tr class="#{((index % 2) == 0) ? 'tableOdd' : 'tableEven'}">
                                  <td style="padding: 6px 12px 6px 12px; border-bottom: 1px solid #8BAD37;">
                                    <h:selectBooleanCheckbox id="#{id}Selected" value="#{redFlagAlertsBean.item.speedSelected[index]}" onchange="checkMultiple('type')" />
                                    <h:outputText value="#{(index * 5) + 5}" converter="MphToKphLabelConverter"/>
                                    <h:outputText value=" " />
                                    <h:outputText value="mph" converter="MeasurementTextConverter"/>
                                  </td>
                                  <td style="padding: 6px 0px 6px 12px; border-bottom: 1px solid #8BAD37;" width="250">
                                    <rich:inputNumberSlider id="#{id}" value="#{redFlagAlertsBean.item.speedSettings[index]}" 
                                          width="250" onfocus="this.select();" showToolTip="false" 
                                          showBoundaryValues="false" minValue="${tiwiprofn:convertMphToKph(minimum)}" maxValue="${tiwiprofn:convertMphToKph(25)}" step="1" 
                                          converter="MphToKphConverter"
                                          convertonchange="checkMultiple('type'); document.getElementById(this.mainTable.id + 'Selected').checked = true;" />
                                  </td>
                                  <td style="padding: 6px 12px 6px 2px; border-bottom: 1px solid #8BAD37;">
                                     <h:outputText value=" " />
                                     <h:outputText value="mph" converter="MeasurementTextConverter"/>
                                  </td>
                                  <td style="padding: 6px 12px 6px 12px; border-bottom: 1px solid #8BAD37;">
                                    <h:selectOneMenu id="#{id}Severity" value="#{redFlagAlertsBean.item.speedLevels[index]}" onchange="var id = this.id.substring(0, this.id.length - 8); checkMultiple('type'); document.getElementById(id + 'Selected').checked = true;">
                                      <f:selectItem itemValue="INFO" itemLabel="#{messages.redFlag_info}" />
                                      <f:selectItem itemValue="WARNING" itemLabel="#{messages.redFlag_warning}" />
                                      <f:selectItem itemValue="CRITICAL" itemLabel="#{messages.redFlag_critical}" />
                                    </h:selectOneMenu>
                                  </td>
                                </tr>
                              </c:forEach>
                              <tr class="tableEven">
                                <ui:fragment rendered="#{redFlagAlertsBean.batchEdit}">
                                  <td style="border-bottom: 1px solid #8BAD37"></td>
                                </ui:fragment>
                                <td colspan="2" align="right" style="border-bottom: 1px solid #8BAD37">
                                  <h:outputText value="#{messages.editDevice_speedAdjustAll}" />
                                  <a href="#" onclick="bumpSpeeds(true); return false;"><h:graphicImage value="/images/btn_plus.png" style="border: 0px; vertical-align: middle;" /></a>
                                  <a href="#" onclick="bumpSpeeds(false); return false;"><h:graphicImage value="/images/btn_minus.png" style="border: 0px; vertical-align: middle;" /></a>
                                </td>
                                <td colspan="2" style="border-bottom: 1px solid #8BAD37"></td>
                              </tr>
                            </table>
                            <script type="text/javascript">
                              function bumpSpeeds(up)
                              {
                                for (var i = 0; i &lt; 15; i++)
                                  if (document.getElementById("edit-form:speed" + i + "Selected").checked)
                                  {
                                    var input = document.getElementById("edit-form:speed" + i).component;
                                    if (up)
                                      input.setValue(Number(input.input.value) + 1);
                                    else
                                      input.setValue(Number(input.input.value) - 1);
                                  }
                              }
                            </script>

                          </h:panelGroup>
                        </a4j:outputPanel>

                        <a4j:outputPanel id="drivingStyle">
                          <h:panelGroup rendered="#{redFlagAlertsBean.item.type == 'drivingStyle'}">

                            <script type="text/javascript">
                              var sensitivities = new Array();
                              <c:forEach begin="1" var="sensitivity" end="5">
                                <c:set var="sLevel" value="editRedFlag_severity#{sensitivity}" />
                                sensitivities[#{sensitivity}] = '<h:outputText value="#{messages[sLevel]}" />';
                              </c:forEach>
                            </script>

                            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                              <tr class="datagrid">
                                <th><h:outputText value="#{messages.editRedFlag_setting}" /></th>
                                <th width="300" colspan="2"><h:outputText value="#{messages.editRedFlag_severity}" /></th>
                                <th width="100"><h:outputText value="#{messages.editRedFlag_notification}" /></th>
                              </tr>
                              <c:forEach begin="1" var="index" end="4">
                                <c:set var="sensitivityItem" value="#{(index == 1) ? 'hardAcceleration' : ((index == 2) ? 'hardBrake' : ((index == 3) ? 'hardTurn' : 'hardVertical'))}" />
                                <tr class="#{((index % 2) == 0) ? 'tableOdd' : 'tableEven'}">
                                  <td style="padding: 0px 12px 6px 12px; border-bottom: 1px solid #8BAD37;">
                                    <c:set var="sensitivitySelected" value="#{sensitivityItem}Selected" />
                                    <h:selectBooleanCheckbox id="#{sensitivityItem}Selected" value="#{redFlagAlertsBean.item[sensitivitySelected]}" onchange="checkMultiple('type')" />
                                    <c:set var="sensitivityLabel" value="editDevice_#{sensitivityItem}" />
                                    <h:outputText value="#{messages[sensitivityLabel]}" />
                                  </td>
                                  <td style="padding: 0px 12px 6px 12px; border-bottom: 1px solid #8BAD37;" width="120">
                                    <style>
                                       .dr-insldr-track-decor-1{
                                          border: none;
                                       }
                                       
                                       .dr-insldr-track-decor-2{
                                          border: none;
                                       }

                                    </style>
                                    <rich:inputNumberSlider id="#{sensitivityItem}" 
                                             value="#{redFlagAlertsBean.item[sensitivityItem]}" showToolTip="false" 
                                             showBoundaryValues="false" showInput="false" minValue="1" maxValue="5" 
                                             handleClass="severity-slider-handle"
                                             width="105px"
         
                                             onchange="checkMultiple('type'); document.getElementById(this.mainTable.id + 'Selected').checked = true; document.getElementById(this.mainTable.id + 'Level').innerHTML = sensitivities[this.value]" 
                                             barClass="#{((index % 2) == 0) ? 'severity-table-odd' : 'severity-table-even'} severity-slider-bar"/>
                                  </td>
                                  <td style="padding: 0px 12px 6px 0px; border-bottom: 1px solid #8BAD37; width:180">
                                    <c:set var="sensitivityLevel" value="editRedFlag_severity#{redFlagAlertsBean.item[sensitivityItem]}" />
                                    <h:outputText id="#{sensitivityItem}Level" style="font-weight:bold" value="#{messages[sensitivityLevel]}" />
                                  </td>
                                  <td style="padding: 6px 12px 6px 12px; border-bottom: 1px solid #8BAD37;">
                                    <c:set var="sensitivityLevel" value="#{sensitivityItem}Level" />
                                    <h:selectOneMenu id="#{sensitivityItem}Severity" value="#{redFlagAlertsBean.item[sensitivityLevel]}" onchange="var id = this.id.substring(0, this.id.length - 8); checkMultiple('type'); document.getElementById(id + 'Selected').checked = true;">
                                      <f:selectItem itemValue="INFO" itemLabel="#{messages.redFlag_info}" />
                                      <f:selectItem itemValue="WARNING" itemLabel="#{messages.redFlag_warning}" />
                                      <f:selectItem itemValue="CRITICAL" itemLabel="#{messages.redFlag_critical}" />
                                    </h:selectOneMenu>
                                  </td>
                                </tr>
                              </c:forEach>
                            </table>

                          </h:panelGroup>
                        </a4j:outputPanel>

                        <a4j:outputPanel id="editRedFlag-safety">
                          <h:panelGroup rendered="#{redFlagAlertsBean.item.type == 'seatBelt'}">

                            <table width="100%" border="0" cellpadding="2" cellspacing="0" class="datagrid">
                              <tr>
                                <th><h:outputText value="#{messages.editRedFlag_setting}" /></th>
                                <th width="100"><h:outputText value="#{messages.editRedFlag_notification}" /></th>
                              </tr>
                              <tr class="tableEven">
                                <td>
                                  <h:outputText value="#{messages.editRedFlag_seatBelt}" />
                                </td>
                                <td>
                                  <h:selectOneMenu id="seatBeltLevelSeverity" value="#{redFlagAlertsBean.item.seatBeltLevel}" onchange="checkMultiple('type')">
                                    <f:selectItem itemValue="INFO" itemLabel="#{messages.redFlag_info}" />
                                    <f:selectItem itemValue="WARNING" itemLabel="#{messages.redFlag_warning}" />
                                    <f:selectItem itemValue="CRITICAL" itemLabel="#{messages.redFlag_critical}" />
                                  </h:selectOneMenu>
                                </td>
                              </tr>
                            </table>

                          </h:panelGroup>
                        </a4j:outputPanel>
                        
                       <rich:message for="crash" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                        <a4j:outputPanel id="crash">
                          <h:panelGroup rendered="#{redFlagAlertsBean.item.type == 'crash'}">

                            <table width="100%" border="0" cellpadding="2" cellspacing="0" class="datagrid">
                              <tr>
                                <th><h:outputText value="#{messages.editRedFlag_setting}" /></th>
                                <th width="100"><h:outputText value="#{messages.editRedFlag_notification}" /></th>
                              </tr>
                              <tr class="tableEven">
                                <td>
                                  <h:outputText value="#{messages.editRedFlag_crash}" />
                                </td>
                                <td>
                                  <h:selectOneMenu id="crashLevelSeverity" value="#{redFlagAlertsBean.item.crashLevel}" onchange="checkMultiple('type')">
                                    <f:selectItem itemValue="INFO" itemLabel="#{messages.redFlag_info}" />
                                    <f:selectItem itemValue="WARNING" itemLabel="#{messages.redFlag_warning}" />
                                    <f:selectItem itemValue="CRITICAL" itemLabel="#{messages.redFlag_critical}" />
                                  </h:selectOneMenu>
                                </td>
                              </tr>
                            </table>

                          </h:panelGroup>
                        </a4j:outputPanel>
                        
                       <rich:message for="tampering" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                        <a4j:outputPanel id="tampering">
                          <h:panelGroup rendered="#{redFlagAlertsBean.item.type == 'tampering'}">

                            <table width="100%" border="0" cellpadding="2" cellspacing="0" class="datagrid">
                              <tr>
                                <th><h:outputText value="#{messages.editRedFlag_setting}" /></th>
                                <th width="100"><h:outputText value="#{messages.editRedFlag_notification}" /></th>
                              </tr>
                              <tr class="tableEven">
                                <td>
                                  <h:outputText value="#{messages.editRedFlag_tampering}" />
                                </td>
                                <td>
                                  <h:selectOneMenu id="tamperingLevelSeverity" value="#{redFlagAlertsBean.item.tamperingLevel}" onchange="checkMultiple('type')">
                                    <f:selectItem itemValue="INFO" itemLabel="#{messages.redFlag_info}" />
                                    <f:selectItem itemValue="WARNING" itemLabel="#{messages.redFlag_warning}" />
                                    <f:selectItem itemValue="CRITICAL" itemLabel="#{messages.redFlag_critical}" />
                                  </h:selectOneMenu>
                                </td>
                              </tr>
                            </table>

                          </h:panelGroup>
                        </a4j:outputPanel>
                        
                       <rich:message for="lowBattery" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                        <a4j:outputPanel id="lowBattery">
                          <h:panelGroup rendered="#{redFlagAlertsBean.item.type == 'lowBattery'}">

                            <table width="100%" border="0" cellpadding="2" cellspacing="0" class="datagrid">
                              <tr>
                                <th><h:outputText value="#{messages.editRedFlag_setting}" /></th>
                                <th width="100"><h:outputText value="#{messages.editRedFlag_notification}" /></th>
                              </tr>
                              <tr class="tableEven">
                                <td>
                                  <h:outputText value="#{messages.editRedFlag_lowBattery}" />
                                </td>
                                <td>
                                  <h:selectOneMenu id="lowBatteryLevelSeverity" value="#{redFlagAlertsBean.item.lowBatteryLevel}" onchange="checkMultiple('type')">
                                    <f:selectItem itemValue="INFO" itemLabel="#{messages.redFlag_info}" />
                                    <f:selectItem itemValue="WARNING" itemLabel="#{messages.redFlag_warning}" />
                                    <f:selectItem itemValue="CRITICAL" itemLabel="#{messages.redFlag_critical}" />
                                  </h:selectOneMenu>
                                </td>
                              </tr>
                            </table>

                          </h:panelGroup>
                        </a4j:outputPanel>
						</a4j:outputPanel>
                      </td>
                    </tr>
                  </table>

                  <div class="spacer"></div>

                  <rich:message for="editRedFlag-emailToString" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />

                  <table width="790" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td width="390" valign="top">

                        <div class="add_section_title">
                          <h:selectBooleanCheckbox rendered="#{redFlagAlertsBean.batchEdit}" id="update_editRedFlag-notifyPersonIDs" value="#{redFlagAlertsBean.updateField['notifyPersonIDs']}" />
                          <h:outputText value="#{messages.editAlerts_notificationsByName}" />
                        </div>

                        <div class="instructions"><h:outputText value="#{messages.editAlerts_notificationsByNameInstructions}" /></div>

                        <ui:include src="../../includes/autocompletePicker.xhtml">
                          <ui:param name="autocompleter" value="#{redFlagAlertsBean.peoplePicker}" />
                          <ui:param name="onchange" value="checkMultiple('notifyPersonIDs')" />
 						  <ui:param name="context" value="editRedFlag"/>
 						  <ui:param name="formName" value="edit-form"/>
                        </ui:include>

                      </td>
                       
                      <td width="10"><h:graphicImage value="/images/x.gif" width="10" /></td>
                      <td width="390" valign="top">
                        <!-- 
                        <div class="add_section_title">
                          <h:selectBooleanCheckbox rendered="#{redFlagAlertsBean.batchEdit}" id="update_emailToString" value="#{redFlagAlertsBean.updateField['emailToString']}" />
                          <h:outputText value="#{messages.editAlerts_notificationsByEmail}" />
                        </div>

                        <div class="instructions"><h:outputText value="#{messages.editAlerts_notificationsByEmailInstructions}" /></div>

                        <h:inputTextarea id="emailToString" value="#{redFlagAlertsBean.item.emailToString}" rows="4" style="width:100%" onchange="checkMultiple(this)" />
                        -->
                      </td>
                      
                    </tr>
                  </table>

                  <div class="required-key"><h:outputText value="#{messages.requiredKey}" /></div>

                  <div class="spacer"></div>

                  <ul id="grid_nav" style="margin: 0;">
                    <li class="r">
                      <h:commandButton id="editRedFlagSave2" action="#{redFlagAlertsBean.save}" styleClass="left"><span class="save"><h:outputText value="#{messages.button_save}" /></span></h:commandButton>
                      <h:outputText value=" " /><h:commandButton id="editRedFlagCancel2" action="#{redFlagAlertsBean.cancelEdit}" immediate="true" styleClass="left"><span class="cancel"><h:outputText value="#{messages.button_cancel}" /></span></h:commandButton>
                    </li>
                  </ul>

                </div>
              </div>

              <div class="panel_sw">
                <div class="panel_statusbar"></div>
              </div>
            </div>

          </a4j:form>

          <!-- END PANEL -->
        </td>
      </tr>
    </table>
    
    <script type="text/javascript">
      var formElements = ["text", "checkbox", "radio", "select-one", "select-multiple", "textarea"];

      function bodyLoad()
      {
        document.getElementById("editRedFlag-timeframePickers").style.display = (document.getElementById("edit-form:editRedFlag-timeframe:0").checked ? 'none' : '');

        var elements = document.getElementById("edit-form").elements;
        for (var i = 0; i &lt; elements.length; i++)
          for (var j = 0; j &lt; formElements.length; j++)
            if (elements[i].getAttribute("type") == formElements[j])
            {
              elements[i].focus();
              return;
            }
      }
    </script>

  </ui:define>

</ui:composition>
