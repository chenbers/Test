<ui:composition template="/layout/layout.xhtml" 
              xmlns="http://www.w3.org/1999/xhtml" 
              xmlns:ui="http://java.sun.com/jsf/facelets"
              xmlns:h="http://java.sun.com/jsf/html"
              xmlns:rich="http://richfaces.org/rich"
              xmlns:a4j="http://richfaces.org/a4j"
              xmlns:f="http://java.sun.com/jsf/core"
              xmlns:security="http://pro.tiwi.com/jsf/security">

  <ui:param name="adminSelected" value="current" />

  <ui:define name="content">

    <table width="920" border="0" cellspacing="0" cellpadding="0" align="center" style="margin: 0 auto 0 auto;">
      <tr>
      <td valign="top" width="130">
        <ui:include src="/includes/adminSideNav.xhtml">
          <ui:param name="selectedAction" value="#{(devicesBean.add) ? 'go_adminAddDevice' : 'go_adminDevices'}" />
          <ui:param name="parentAction" value="go_adminDevices" />
        </ui:include>
      </td>
      <td valign="top">
          <!-- START PANEL -->

        <a4j:form id="edit-form">

          <div class="">
            <div class="panel_nw">
              <div class="panel_title">
                <span class="admin"><h:outputText value="#{devicesBean.add ? messages.adminHeader_addDevice : (devicesBean.batchEdit ? messages.adminHeader_editDevices : messages.adminHeader_editDevice)}" /></span>
                <span class="panel_links"></span>
              </div>
            </div>
            <div class="panel_w">
              <div class="panel_content">

                <ul id="grid_nav" style="margin: 0;">
                  <li class="r"><h:commandLink action="#{devicesBean.cancelEdit}" immediate="true"><button value="submit" class="left"><span class="cancel"><h:outputText value="#{messages.button_cancel}" /></span></button></h:commandLink></li>
                  <li class="r"><h:commandLink action="#{devicesBean.save}"><button value="submit" class="left"><span class="save"><h:outputText value="#{messages.button_save}" /></span></button></h:commandLink></li>
                </ul>

                <rich:messages globalOnly="true" errorClass="error" fatalClass="error" warnClass="warning" infoClass="info" styleClass="msg" />

                <div class="spacer"></div>

                <table width="790" border="0" cellspacing="0" cellpadding="0">
                  <tr>
                    <td width="390" valign="top">

                      <div class="add_section_title"><h:outputText value="#{messages.editDevice_deviceInformation}" /></div>

                      <table width="370" border="0" cellspacing="2" cellpadding="4" align="center">
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{devicesBean.batchEdit}" id="update_year" value="#{devicesBean.updateField['year']}" />
                            <h:outputText value="#{messages.editDevice_year}" />
                          </td>
                          <td>
                            <h:selectOneMenu value="#{devicesBean.editItem.year}" id="year" onchange="checkMultiple(this)">
                              <f:selectItems value="#{devicesBean.years}" />
                            </h:selectOneMenu>
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{devicesBean.batchEdit}" id="update_make" value="#{devicesBean.updateField['make']}" />
                            <h:outputText value="#{messages.editDevice_make}" />
                          </td>
                          <td>
                            <h:inputText value="#{devicesBean.editItem.make}" id="make" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="22" required="#{(not devicesBean.batchEdit) or devicesBean.updateField['make']}" requiredMessage="#{messages.required}" />
                            <rich:message for="make" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{devicesBean.batchEdit}" id="update_model" value="#{devicesBean.updateField['model']}" />
                            <h:outputText value="#{messages.editDevice_model}" />
                          </td>
                          <td>
                            <h:inputText value="#{devicesBean.editItem.model}" id="model" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="22" required="#{(not devicesBean.batchEdit) or devicesBean.updateField['model']}" requiredMessage="#{messages.required}" />
                            <rich:message for="model" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{devicesBean.batchEdit}" id="update_color" value="#{devicesBean.updateField['color']}" />
                            <h:outputText value="#{messages.editDevice_color}" />
                          </td>
                          <td>
                            <h:inputText value="#{devicesBean.editItem.color}" id="color" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="14" required="#{(not devicesBean.batchEdit) or devicesBean.updateField['color']}" requiredMessage="#{messages.required}" />
                            <rich:message for="color" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{devicesBean.batchEdit}" id="update_type" value="#{devicesBean.updateField['type']}" />
                            <h:outputText value="#{messages.editDevice_type}" />
                          </td>
                          <td>
                            <h:selectOneMenu value="#{devicesBean.editItem.type}" id="type" onchange="checkMultiple(this)">
                              <f:selectItems value="#{devicesBean.types}" />
                            </h:selectOneMenu>
                          </td>
                        </tr>
                        <ui:fragment rendered="#{not devicesBean.batchEdit}">
                        <tr>
                          <td width="100" valign="top"><h:outputText value="#{messages.editDevice_VIN}" /></td>
                          <td>
                            <h:inputText value="#{devicesBean.editItem.VIN}" id="VIN" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="14" required="true" requiredMessage="#{messages.required}" validatorMessage="#{messages.editDevice_VINlength}">
                                <f:validateLength minimum="17" maximum="17" />
                            </h:inputText>
                            <rich:message for="VIN" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                          </td>
                        </tr>
                        </ui:fragment>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{devicesBean.batchEdit}" id="update_weight" value="#{devicesBean.updateField['weight']}" />
                            <h:outputText value="#{messages.editDevice_weight}" />
                          </td>
                          <td>
                            <h:inputText value="#{devicesBean.editItem.weight}" id="weight" onchange="checkMultiple(this)" styleClass="text" size="30"
                              required="#{(not devicesBean.batchEdit) or devicesBean.updateField['weight']}" requiredMessage="#{messages.required}" converterMessage="#{messages.editDevice_weightFormat}" validatorMessage="#{messages.editDevice_weightFormat}">
                              <f:validateLongRange minimum="1" />
                            </h:inputText>
                            <rich:message for="weight" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                          </td>
                        </tr>
                        <ui:fragment rendered="#{not devicesBean.batchEdit}">
                        <tr>
                          <td width="100" valign="top"><h:outputText value="#{messages.editDevice_license}" /></td>
                          <td>
                            <h:inputText value="#{devicesBean.editItem.license}" id="license" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="10" required="true" requiredMessage="#{messages.required}" />
                            <rich:message for="license" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                          </td>
                        </tr>
                        </ui:fragment>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{devicesBean.batchEdit}" id="update_state" value="#{devicesBean.updateField['state']}" />
                            <h:outputText value="#{messages.editDevice_state}" />
                          </td>
                          <td>
                            <h:selectOneMenu value="#{devicesBean.editItem.state}" id="state" onchange="checkMultiple(this)" required="#{(not devicesBean.batchEdit) or devicesBean.updateField['state']}" requiredMessage="#{messages.required}">
                              <f:selectItem itemLabel="#{messages.editDevice_selectState}" />
                              <f:selectItems value="#{devicesBean.states}" />
                            </h:selectOneMenu>
                            <rich:message for="state" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                          </td>
                        </tr>
                      </table>

                    </td>
                    <td width="10"><img src="images/x.gif" width="10" /></td>
                    <td width="390" valign="top">

                    <div class="add_section_title"><h:outputText value="#{messages.editDevice_deviceProfile}" /></div>

                      <table width="370" border="0" cellspacing="2" cellpadding="4" align="center">
                        <ui:fragment rendered="#{not devicesBean.batchEdit}">
                        <tr>
                          <td width="100" valign="top"><h:outputText value="#{messages.editDevice_name}" /></td>
                          <td>
                            <h:inputText value="#{devicesBean.editItem.name}" id="name" onchange="checkMultiple(this)" styleClass="text" size="30"
                              maxlength="30" required="true" requiredMessage="#{messages.required}" />
                            <rich:message for="name" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                          </td>
                        </tr>
                        </ui:fragment>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{devicesBean.batchEdit}" id="update_active" value="#{devicesBean.updateField['active']}" />
                            <h:outputText value="#{messages.editDevice_active}" />
                          </td>
                          <td>
                            <h:selectOneMenu value="#{devicesBean.editItem.active}" id="active" onchange="checkMultiple(this)">
                              <f:selectItem itemValue="true" itemLabel="#{messages.active}" />
                              <f:selectItem itemValue="false" itemLabel="#{messages.inactive}" />
                            </h:selectOneMenu>
                          </td>
                        </tr>
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{devicesBean.batchEdit}" id="update_costPerHour" value="#{devicesBean.updateField['costPerHour']}" />
                            <h:outputText value="#{messages.editDevice_costPerHour}" />
                          </td>
                          <td>
                            $<h:inputText value="#{devicesBean.editItem.costPerHourDollars}" id="costPerHour" onchange="checkMultiple(this)" styleClass="text" size="10"
                              required="#{(not devicesBean.batchEdit) or devicesBean.updateField['costPerHour']}" requiredMessage="#{messages.required}" converter="javax.faces.Double" converterMessage="#{messages.editDevice_costPerHourFormat}" />
                            <rich:message for="costPerHour" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                          </td>
                        </tr>
                      </table>

                      <div class="spacer"></div>

                      <div class="add_section_title"><h:outputText value="#{messages.editDevice_deviceAssignment}" /></div>

                      <table width="370" border="0" cellspacing="2" cellpadding="4" align="center">
                        <tr>
                          <td width="100" valign="top">
                            <h:selectBooleanCheckbox rendered="#{devicesBean.batchEdit}" id="update_groupID" value="#{devicesBean.updateField['groupID']}" />
                            <h:outputText value="#{messages.editDevice_groupID}" />
                          </td>
                          <td>
                            <h:selectOneMenu value="#{devicesBean.editItem.groupID}" id="groupID" onchange="checkMultiple(this)" required="#{(not devicesBean.batchEdit) or devicesBean.updateField['groupID']}" requiredMessage="#{messages.required}">
                              <f:selectItem itemLabel="#{messages.editDevice_selectGroup}" />
                              <f:selectItems value="#{devicesBean.groups}" />
                            </h:selectOneMenu>
                            <rich:message for="groupID" errorClass="field-error" fatalClass="field-error" warnClass="field-warning" infoClass="field-info" styleClass="field-msg" />
                          </td>
                        </tr>
                      </table>

                    </td>
                    </tr>
                  </table>

                  <div class="spacer"></div>

                  <ul id="grid_nav" style="margin: 0;">
                    <li class="r"><h:commandLink action="#{devicesBean.cancelEdit}" immediate="true"><button value="submit" class="left"><span class="cancel"><h:outputText value="#{messages.button_cancel}" /></span></button></h:commandLink></li>
                    <li class="r"><h:commandLink action="#{devicesBean.save}"><button value="submit" class="left"><span class="save"><h:outputText value="#{messages.button_save}" /></span></button></h:commandLink></li>
                  </ul>

                </div>
              </div>

              <div class="panel_sw">
                <div class="panel_statusbar"></div>
              </div>

            </div>
            
          </a4j:form>

          <!-- END PANEL -->
        </td>

      </tr>
    </table>

    <script type="text/javascript">
  function checkMultiple(item)
  {
    var id;
    if (typeof(item) == "string")
      id = item;
    else
      id = item.id;

    var box;
    var index = id.indexOf(":");
    if (index > 0)
      box = document.getElementById("edit-form:update_" + id.substring(index + 1));
    else
      box = document.getElementById("edit-form:update_" + id);
    if (box)
      box.checked = true;
  }
    </script>

  </ui:define>

</ui:composition>
