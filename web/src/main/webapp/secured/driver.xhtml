<ui:composition template="/layout/layout.xhtml" 
				xmlns="http://www.w3.org/1999/xhtml" 
				xmlns:ui="http://java.sun.com/jsf/facelets"
	  			xmlns:h="http://java.sun.com/jsf/html" 
	  			xmlns:rich="http://richfaces.org/rich"
	  			xmlns:a4j="http://richfaces.org/a4j"
	  			xmlns:f="http://java.sun.com/jsf/core"
	  			xmlns:c="http://java.sun.com/jstl/core"
	  			xmlns:t="http://myfaces.apache.org/tomahawk">

	<ui:define name="scripts">
		<script src="#{facesContext.externalContext.request.contextPath}/js/FusionCharts.js" type="text/javascript"></script>	
		<script src="http://maps.google.com/maps?file=api&amp;v=#{gmBean.version}&amp;key=#{gmBean.key}" type="text/javascript"></script>
	  	<script	 type="text/javascript">
	  		var baseIcon = new GIcon();
				baseIcon.iconSize = new GSize(21, 20);
				baseIcon.iconAnchor = new GPoint(6, 20);
				baseIcon.infoWindowAnchor = new GPoint(5, 1);
	
			var bounds = new GLatLngBounds();
	  		var map;
	  		function initMap(lat,lng,zoom){
	  		
 					if (GBrowserIsCompatible())
 	  				{
      					map = new GMap2(document.getElementById("map-canvas"));
      					map.addControl(new GLargeMapControl());
      					map.addControl(new GMapTypeControl());
      					map.addControl(new GOverviewMapControl()); 
						map.setCenter(new GLatLng(lat, lng), zoom);
						map.setMapType(G_NORMAL_MAP);
					}
			}
			
			function drawTrip()
			{
				<h:outputText rendered="#{driverBean.hasLastTrip}">
					var polyline = new GPolyline([
										<ui:repeat value="#{driverBean.lastTrip.route}" var="route">
											new GLatLng(#{route.lat}, #{route.lng}),
									  	</ui:repeat>
									  	//Repeating the last step to finish JS array.
									  	new GLatLng(#{driverBean.lastTrip.routeLastStep.lat}, #{driverBean.lastTrip.routeLastStep.lng})	], "#0000ff", 6);

					map.addOverlay(polyline);

					<ui:repeat value="#{driverBean.lastTrip.route}" var="rt2">
						bounds.extend(new GLatLng(#{rt2.lat}, #{rt2.lng}));
					</ui:repeat>
				
		
					//Start of trip marker
					var startlatlng = new GLatLng(#{driverBean.lastTrip.route[0].lat}, #{driverBean.lastTrip.route[0].lng});
					marker = createMarker(startlatlng, "tripStartBubble", "#{facesContext.externalContext.request.contextPath}/images/ico_start.png");
					map.addOverlay(marker);
					bounds.extend(marker.getPoint());
		
					//End of trip marker
					var endlatlng = new GLatLng(#{driverBean.lastTrip.routeLastStep.lat}, #{driverBean.lastTrip.routeLastStep.lng});
					marker = createMarker(endlatlng, "tripEndBubble", "#{facesContext.externalContext.request.contextPath}/images/ico_end_trip.png");
					map.addOverlay(marker);
					bounds.extend(marker.getPoint());
		
					//Create Violation markers. //IDLE EVENT is the only event with different icon.
					var violation;
					var image;
					<ui:repeat value="#{driverBean.violationEvents}" var="violation">
						violation = new GLatLng(#{violation.latitude}, #{violation.longitude});

						<h:outputText rendered="#{violation.eventType.code eq '13'}" >
							image = "#{facesContext.externalContext.request.contextPath}/images/ico_idle.png";
						</h:outputText>
						<h:outputText rendered="#{violation.eventType.code ne '13'}" >
							image = "#{facesContext.externalContext.request.contextPath}/images/ico_violation.png";
						</h:outputText>
						
						marker = createMarker(violation, "#{violation.noteID}", image);
						map.addOverlay(marker);
						bounds.extend(marker.getPoint());
					</ui:repeat>
		
					//Zoom and Center on trip.
					map.setZoom(map.getBoundsZoomLevel(bounds));
				    map.setCenter(bounds.getCenter());
			    </h:outputText>
			}

		    function createMarker(point, divID, iconImage) 
		        {
		        	var markerIcon;
		        	var marker;

					//Use passed in image.
		        	if(iconImage != null)
		        	{
						markerIcon = new GIcon(baseIcon);
			       	    markerIcon.image = iconImage;
			       	 	markerOptions = { icon:markerIcon };
			       	 	marker = new GMarker(point, markerOptions);
		        	}
		        	//Use default GoogleMap marker image.
		        	else
		        	{
				      	markerIcon = new GIcon();
						marker = new GMarker(point);
		        	}
		       
		       		GEvent.addListener(marker, "click", function() {
							var node = document.getElementById(divID).cloneNode(true);
		          			node.style.display = 'block';
				            marker.openInfoWindow(node);
				 			});

		        	return marker;
		        }

			function bodyUnload()
			{
				GUnload();
			}
			
			function bodyLoad()
			{
				// Init Google map if hasLastTrip is true;
				<h:outputText rendered="#{driverBean.hasLastTrip}">
					initMap(#{driverBean.lastTrip.routeLastStep.lat}, #{driverBean.lastTrip.routeLastStep.lng}, 14);
					drawTrip();
		 		</h:outputText>
			}
		</script>
	</ui:define>

	<ui:param name="homeSelected" value="current" />
	<ui:param name="helpFile" value="Overall_Score_Driver.htm" />
	
	<ui:define name="content">

<!-- BEGIN GOOGLE BUBBLES -->
	<ui:include src="/includes/tripBubble.xhtml">
            <ui:param name="hiddenDivID" value="tripStartBubble" />
            <ui:param name="bubbleTitle" value="#{messages.TRIP_START}" />
            <ui:param name="timeZoneObject" value="#{navigationBean.driver.person.timeZone}" />
            <ui:param name="eventDateTime" value="#{driverBean.lastTrip.trip.startTime}" />
            <ui:param name="eventLocation" value="#{driverBean.lastTrip.startAddress}" />
            <ui:param name="datePattern" value="#{messages.dateTimeFormat}" />
	</ui:include>
	
	<ui:include src="/includes/tripBubble.xhtml">
            <ui:param name="hiddenDivID" value="tripEndBubble" />
            <ui:param name="bubbleTitle" value="#{messages.TRIP_END}" />
            <ui:param name="eventDateTime" value="#{driverBean.lastTrip.trip.endTime}" />
            <ui:param name="eventLocation" value="#{driverBean.lastTrip.endAddress}" />
            <ui:param name="timeZoneObject" value="#{navigationBean.driver.person.timeZone}" />
            <ui:param name="datePattern" value="#{messages.dateTimeFormat}" />
	</ui:include>
	
	<ui:repeat value="#{driverBean.violationEvents}" var="violation">
		<ui:include src="/includes/eventBubble.xhtml">
	            <ui:param name="hiddenDivID" value="#{violation.noteID}" />
	            <ui:param name="eventType" value="#{violation.eventType}" />
	            <ui:param name="eventDateTime" value="#{violation.time}" />
	            <ui:param name="eventLocation" value="#{violation.addressStr}" />
	            <ui:param name="timeZoneObject" value="#{navigationBean.driver.person.timeZone}" />
	            <ui:param name="datePattern" value="#{messages.dateTimeFormat}" />
	            <ui:param name="eventSpeedLimit" value="#{violation.speedLimit}" />
	            <ui:param name="eventAvgSpeed" value="#{violation.avgSpeed}" />
	            <ui:param name="eventTopSpeed" value="#{violation.topSpeed}" />
	            <ui:param name="eventDistance" value="#{violation.distance}" />
	            <ui:param name="eventSpeed" value="#{violation.speed}" />
	            <ui:param name="eventSeverity" value="#{violation.severity}" />
	            <ui:param name="eventLowIdle" value="#{violation.lowIdleDuration}" />
	            <ui:param name="eventHighIdle" value="#{violation.highIdleDuration}" />
		</ui:include>
	</ui:repeat>
<!-- END GOOGLE BUBBLES -->
<div id="wrapper">

<h:form>
	<ul id="grid_nav">
		<li class="l grid_icon"><h:graphicImage value="/images/ico_line.png" /></li>
		<li class="l grid_title"><h:outputText value="#{messages.driverPerformanceName}&#160;" /><h:commandLink action="go_driver" value="#{navigationBean.driver.person.fullName}" /></li>
		<li class="l divider"><h:graphicImage value="/images/grid_nav_divider.png" /></li>
		
		<li class="l">
			<ui:include src="/includes/breadcrumb.xhtml">
				<ui:param name="groupTreeNode" value="#{navigationBean.groupTreeNode}" />
				<ui:param name="lastBreadCrumb" value="true" />
			</ui:include>
		</li>
		<li class="l" style="margin-left: -15px;">
			<ul id="breadcrumb">
				<li class="last"><h:outputText value="#{navigationBean.driver.person.fullNameWithId}" /></li>
			</ul>
		</li>
	</ul>
</h:form>

<table width="940" border="0" cellspacing="0" cellpadding="0" align="center" class="dash_table">
  <tr>
    <td colspan="3" valign="top">
		<!-- START PANEL -->
			<div class="">
				<div class="panel_nw">
					<div class="panel_title">
						<span class="overall">#{messages.driver_overallscore}</span>
						<a4j:region id="dateLinksForm_region">
							<a4j:form id="dateLinksForm">
							<span class="panel_links_ico" style="right: 30px;">
								<a4j:status id="dateLinksStatus" for="dateLinksForm_region">
									<f:facet name="start">
										<h:outputText><img src="#{facesContext.externalContext.request.contextPath}/images/progress2.gif" align="top" />&#160;</h:outputText>
									</f:facet>
								</a4j:status>
								<rich:spacer width="10" />
								<a4j:commandLink title="#{messages.duration_days}" immediate="true"
									styleClass="#{(driverDurationBean.duration eq 'DAYS') ? 'on' : ''}"		
									reRender="dateLinksForm,overall_script,overallScoreBox"
									value="#{messages.duration_days}">
									<a4j:actionparam name="duration" assignTo="#{driverDurationBean.duration}"	value="DAYS" />
								</a4j:commandLink>
								<rich:spacer width="5"></rich:spacer>
								<a4j:commandLink title="#{messages.duration_three}" immediate="true"
									styleClass="#{(driverDurationBean.duration eq 'THREE') ? 'on' : ''}"	
									reRender="dateLinksForm,overall_script,overallScoreBox"
									value="#{messages.duration_three}">
									<a4j:actionparam name="duration" assignTo="#{driverDurationBean.duration}" value="THREE" />
								</a4j:commandLink>
								<rich:spacer width="5"></rich:spacer>
								<a4j:commandLink title="#{messages.duration_six}" immediate="true"
									styleClass="#{(driverDurationBean.duration eq 'SIX') ? 'on' : ''}"	
									reRender="dateLinksForm,overall_script,overallScoreBox"
									value="#{messages.duration_six}">
									<a4j:actionparam name="duration" assignTo="#{driverDurationBean.duration}" value="SIX" />
								</a4j:commandLink>
								<rich:spacer width="5"></rich:spacer>
								<a4j:commandLink title="#{messages.duration_twelve}" immediate="true"
									styleClass="#{(driverDurationBean.duration eq 'TWELVE') ? 'on' : ''}"	
									reRender="dateLinksForm,overall_script,overallScoreBox"
									value="#{messages.duration_twelve}">
									<a4j:actionparam name="duration" assignTo="#{driverDurationBean.duration}" value="TWELVE" />
								</a4j:commandLink>
								</span>
								<span class="panel_ico">
									<h:panelGroup id="toolsIcon">
										<h:graphicImage value="/images/ico_tools.png" alt="Tools" />
									</h:panelGroup>
								</span>
									<rich:contextMenu event="onclick" attachTiming="onavailable"
										disableDefaultMenu="false" submitMode="server"
										attachTo="toolsIcon">
										<rich:menuItem ajaxSingle="true" rendered="true"
														iconDisabled="/images/ico_email.gif" 
														icon="/images/ico_email.gif" 
														onclick="Richfaces.showModalPanel('driverReportEmailModal');return false;"
														value="#{messages.contextMenu_email_this_report}" id="emailMenuItem" submitMode="none">
										</rich:menuItem>
										<rich:menuItem ajaxSingle="true"
														iconDisabled="/images/ico_pdf.gif" icon="/images/ico_pdf.gif"
														value="Export To PDF"
														action="#{driverBean.exportReportToPdf}"
														id="export_menu_item">
										</rich:menuItem>
									</rich:contextMenu>
							</a4j:form>
							</a4j:region>
						</div>
				</div>
				<div class="panel_w">
				  <rich:panel bodyClass="panel_content" id="overallPanel" border="0">
				  <table width="920" border="0" cellspacing="0" cellpadding="0" align="center" style="margin: 10px auto 0 auto;">
					  <tr>
						<td valign="top" width="600">
						   <ui:include src="../includes/multiLineChart.xhtml">
						            <ui:param name="lineChartDef" value="#{driverBean.overallScoreHistory}" />
						            <ui:param name="hiddenFieldID" value="HiddenField" />
						            <ui:param name="width" value="650" /> 
						            <ui:param name="height" value="230" />  
						            <ui:param name="tartgetElementVar" value="targetElement" />
						            <ui:param name="ChartDivID" value="overall_chart" />
						            <ui:param name="ScriptDivID" value="overall_script" />
						            <ui:param name="chartVar" value="overallChart" />
						            <ui:param name="pYAxisName" value="#{messages.driver_chart_score}" />
						            <ui:param name="sYAxisName" value="#{messages.driver_chart_miles}" />
							</ui:include>
						</td>
						<td valign="top" align="right">
							<rich:panel id="overallScoreBox">
								<table width="220" border="0" cellspacing="0" cellpadding="0" class="scorebox" style="margin: 20px 20px 0 0;">
								  <tr>
									<td>
										<h4>#{messages.driver_overallscore}</h4>
									</td>
									<td width="80" align="center">
									
										<ui:include src="../includes/scoreBox.xhtml">
									            <ui:param name="score" value="#{driverBean.overallScore}" />
									            <ui:param name="scoreStyle" value="#{driverBean.overallScoreStyle}" />
										</ui:include>
									
									</td>
								  </tr>
								</table>
							</rich:panel>
						</td>
					  </tr>
					</table>
				  </rich:panel>
				</div>
				<div class="panel_sw">
					<div class="panel_statusbar"></div>
				</div>
			</div>
			<div class="spacer"></div>
		<!-- END PANEL -->
	</td>
    </tr>
  <tr>
    <td colspan="3" valign="top"><h:graphicImage value="/images/x.gif" width="10" height="10" /></td>
    </tr>
  <tr>
    <td width="465" valign="top">
		<!-- START PANEL -->
			<rich:panel id="speedPanel">
				<div class="panel_nw">
					<div class="panel_title">
						<span class="speed">#{messages.driver_speed}</span>
						<ui:include src="../includes/dateLinksToolsDetail.xhtml">
							<ui:param name="ajaxForm" value="speedForm"/>
							<ui:param name="reRenderList" value="speed_script,speedForm,speedScoreBox"/>			
							<ui:param name="thirtyDaysOn" value="#{(driverSpeedBean.durationBean.duration eq 'DAYS') ? 'on' : ''}"/>
							<ui:param name="threeMonthsOn" value="#{(driverSpeedBean.durationBean.duration eq 'THREE') ? 'on' : ''}"/>
							<ui:param name="sixMonthsOn" value="#{(driverSpeedBean.durationBean.duration eq 'SIX') ? 'on' : ''}"/>
							<ui:param name="twelveMonthsOn" value="#{(driverSpeedBean.durationBean.duration eq 'TWELVE') ? 'on' : ''}"/>
				  			<ui:param name="duration" value="#{driverSpeedBean.durationBean.duration}" />
				  			<ui:param name="flyNavRule" value="go_reportDriverSpeed" />
				  			<ui:param name="flyOutImage" value="ico_expand.png" /> 
				  			<ui:param name="reportBean" value="#{driverSpeedBean}" />
				  			<ui:param name="showTools" value="FALSE" /> 
  							<ui:param name="showDetail" value="TRUE" />  
						</ui:include>	
					</div>
				</div>
					<div class="panel_w">
					  <div class="panel_content">
					    <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">                        
                          <tr>
                            <td width="373">
				            <ui:include src="../includes/multiLineChart.xhtml">
						            <ui:param name="lineChartDef" value="#{driverSpeedBean.trendMap['SCORE_SPEEDING']}" />
						            <ui:param name="hiddenFieldID" value="HiddenField1" />
						            <ui:param name="width" value="380" /> 
						            <ui:param name="height" value="200" />  
						            <ui:param name="tartgetElementVar" value="targetElement1" />
						            <ui:param name="ChartDivID" value="speed_chart" />
						            <ui:param name="ScriptDivID" value="speed_script" />
						            <ui:param name="chartVar" value="speed_chart" />
						            <ui:param name="hideLegend" value="TRUE" />
						            <ui:param name="hideNames" value="TRUE" />
							</ui:include>
							</td>
                            <td width="80" align="center">
                            <rich:panel id="speedScoreBox">
							    <ui:include src="../includes/scoreBox.xhtml">
							            <ui:param name="score" value="#{driverSpeedBean.scoreMap['SCORE_SPEEDING']}" />
							            <ui:param name="scoreStyle" value="#{driverSpeedBean.styleMap['SCORE_SPEEDING']}" />
								</ui:include>
							</rich:panel>
							</td>
                          </tr>
                        </table>
					  </div>
					</div>
				<div class="panel_sw">
					<div class="panel_statusbar"></div>
				</div>
			</rich:panel>
			
		<!-- END PANEL -->
		
		<div class="spacer"></div>
		
		<!-- START PANEL -->
			<div class="">
				<div class="panel_nw">
					<div class="panel_title">
						<span class="vehicle">#{messages.driver_driving_style}</span>
						<ui:include src="../includes/dateLinksToolsDetail.xhtml">
							<ui:param name="ajaxForm" value="styleForm"/>
							<ui:param name="reRenderList" value="style_script,styleForm,styleScoreBox"/>			
							<ui:param name="thirtyDaysOn" value="#{(driverStyleBean.durationBean.duration eq 'DAYS') ? 'on' : ''}"/>
							<ui:param name="threeMonthsOn" value="#{(driverStyleBean.durationBean.duration eq 'THREE') ? 'on' : ''}"/>
							<ui:param name="sixMonthsOn" value="#{(driverStyleBean.durationBean.duration eq 'SIX') ? 'on' : ''}"/>
							<ui:param name="twelveMonthsOn" value="#{(driverStyleBean.durationBean.duration eq 'TWELVE') ? 'on' : ''}"/>
				  			<ui:param name="duration" value="#{driverStyleBean.durationBean.duration}" />
				  			<ui:param name="flyNavRule" value="go_reportDriverStyle" />
				  			<ui:param name="flyOutImage" value="ico_expand.png" /> 
				  			<ui:param name="reportBean" value="#{driverStyleBean}" />
				  			<ui:param name="showTools" value="FALSE" /> 
  							<ui:param name="showDetail" value="TRUE" />  
						</ui:include>
					</div>
				</div>
					<div class="panel_w">
					  <rich:panel bodyClass="panel_content" id="stylePanel" border="0">
					    <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
                          <tr>
                            <td width="373">
                      		<ui:include src="../includes/multiLineChart.xhtml">
						            <ui:param name="lineChartDef" value="#{driverStyleBean.trendMap['SCORE_DRIVING_STYLE']}" />
						            <ui:param name="hiddenFieldID" value="HiddenField2" />
						            <ui:param name="width" value="380" /> 
						            <ui:param name="height" value="200" />  
						            <ui:param name="tartgetElementVar" value="targetElement2" />
						            <ui:param name="ChartDivID" value="style_chart" />
						            <ui:param name="ScriptDivID" value="style_script" />
						            <ui:param name="chartVar" value="style_chart" />
						            <ui:param name="hideLegend" value="TRUE" />
						            <ui:param name="hideNames" value="TRUE" />
							</ui:include>
                            </td>
                            <td width="80" align="center">
                            <rich:panel id="styleScoreBox">
                                <ui:include src="../includes/scoreBox.xhtml">
							            <ui:param name="score" value="#{driverStyleBean.scoreMap['SCORE_DRIVING_STYLE']}" />
							            <ui:param name="scoreStyle" value="#{driverStyleBean.styleMap['SCORE_DRIVING_STYLE']}" />
								</ui:include>
							</rich:panel>
                            </td>
                          </tr>
                        </table>
					  </rich:panel>
					</div>
				<div class="panel_sw">
					<div class="panel_statusbar"></div>
				</div>
			</div>
		<!-- END PANEL -->
		
		<div class="spacer"></div>
		
		<!-- START PANEL -->
			<div class="">
				<div class="panel_nw">
					<div class="panel_title">
						<span class="seatbelt">#{messages.driver_seatbelt}</span>
							<ui:include src="../includes/dateLinksToolsDetail.xhtml">
							<ui:param name="ajaxForm" value="seatBeltForm"/>
							<ui:param name="reRenderList" value="seatBelt_script,seatBeltForm,seatBeltScoreBox"/>			
							<ui:param name="thirtyDaysOn" value="#{(driverSeatBeltBean.durationBean.duration eq 'DAYS') ? 'on' : ''}"/>
							<ui:param name="threeMonthsOn" value="#{(driverSeatBeltBean.durationBean.duration eq 'THREE') ? 'on' : ''}"/>
							<ui:param name="sixMonthsOn" value="#{(driverSeatBeltBean.durationBean.duration eq 'SIX') ? 'on' : ''}"/>
							<ui:param name="twelveMonthsOn" value="#{(driverSeatBeltBean.durationBean.duration eq 'TWELVE') ? 'on' : ''}"/>
				  			<ui:param name="duration" value="#{driverSeatBeltBean.durationBean.duration}" />
				  			<ui:param name="flyNavRule" value="go_reportDriverSeatBelt" />
				  			<ui:param name="flyOutImage" value="ico_expand.png" /> 
				  			<ui:param name="reportBean" value="#{driverSeatBeltBean}" />
				  			<ui:param name="showTools" value="FALSE" /> 
  							<ui:param name="showDetail" value="TRUE" />  
						</ui:include>
					</div>
				</div>
					<div class="panel_w">
					  <rich:panel bodyClass="panel_content" id="seatBeltPanel" border="0">
					    <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
                          <tr>
                            <td width="373">
                      		<ui:include src="../includes/multiLineChart.xhtml">
						            <ui:param name="lineChartDef" value="#{driverSeatBeltBean.seatBeltScoreHistoryOverall}" />
						            <ui:param name="hiddenFieldID" value="HiddenField3" />
						            <ui:param name="width" value="380" /> 
						            <ui:param name="height" value="200" />
						            <ui:param name="tartgetElementVar" value="targetElement3" />
						            <ui:param name="ChartDivID" value="seatBelt_chart" />
						            <ui:param name="ScriptDivID" value="seatBelt_script" />
						            <ui:param name="chartVar" value="seatBelt_chart" />
						            <ui:param name="hideLegend" value="TRUE" />
						            <ui:param name="hideNames" value="TRUE" />
							</ui:include>
                            </td>
                            <td width="80" align="center">
                            <rich:panel id="seatBeltScoreBox">
                       	        <ui:include src="../includes/scoreBox.xhtml">
							            <ui:param name="score" value="#{driverSeatBeltBean.seatBeltScore}" />
							            <ui:param name="scoreStyle" value="#{driverSeatBeltBean.seatBeltScoreStyle}" />
								</ui:include>
							</rich:panel>
                            </td>
                          </tr>
                        </table>
					  </rich:panel>
					</div>
				<div class="panel_sw">
					<div class="panel_statusbar"></div>
				</div>
			</div>
		<!-- END PANEL -->
	</td>
    <td width="10"><h:graphicImage value="/images/x.gif" width="10" /></td>
    <td width="465" valign="top">
		<!-- START PANEL -->
			<div class="">
				<div class="panel_nw">
					<div class="panel_title">
						<span class="map"><h:outputText value="#{messages.driver_lasttrip}: " />
						<h:outputText rendered="#{driverBean.hasLastTrip eq true}">
							<h:outputText value="#{driverBean.lastTrip.trip.endTime}">
								<f:convertDateTime pattern="#{messages.dateTimeFormat}" timeZone="#{navigationBean.driver.person.timeZone}" />
							</h:outputText>
						</h:outputText>
						</span>
						<span class="panel_links"><h:form><h:commandLink value="#{messages.driver_view_all}" action="go_driverTrips">
						</h:commandLink></h:form></span>
					</div>
				</div>
					<div class="panel_w">
					  <div class="panel_content">
					  
					  	<h:panelGroup styleClass="map-border" layout="block">
							<h:outputText rendered="#{driverBean.hasLastTrip eq false}">
	  							<h3>#{messages.no_last_trip_found}</h3>
	  						</h:outputText>
							<div id="map-canvas" style="width:458px;height:300px;border:0"></div>
					  	</h:panelGroup>
					  </div>
					</div>
					
				<div class="panel_sw">
					<div class="panel_statusbar"></div>
				</div>
			</div>
		<!-- END PANEL -->
		
		<div class="spacer"></div>
				
		<!-- START PANEL -->
			<div class="">
				<div class="panel_nw">
					<div class="panel_title">
						<span class="gas">#{messages.driver_mpg}</span>
						<ui:include src="../includes/dateLinks.xhtml">
							<ui:param name="ajaxForm" value="mpgForm"/>
							<ui:param name="reRenderList" value="mpg_script,mpgForm"/>			
							<ui:param name="thirtyDaysOn" value="#{(driverBean.mpgDurationBean.duration eq 'DAYS') ? 'on' : ''}"/>
							<ui:param name="threeMonthsOn" value="#{(driverBean.mpgDurationBean.duration eq 'THREE') ? 'on' : ''}"/>
							<ui:param name="sixMonthsOn" value="#{(driverBean.mpgDurationBean.duration eq 'SIX') ? 'on' : ''}"/>
							<ui:param name="twelveMonthsOn" value="#{(driverBean.mpgDurationBean.duration eq 'TWELVE') ? 'on' : ''}"/>
				  			<ui:param name="duration" value="#{driverBean.mpgDurationBean.duration}" />
				  			<ui:param name="ajaxStatusID" value="mpgStatus" />
						</ui:include>
					</div>
				</div>
					<div class="panel_w">
					  <rich:panel bodyClass="panel_content" id="mpgPanel" border="0">
					    <table width="450" border="0" align="center" cellpadding="0" cellspacing="0">
                          <tr>
                            <td>
                            <div id="mpg_chart"></div>
                            
                            <rich:panel id="mpg_script">
                            	<h:inputHidden value="#{driverBean.mpgHistory}" id="hiddenField5"/>
                            
							<script type="text/javascript">
								var chart = new FusionCharts("#{facesContext.externalContext.request.contextPath}/fusioncharts/MSArea.swf", "ChartId", "450", "300", "0", "0");
								var targetElement5 = document.getElementById("hiddenField5");
								chart.setDataXML(targetElement5.value);
								chart.setTransparent(true);
								chart.render("mpg_chart");
							</script>
							</rich:panel>
                            </td>
                          </tr>
                        </table>
					  </rich:panel>
					</div>
				<div class="panel_sw">
					<div class="panel_statusbar"></div>
				</div>
			</div>
		<!-- END PANEL -->
		
		<div class="spacer"></div>
		
		<!-- START PANEL -->
			<div class="">
				<div class="panel_nw">
					<div class="panel_title">
						<span class="coaching">#{messages.driver_coaching}</span>
						<ui:include src="../includes/dateLinks.xhtml">
							<ui:param name="ajaxForm" value="coachingForm"/>
							<ui:param name="reRenderList" value="coaching_script,coachingForm"/>			
							<ui:param name="thirtyDaysOn" value="#{(driverBean.coachDurationBean.duration eq 'DAYS') ? 'on' : ''}"/>
							<ui:param name="threeMonthsOn" value="#{(driverBean.coachDurationBean.duration eq 'THREE') ? 'on' : ''}"/>
							<ui:param name="sixMonthsOn" value="#{(driverBean.coachDurationBean.duration eq 'SIX') ? 'on' : ''}"/>
							<ui:param name="twelveMonthsOn" value="#{(driverBean.coachDurationBean.duration eq 'TWELVE') ? 'on' : ''}"/>
				  			<ui:param name="duration" value="#{driverBean.coachDurationBean.duration}" />
				  			<ui:param name="ajaxStatusID" value="coachingStatus" />
						</ui:include>
					</div>
				</div>
					<div class="panel_w">
					  <rich:panel bodyClass="panel_content" id="coachingPanel" border="0">
					    <table width="450" border="0" align="center" cellpadding="0" cellspacing="0">
                          <tr>
                            <td>
                            <ui:include src="../includes/columnChart.xhtml">
						            <ui:param name="lineChartDef" value="#{driverBean.coachingHistory}" />
						            <ui:param name="hiddenFieldID" value="HiddenField4" />
						            <ui:param name="width" value="450" /> 
						            <ui:param name="height" value="200" />
						            <ui:param name="tartgetElementVar" value="targetElement4" />
						            <ui:param name="ChartDivID" value="coaching_chart" />
						            <ui:param name="ScriptDivID" value="coaching_script" />
						            <ui:param name="chartVar" value="coaching_chart" />
							</ui:include>
                            </td>
                          </tr>
                        </table>
					  </rich:panel>
					</div>
				<div class="panel_sw">
					<div class="panel_statusbar"></div>
				</div>
			</div>
		<!-- END PANEL -->
	</td>
  </tr>
</table>
</div>

<!-- START EMAIL MODAL -->
	<h:outputText id="driver_email_modalPanel">
		<ui:include src="/includes/emailReportPopup.xhtml">	
			<ui:param  name="id" value="driverReportEmailModal" />
			<ui:param  name="reportBean" value="#{driverBean}"/>
		</ui:include>
	</h:outputText>
<!-- END EMAIL MODAL -->
</ui:define>
</ui:composition>
