<ui:composition template="/layout/layout.xhtml" 
				xmlns="http://www.w3.org/1999/xhtml" 
				xmlns:ui="http://java.sun.com/jsf/facelets"
  				xmlns:h="http://java.sun.com/jsf/html" 
  				xmlns:rich="http://richfaces.org/rich"
  				xmlns:a4j="http://richfaces.org/a4j"
  				xmlns:f="http://java.sun.com/jsf/core">

	<ui:define name="scripts">
		<script src="#{facesContext.externalContext.request.contextPath}/js/FusionCharts.js" type="text/javascript"></script>	
	</ui:define>

	<ui:param name="reportsSelected" value="current" />

	
	<ui:define name="content">
<div id="wrapper">

<ul id="grid_nav">
	<li class="l grid_icon"><img src="images/ico_line.png" /></li>
	<li class="l grid_title">Driver Performance:&#160;<h:outputText>#{driverSpeedBean.driverName}</h:outputText></li>
	<li class="l divider"><img src="/images/grid_nav_divider.png" /></li>
	<li class="l">
	
		<ul id="breadcrumb">
			<li class="first"><a href="/">Home</a></li>
			<li><a href="drivers.html">Drivers</a></li>
			<li class="last"><h:outputText>#{driverBean.driverName}</h:outputText></li>
		</ul>
	</li>
</ul>

<script type="text/javascript">

//Set default selected box.
var selected = 'OVERALL';

	function SelectBreakDown(region, chartVar)
	{
		//Un-Select last component in CSS.
		document.getElementById(selected).className="tiny_chart";
		
		//remember current selected region.
		selected = region;
		
		//change style to new selected region.
		document.getElementById(region).className="tiny_selected";
		
		//resize chart and render it in the top box.
		// TODO: turn on X and Y axis labels.
		chartVar.attributes.width = 650;
		chartVar.attributes.height = 200;
		chartVar.render('overall_chart');
	}
</script>

<table width="940" border="0" cellspacing="0" cellpadding="0" align="center" class="dash_table">
  <tr>
    <td colspan="3" valign="top">
		<!-- START PANEL -->
			<div class="">
				<div class="panel_nw">
					<div class="panel_title">
						<span class="line">Speed</span>
						<a4j:form id="overall-form"> 
									<span class="panel_links"><h:outputText>Graph the last:&#160;</h:outputText>
								<a4j:commandLink title="#{messages.miles500}" immediate="true"
									styleClass="#{(driverSpeedBean.distance eq 'FIVEHUNDRED') ? 'on' : ''}"
									reRender="overall-form,overallPanel,breakdown_panel,eventsTable" value="#{messages.miles500}">
									<a4j:actionparam name="distance" assignTo="#{driverSpeedBean.distance}"
										value="FIVEHUNDRED" />
								</a4j:commandLink><h:outputText value=" "></h:outputText> <a4j:commandLink
									title="#{messages.miles1000}" immediate="true"
									styleClass="#{(driverSpeedBean.distance eq 'ONETHOUSAND') ? 'on' : ''}"
									reRender="overall-form,overallPanel,breakdown_panel,eventsTable" value="#{messages.miles1000}">
									<a4j:actionparam name="distance" assignTo="#{driverSpeedBean.distance}"
										value="ONETHOUSAND" />
								</a4j:commandLink><h:outputText value=" "></h:outputText> <a4j:commandLink
									title="#{messages.miles10000}" immediate="true"
									styleClass="#{(driverSpeedBean.distance eq 'TENTHOUSAND') ? 'on' : ''}"
									reRender="overall-form,overallPanel,breakdown_panel,eventsTable"
									value="#{messages.miles10000}">
									<a4j:actionparam name="distance" assignTo="#{driverSpeedBean.distance}"
										value="TENTHOUSAND" />
								</a4j:commandLink><h:outputText value=" "></h:outputText>
									</span>
						</a4j:form>
					</div>
				</div>
				<div class="panel_w">
				  <rich:panel bodyClass="panel_content" id="overallPanel" border="0">
				  <table width="920" border="0" cellspacing="0" cellpadding="0" align="center" style="margin: 10px auto 0 auto;">
					  <tr>
						<td valign="top" width="600">
						   <ui:include src="../../includes/lineChart.xhtml">
						            <ui:param name="lineChartDef" value="#{driverSpeedBean.speedScoreHistoryLarge}" />
						            <ui:param name="hiddenFieldID" value="HiddenField" />
						            <ui:param name="width" value="650" /> 
						            <ui:param name="height" value="200" />  
						            <ui:param name="tartgetElementVar" value="targetElement" />
						            <ui:param name="ChartDivID" value="overall_chart" />
						            <ui:param name="chartVar" value="overallChart" />
							</ui:include>
						</td>
						<td valign="top" align="right">
							<table width="220" border="0" cellspacing="0" cellpadding="0" class="scorebox" style="margin: 20px 20px 0 0;">
							  <tr>
								<td>
									<h4>Overall Score</h4>
									<div style="margin-top: 8px;"><a href="#" class="ls_tab_email">Email</a></div>
								</td>
								<td width="80" align="center">
									<ui:include src="../../includes/scoreBox.xhtml">
								            <ui:param name="score" value="#{driverSpeedBean.speedScore}" />
								            <ui:param name="scoreStyle" value="#{driverSpeedBean.speedScoreStyle}" />
									</ui:include>
								</td>
							  </tr>
							</table>
						</td>
					  </tr>
					</table>
				  
				  </rich:panel>
				</div>
				<div class="panel_sw">
					<div class="panel_statusbar"></div>
				</div>
			</div>
			<div class="spacer"></div>
		<!-- END PANEL -->
	</td>
    </tr>
  <tr>
    <td colspan="3" valign="top"><img src="images/x.gif" width="10" height="10" /></td>
    </tr>
  <tr>
    <td width="465" valign="top">
<!-- END PANEL -->
	</td>
    </tr>
  <tr>
    <td colspan="3" valign="top"><img src="images/x.gif" width="10" height="10" /></td>
    </tr>
  <tr>
    <td width="465" valign="top">
		<!-- START PANEL -->
			<div class="">
				<div class="panel_nw">
					<div class="panel_title">
						<span class="speed">Breakdown by Speed Limit   </span>
						<span class="panel_links"></span></div>
				</div>
				<div class="panel_w">
				  <rich:panel bodyClass="panel_content" id="breakdown_panel" border="0">
					<table width="920" border="0" cellspacing="0" cellpadding="0" align="center" style="margin: 10px auto 0 auto;">
					  <tr>
					    <td id="OVERALL" valign="top" class="tiny_selected">
						  <div class="tiny_title">
								<a href="#" onclick="SelectBreakDown('OVERALL', overallChart2)">Overall</a>
						  </div>
							<table width="300" border="0" cellspacing="0" cellpadding="0">
							  <tr>
								<td>
									<ui:include src="../../includes/lineChart.xhtml">
								            <ui:param name="lineChartDef" value="#{driverSpeedBean.speedScoreHistorySmall}" />
								            <ui:param name="hiddenFieldID" value="HiddenOverall" />
								            <ui:param name="width" value="220" /> 
								            <ui:param name="height" value="90" />  
								            <ui:param name="tartgetElementVar" value="targetElement1" />
								            <ui:param name="ChartDivID" value="speed_chart_tiny_overall" />
								            <ui:param name="chartVar" value="overallChart2" />
									</ui:include>
								</td>
								<td align="center">
									<ui:include src="../../includes/scoreBox.xhtml">
								            <ui:param name="score" value="#{driverSpeedBean.speedScore}" />
								            <ui:param name="scoreStyle" value="#{driverSpeedBean.speedScoreStyle}" /> 
									</ui:include>
								</td>
							  </tr>
							</table>
						</td>
					    <td id="TWENTYONE" valign="top" class="tiny_chart">
							<div class="tiny_title">
								<a href="#" onclick="SelectBreakDown('TWENTYONE', chart21)">21-30mph</a>
							</div>
							<table width="300" border="0" cellspacing="0" cellpadding="0">
							  <tr>
								<td>
									<ui:include src="../../includes/lineChart.xhtml">
									            <ui:param name="lineChartDef" value="#{driverSpeedBean.speedScoreHistorySmall}" />
									            <ui:param name="hiddenFieldID" value="HiddenTWENTYONE" />
									            <ui:param name="width" value="220" /> 
									            <ui:param name="height" value="90" />  
									            <ui:param name="tartgetElementVar" value="targetElement2" />
									            <ui:param name="ChartDivID" value="speed_chart_tiny_21-30" />
									            <ui:param name="chartVar" value="chart21" />
									</ui:include>
								</td>
								<td align="center">
								<ui:include src="../../includes/scoreBox.xhtml">
								            <ui:param name="score" value="#{driverSpeedBean.speedScore}" />
								            <ui:param name="scoreStyle" value="#{driverSpeedBean.speedScoreStyle}" /> 
									</ui:include>
								</td>
							  </tr>
							</table>
						</td>
					    <td id="THIRTYONE" valign="top" class="tiny_chart">
							<div class="tiny_title">
								<a href="#" onclick="SelectBreakDown('THIRTYONE', chart31)">31-40mph</a></div>
							<table width="300" border="0" cellspacing="0" cellpadding="0">
							  <tr>
								<td>
									<ui:include src="../../includes/lineChart.xhtml">
								            <ui:param name="lineChartDef" value="#{driverSpeedBean.speedScoreHistorySmall}" />
								            <ui:param name="hiddenFieldID" value="HiddenTHIRTYONE" />
								            <ui:param name="width" value="220" /> 
								            <ui:param name="height" value="90" />  
								            <ui:param name="tartgetElementVar" value="targetElement3" />
								            <ui:param name="ChartDivID" value="speed_chart_tiny_31-40" />
								            <ui:param name="chartVar" value="chart31" />
									</ui:include>
									</td>
									<td align="center">
									<ui:include src="../../includes/scoreBox.xhtml">
								            <ui:param name="score" value="#{driverSpeedBean.speedScore}" />
								            <ui:param name="scoreStyle" value="#{driverSpeedBean.speedScoreStyle}" /> 
									</ui:include>
								</td>
							  </tr>
							</table>
						</td>
				      </tr>
					  <tr>
						<td id="FORTYONE" valign="top" class="tiny_chart">
							<div class="tiny_title">
							<a href="#" onclick="SelectBreakDown('FORTYONE', chart41)">41-54mph</a></div>
							<table width="300" border="0" cellspacing="0" cellpadding="0">
							  <tr>
								<td>
									<ui:include src="../../includes/lineChart.xhtml">
								            <ui:param name="lineChartDef" value="##{driverSpeedBean.speedScoreHistorySmall}" />
								            <ui:param name="hiddenFieldID" value="HiddenFORTYONE" />
								            <ui:param name="width" value="220" /> 
								            <ui:param name="height" value="90" />  
								            <ui:param name="tartgetElementVar" value="targetElement4" />
								            <ui:param name="ChartDivID" value="speed_chart_tiny_41-54" />
								            <ui:param name="chartVar" value="chart41" />
									</ui:include>
								</td>
								<td align="center">
									<ui:include src="../../includes/scoreBox.xhtml">
								            <ui:param name="score" value="#{driverSpeedBean.speedScore}" />
								            <ui:param name="scoreStyle" value="#{driverSpeedBean.speedScoreStyle}" /> 
									</ui:include>
								</td>
							  </tr>
							</table>
						</td>
						<td id="FIFTYFIVE" valign="top" class="tiny_chart">
							<div class="tiny_title">
							<a href="#" onclick="SelectBreakDown('FIFTYFIVE', chart55)">55-64mph</a></div>
							<table width="300" border="0" cellspacing="0" cellpadding="0">
							  <tr>
								<td>
									<ui:include src="../../includes/lineChart.xhtml">
								            <ui:param name="lineChartDef" value="#{driverSpeedBean.speedScoreHistorySmall}" />
								            <ui:param name="hiddenFieldID" value="HiddenFIFTYFIVE" />
								            <ui:param name="width" value="220" /> 
								            <ui:param name="height" value="90" />  
								            <ui:param name="tartgetElementVar" value="targetElement5" />
								            <ui:param name="ChartDivID" value="speed_chart_tiny_55-64" />
								            <ui:param name="chartVar" value="chart55" />
									</ui:include>
								</td>
								<td align="center">
									<ui:include src="../../includes/scoreBox.xhtml">
								            <ui:param name="score" value="#{driverSpeedBean.speedScore}" />
								            <ui:param name="scoreStyle" value="#{driverSpeedBean.speedScoreStyle}" /> 
									</ui:include>
								</td>
							  </tr>
							</table>
						</td>
					    <td id="SIXTYFIVE" valign="top" class="tiny_chart">
							<div class="tiny_title">
							<a href="#" onclick="SelectBreakDown('SIXTYFIVE', chart65)">65-80mph</a></div>
							<table width="300" border="0" cellspacing="0" cellpadding="0">
							  <tr>
								<td>
									<ui:include src="../../includes/lineChart.xhtml">
								            <ui:param name="lineChartDef" value="#{driverSpeedBean.speedScoreHistorySmall}" />
								            <ui:param name="hiddenFieldID" value="HiddenSIXTYFIVE" />
								            <ui:param name="width" value="220" /> 
								            <ui:param name="height" value="90" />  
								            <ui:param name="tartgetElementVar" value="targetElement6" />
								            <ui:param name="ChartDivID" value="speed_chart_tiny_65-80" />
								            <ui:param name="chartVar" value="chart65" />
									</ui:include>
								</td>
								<td align="center">
									<ui:include src="../../includes/scoreBox.xhtml">
								            <ui:param name="score" value="#{driverSpeedBean.speedScore}" />
								            <ui:param name="scoreStyle" value="#{driverSpeedBean.speedScoreStyle}" /> 
									</ui:include>
								</td>
							  </tr>
							</table>
						</td>
					  </tr>
					</table>
				  </rich:panel>
				</div>
				<div class="panel_sw">
					<div class="panel_statusbar"></div>
				</div>
			</div>
		<!-- END PANEL -->
		<div class="spacer"></div>
		
		<!-- START PANEL -->
			<div class="">
				<div class="panel_nw">
					<div class="panel_title">
						<span class="details">Details</span>
						<span class="panel_links"></span>
					</div>
				</div>
				<div class="panel_w">
				  <div class="panel_content">
				     

			<div class="datagrid">
				<!-- Start Event table --> 
					<h:form id="trendTable">
						<rich:dataTable 
						value="#{driverSpeedBean.speedingEvents}" 
						id="eventsTable"
						var="item" styleClass="datagrid"
						rowClasses="trendTableOdd,trendTableEven" cellspacing="1" rows="10"  
						width="100%"
						binding="#{trendTable.table}">  <!-- TODO: Make generic Odd Even CSS -->

							<!-- Data -->
										
							<rich:column sortBy="#{item.latitude}">
								<f:facet name="header">
									<h:outputText value="Location" />
								</f:facet>
									<h:outputText value="1232 Coleman Ave Santa Clara, CA 95110 " />
							</rich:column>
							
							<rich:column sortBy="#{item.latitude}">
								<f:facet name="header">
									<h:outputText value="Time" />
								</f:facet>
									<h:outputText value="Fri, Apr 25, 2008 11:22 AM (MST)" />
							</rich:column>
							
							<rich:column sortBy="#{item.speedLimit}">
								<f:facet name="header">
									<h:outputText value="Posted Speed" />
								</f:facet>
								<h:outputText value="#{item.speedLimit}" />		
							</rich:column>
							
							<rich:column sortBy="#{item.avgSpeed}">
								<f:facet name="header">
									<h:outputText value="Avg. Speed" />
								</f:facet>
								<h:outputText value="#{item.avgSpeed}" />
							</rich:column>
							
							<rich:column sortBy="#{item.topSpeed}">
								<f:facet name="header">
									<h:outputText value="Top Speed" />
								</f:facet>
								<h:outputText value="#{item.topSpeed}" />
							</rich:column>
							
							<rich:column sortBy="#{item.distance}">
								<f:facet name="header">
									<h:outputText value="Distance" />
								</f:facet>
								<h:outputText value="#{item.distance}" />
							</rich:column>
							
							<rich:column sortBy="#{item.time}">
								<f:facet name="header">
									<h:outputText value="Severity" />
								</f:facet>
									<div class="sev_bar_med"></div>
							</rich:column>
							
							<rich:column>
								<f:facet name="header">
									<h:outputText value="" />
								</f:facet>
								<a href="#">forgive</a>
							</rich:column>
							
						</rich:dataTable>
					</h:form> 
				<!-- End Event table -->
				</div>
				</div>
				</div>
				</div>
		</td>
    </tr>
</table>
 </div>
				
				<div class="panel_sw">
					<div class="panel_statusbar"></div>
				</div>
			
		<!-- END PANEL -->
		
</ui:define>
</ui:composition>