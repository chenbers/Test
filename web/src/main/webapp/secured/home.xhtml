<ui:composition template="/layout/layout.xhtml" 
				xmlns="http://www.w3.org/1999/xhtml" 
				xmlns:ui="http://java.sun.com/jsf/facelets"
  				xmlns:h="http://java.sun.com/jsf/html" 
  				xmlns:rich="http://richfaces.org/rich"
  				xmlns:a4j="http://richfaces.org/a4j"
  				xmlns:iwi="http://pro.tiwi.com/jsf"
  				xmlns:f="http://java.sun.com/jsf/core">
  			
	<ui:define name="scripts">
		<script src="#{facesContext.externalContext.request.contextPath}/js/FusionCharts.js" type="text/javascript"></script>		
	</ui:define>

	<ui:param name="homeSelected" value="current" />
	<ui:param name="helpFile" value="Overall_Score-Fleet_Level.htm" />
	<ui:define name="content">
		<h:form id="setupGroup">
			<h:inputHidden value="#{groupLevelBean.ping}" />
		</h:form>
	
			
		<ui:include src="/includes/overviewHeader.xhtml">
			<ui:param name="showContextMenu" value="true"/>
		</ui:include>
		<table width="940" border="0" cellspacing="0" cellpadding="0" align="center" class="dash_table">
  			<tr>
    			<td width="465" valign="top">
					<!-- START OVERALL/R PANEL -->
					<!-- leave reRenderList alone -->
					<ui:include src="/includes/breakdown.xhtml">
						<ui:param name="reRenderList" value="breakdownForm,overallPanel,hiddenField3"/>
						<ui:param name="ajaxStatusID" value="overall_status_2" /> 
						<ui:param name="pieDef" value="#{breakdownBean.overallPieDef}"/>
						<ui:param name="overallScoreStyle" value="#{breakdownBean.overallScoreStyle}"/>
						<ui:param name="overallScore" value="#{breakdownBean.overallScore}"/>
						<ui:param name="duration" value="#{breakdownBean.duration}" />   
            			<ui:param name="thirtyDaysOn" value="#{breakdownBean.styleClass30Days}"/>
						<ui:param name="threeMonthsOn" value="#{breakdownBean.styleClass3Months}"/>
						<ui:param name="sixMonthsOn" value="#{breakdownBean.styleClass6Months}"/>
						<ui:param name="twelveMonthsOn" value="#{breakdownBean.styleClass12Months}" />  
						<ui:param name="flyNavRule" value="go_fleetDetail" />
						<ui:param name="flySelectedTab" value="overall_full_screen" />  
						<ui:param name="flyOutImage" value="ico_expand.png" />
						<ui:param name="zorder" value="6"/>	
					</ui:include>		
					<!-- END PANEL -->
					<div class="spacer"></div>
				
					<!-- START MPG PANEL -->
					<ui:include src="/includes/mpgChart.xhtml">	
						<ui:param name="reRenderList" value="mpgForm,mpgDataElement,mpgPanel"/>
						<ui:param name="title" value="#{messages.mpg_title}"/>	
                        <ui:param name="ajaxForm" value="mpgForm" />
                        <ui:param name="ajaxStatusID" value="mpg_status" /> 
            			<ui:param name="barDef" value="#{mpgBean.barDef}"/>  
            			<ui:param name="duration" value="#{mpgBean.duration}" />   
	            		<ui:param name="thirtyDaysOn" value="#{mpgBean.styleClass30Days}"/>
						<ui:param name="threeMonthsOn" value="#{mpgBean.styleClass3Months}"/>
						<ui:param name="sixMonthsOn" value="#{mpgBean.styleClass6Months}"/>
						<ui:param name="twelveMonthsOn" value="#{mpgBean.styleClass12Months}"/>   
                        <ui:param name="xyheight" value="350"/>
                        <ui:param name="xywidth" value="440"/>  
                        <ui:param name="flyNavRule" value="go_fleetDetail" />
                        <ui:param name="inFlyOut" value="false" /> 
					</ui:include>
					<!-- END MPG -->	

				</td>
	
    			<td width="10"><img src="#{facesContext.externalContext.request.contextPath}/images/x.gif" width="10" /></td>
	
	    		<td width="465" valign="top">

					<!-- START TREND PANEL -->

					<div class="">

						<div class="panel_nw">
							<div class="panel_title">
								<span class="line">Trend</span> 
								<ui:include src="/includes/dateLinksWithFlyOut.xhtml">
									<ui:param name="ajaxForm" value="trend_form" />
									<ui:param name="ajaxStatusID" value="trend_status" /> 
									<ui:param name="reRenderList" value="hiddenField1,xypanel,trendTable:items,trend_form"/>
									<ui:param name="thirtyDaysOn" value="#{navigationBean.styleClass30Days}"/>
									<ui:param name="threeMonthsOn" value="#{navigationBean.styleClass3Months}"/>
									<ui:param name="sixMonthsOn" value="#{navigationBean.styleClass6Months}"/>
									<ui:param name="twelveMonthsOn" value="#{navigationBean.styleClass12Months}"/>
			            			<ui:param name="duration" value="#{navigationBean.duration}" />
			            			<ui:param name="flyNavRule" value="go_fleetDetail" />
									<ui:param name="flySelectedTab" value="trend_full_screen" />  
									<ui:param name="flyOutImage" value="ico_expand.png" />
									<ui:param name="report" value="TREND" />
									<ui:param name="numRowsPerPg" value="10"/>
								</ui:include>	
							</div>
		
						</div>


						<div class="panel_w">

								<div class="panel_content">
									<!-- Start xy graph --> 
									<rich:panel id="xypanel" 
										style="height:300;width:445">
									<h:inputHidden value="#{trendBean.lineDef}" 
										id="hiddenField1" />

									<div id="chartdiv2" align="center"></div>
									<script type="text/javascript">
										var targetElement = document.getElementById("hiddenField1");
							
										var chart = new FusionCharts("#{facesContext.externalContext.request.contextPath}/fusioncharts/MSLine.swf", "ChartId", "445", "300", "0", "0");						   						   		
										chart.setDataXML(targetElement.value);
										chart.setTransparent(true);
										chart.render("chartdiv2");
									</script>
								</rich:panel> 
								<!-- End xy graph -->

								<div class="spacer"></div>
								<div class="spacer"></div>				
				
								
								<rich:panel>	
									<rich:spacer height="10"/>
									
									<div style="text-align: right;" >													
										<h:outputText 
											id="countString" value="#{trendBean.countString}"/>
										<rich:spacer width="10"/>
									</div>					
													
								</rich:panel>
								
				
							<div class="spacer"></div>
							<div class="spacer"></div>		
				
							<div class="datagrid">
				
								<h:form id="trendTable">	
								
        							<rich:datascroller id="topScroller" for="items" immediate="true"
        								scrollerListener="#{trendBean.scrollerListener}" maxPages="5"
        								reRender="bottomScroller,countString,starter,items,xypanel">        			
        							</rich:datascroller>	
        							
   										<h:inputHidden id="hiddenGroupID" value="#{navigationBean.groupID}"/>   								
			
										<rich:dataTable value="#{trendBean.scoreableEntities}" id="items"
											var="item" styleClass="datagrid"
											rowClasses="trendTableOdd,trendTableEven" 
											cellspacing="1" rows="#{trendBean.numRowsPerPg}"
											width="100%">

			
											<rich:column width="20">
												<f:facet name="header">
													<h:outputText value=" " />
												</f:facet>
												<rich:spacer width="17" height="17"
													style="background-color:#{item.colorKey};border-style:solid;border-width:1px;border-color:#000000">
												</rich:spacer>
											</rich:column>
											<rich:column>
												<f:facet name="header">
													<a4j:commandLink 
														value="Region" 
														reRender="xypanel,topScroller,bottomScroller,items">
														<f:setPropertyActionListener target="#{trendBean.sortItFirst}" value="true" />														
													</a4j:commandLink>

												</f:facet>
												<h:outputLink value="#{item.goTo}">
													<h:outputText value="#{item.se.identifier}" />
												</h:outputLink>

											</rich:column>
											<rich:column width="73">
												<f:facet name="header">
													<a4j:commandLink 
														value="Score" 
														reRender="xypanel,topScroller,bottomScroller,items">
														<f:setPropertyActionListener target="#{trendBean.sortItSecond}" value="true" />														
													</a4j:commandLink>

												</f:facet>
												<iwi:scoreBox style="#{item.style}" score="#{item.se.score}"/>
												
											</rich:column>

										</rich:dataTable>
						
									<rich:datascroller id="bottomScroller" for="items" immediate="true"
    									scrollerListener="#{trendBean.scrollerListener}" maxPages="5"
        								reRender="topScroller,countString,starter,items,xypanel">        			
        							</rich:datascroller>        		
        		
								</h:form> 
				<!-- End Trend table -->
							</div>

						</div>

						<div class="panel_sw">
							<div class="panel_statusbar"></div>
						</div>

						</div>
	
					</div>								

					<!-- END PANEL -->
		
				</td>
  			</tr>
		</table>

	</ui:define>

</ui:composition>
